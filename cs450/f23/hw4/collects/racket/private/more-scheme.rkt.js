import * as $rjs_core from '../../../runtime/core.js';import * as M0 from "../../../runtime/kernel.rkt.js";import * as M1 from "../../../runtime/paramz.rkt.js";var current_parameterization = function() {return M0.continuation_mark_set_first(false,M1.parameterization_key);};var call_with_parameterization = function(paramz4863, thunk4864) {if (M0.__rjs_quoted__.parameterization_p(paramz4863)!==false) {var if_res7270 = M0.rvoid();} else {var if_res7270 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("call-with-parameterization"),$rjs_core.UString.make("parameterization?"),0,paramz4863,thunk4864);}if_res7270;if (M0.procedure_p(thunk4864)!==false) {var if_res7271 = M0.procedure_arity_includes_p(thunk4864,0);} else {var if_res7271 = false;}if (if_res7271!==false) {var if_res7272 = M0.rvoid();} else {var if_res7272 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("call-with-parameterization"),$rjs_core.UString.make("(-> any)"),1,paramz4863,thunk4864);}if_res7272;var __context7273 = $rjs_core.Marks.getFrames();var __context7274;try {__context7274 = $rjs_core.Marks.enterFrame();$rjs_core.Marks.setMark(M1.parameterization_key,paramz4863);var __wcm_result7275 = thunk4864();} finally {$rjs_core.Marks.updateFrame(__context7273,__context7274);}return __wcm_result7275;};var let_result7277 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("break-parameterization"),false,1,0,false);var struct_break_paramz = let_result7277.getAt(0);var make_break_paramz = let_result7277.getAt(1);var break_paramz_p = let_result7277.getAt(2);var break_paramz_ref = let_result7277.getAt(3);var break_paramz_set_bang_ = let_result7277.getAt(4);var let_result7278 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("break-parameterization"),false,1,0,false,M0.rnull,M0.current_inspector());var type4865 = let_result7278.getAt(0);var maker4866 = let_result7278.getAt(1);var pred4867 = let_result7278.getAt(2);var access4868 = let_result7278.getAt(3);var mutate4869 = let_result7278.getAt(4);var let_result7279 = M0.values(type4865,maker4866,pred4867,M0.make_struct_field_accessor(access4868,0,$rjs_core.PrimitiveSymbol.make("cell")),M0.make_struct_field_mutator(mutate4869,0,$rjs_core.PrimitiveSymbol.make("cell")));var struct_break_parameterization = let_result7279.getAt(0);var make_break_parameterization = let_result7279.getAt(1);var break_parameterization_p = let_result7279.getAt(2);var break_parameterization_cell = let_result7279.getAt(3);var set_break_parameterization_cell_bang_ = let_result7279.getAt(4);var current_break_parameterization = function() {return make_break_paramz(M0.continuation_mark_set_first(false,M1.break_enabled_key));};var call_with_break_parameterization = function(paramz4870, thunk4871) {if (break_paramz_p(paramz4870)!==false) {var if_res7280 = M0.rvoid();} else {var if_res7280 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("call-with-break-parameterization"),$rjs_core.UString.make("break-parameterization?"),0,paramz4870,thunk4871);}if_res7280;if (M0.procedure_p(thunk4871)!==false) {var if_res7281 = M0.procedure_arity_includes_p(thunk4871,0);} else {var if_res7281 = false;}if (if_res7281!==false) {var if_res7282 = M0.rvoid();} else {var if_res7282 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("call-with-parameterization"),$rjs_core.UString.make("(-> any)"),1,paramz4870,thunk4871);}if_res7282;var __context7284 = $rjs_core.Marks.getFrames();var __context7285;try {__context7285 = $rjs_core.Marks.enterFrame();$rjs_core.Marks.setMark(M1.break_enabled_key,break_paramz_ref(paramz4870,0));M1.check_for_break();var __wcm_result7286 = thunk4871();} finally {$rjs_core.Marks.updateFrame(__context7284,__context7285);}var begin_res7283 = __wcm_result7286;M1.check_for_break();return begin_res7283;};var select_handler_by_no_breaks = function(e4872, bpz4873, l4874) {var __context7295 = $rjs_core.Marks.getFrames();var __context7296;try {__context7296 = $rjs_core.Marks.enterFrame();$rjs_core.Marks.setMark(M1.break_enabled_key,M0.make_thread_cell(false));var loop4875 = function(l4876) {if (M0.null_p(l4876)!==false) {var if_res7294 = M0.raise(e4872);} else {if (M0.caar(l4876)(e4872)!==false) {var begin_res7288 = M0.cdar(l4876)(e4872);var __context7289 = $rjs_core.Marks.getFrames();var __context7290;try {__context7290 = $rjs_core.Marks.enterFrame();$rjs_core.Marks.setMark(M1.break_enabled_key,bpz4873);var __wcm_result7291 = M1.check_for_break();} finally {$rjs_core.Marks.updateFrame(__context7289,__context7290);}__wcm_result7291;var if_res7293 = begin_res7288;} else {var if_res7293 = loop4875(M0.cdr(l4876));}var if_res7294 = if_res7293;}return if_res7294;};var __wcm_result7297 = loop4875(l4874);} finally {$rjs_core.Marks.updateFrame(__context7295,__context7296);}return __wcm_result7297;};var select_handler_by_breaks_as_is = function(_e48777349, _bpz48787350, _l48797351) {lambda_start7348:while (true){let e4877 = _e48777349;let bpz4878 = _bpz48787350;let l4879 = _l48797351;if (M0.null_p(l4879)!==false) {return M0.raise(e4877);} else if (M0.caar(l4879)(e4877)!==false) {var __context7299 = $rjs_core.Marks.getFrames();var __context7300;try {__context7300 = $rjs_core.Marks.enterFrame();$rjs_core.Marks.setMark(M1.break_enabled_key,bpz4878);M1.check_for_break();var __wcm_result7301 = M0.cdar(l4879)(e4877);} finally {$rjs_core.Marks.updateFrame(__context7299,__context7300);}return __wcm_result7301;} else {_e48777349 = e4877;_bpz48787350 = bpz4878;_l48797351 = M0.cdr(l4879);continue lambda_start7348;}}};var false_thread_cell = M0.make_thread_cell(false);var check_with_handlers_in_context = function(handler_prompt_key4880) {if (M0.__rjs_quoted__.continuation_prompt_available_p(handler_prompt_key4880)!==false) {return M0.rvoid();} else {return M0.error($rjs_core.PrimitiveSymbol.make("with-handlers"),$rjs_core.UString.make("exception handler used out of context"));}};var handler_prompt_key = M0.make_continuation_prompt_tag($rjs_core.PrimitiveSymbol.make("handler-prompt-tag"));var call_handled_body = function(bpz4881, handle_proc4882, body_thunk4883) {var __context7314 = $rjs_core.Marks.getFrames();var __context7315;try {__context7315 = $rjs_core.Marks.enterFrame();$rjs_core.Marks.setMark(M1.break_enabled_key,false_thread_cell);var __wcm_result7316 = M0.call_with_continuation_prompt(function(bpz4884, body_thunk4885) {var __context7310 = $rjs_core.Marks.getFrames();var __context7311;try {__context7311 = $rjs_core.Marks.enterFrame();$rjs_core.Marks.setMark(M1.break_enabled_key,bpz4884);var __context7306 = $rjs_core.Marks.getFrames();var __context7307;try {__context7307 = __context7306;$rjs_core.Marks.setMark(M1.exception_handler_key,function(e4886) {return M0.abort_current_continuation(handler_prompt_key,e4886);});var __wcm_result7308 = body_thunk4885();} finally {$rjs_core.Marks.updateFrame(__context7306,__context7307);}var __wcm_result7312 = __wcm_result7308;} finally {$rjs_core.Marks.updateFrame(__context7310,__context7311);}return __wcm_result7312;},handler_prompt_key,handle_proc4882,bpz4881,body_thunk4883);} finally {$rjs_core.Marks.updateFrame(__context7314,__context7315);}return __wcm_result7316;};var call_with_exception_handler = function(exnh4887, thunk4888) {var __context7319 = $rjs_core.Marks.getFrames();var __context7320;try {__context7320 = $rjs_core.Marks.enterFrame();$rjs_core.Marks.setMark(M1.exception_handler_key,exnh4887);var __wcm_result7321 = thunk4888();} finally {$rjs_core.Marks.updateFrame(__context7319,__context7320);}var begin_res7318 = __wcm_result7321;M0.rvoid();return begin_res7318;};var call_by_cc = M0.__rjs_quoted__.call_with_current_continuation;var not_there = M0.gensym();var do_hash_update = function(who4889, mut_p4890, set4891, ht4892, key4893, xform4894, default4895) {if (M0.variable_reference_from_unsafe_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res7329 = M0.rvoid();} else {if (M0.hash_p(ht4892)!==false) {if (mut_p4890!==false) {var if_res7323 = M0.not(M0.immutable_p(ht4892));} else {var if_res7323 = M0.immutable_p(ht4892);}var if_res7324 = if_res7323;} else {var if_res7324 = false;}if (if_res7324!==false) {var if_res7326 = M0.rvoid();} else {if (mut_p4890!==false) {var if_res7325 = $rjs_core.UString.make("(and/c hash? (not/c immutable?))");} else {var if_res7325 = $rjs_core.UString.make("(and/c hash? immutable?)");}var if_res7326 = M0.raise_argument_error(who4889,if_res7325,ht4892);}if_res7326;if (M0.procedure_p(xform4894)!==false) {var if_res7327 = M0.procedure_arity_includes_p(xform4894,1);} else {var if_res7327 = false;}if (if_res7327!==false) {var if_res7328 = M0.rvoid();} else {var if_res7328 = M0.raise_argument_error(who4889,$rjs_core.UString.make("(any/c . -> . any/c)"),xform4894);}var if_res7329 = if_res7328;}if_res7329;var v4896 = M0.hash_ref(ht4892,key4893,default4895);if (M0.eq_p(v4896,not_there)!==false) {return M0.raise_mismatch_error(who4889,$rjs_core.UString.make("no value found for key: "),key4893);} else {return set4891(ht4892,key4893,xform4894(v4896));}};var cl7331 = function(ht4897, key4898, xform4899, default4900) {return do_hash_update($rjs_core.PrimitiveSymbol.make("hash-update"),false,M0.hash_set,ht4897,key4898,xform4899,default4900);};var cl7332 = function(ht4901, key4902, xform4903) {return hash_update(ht4901,key4902,xform4903,not_there);};var hash_update = $rjs_core.attachProcedureArity(function() {var fixed_lam7333 = {'4':cl7331,'3':cl7332}[arguments.length];if (fixed_lam7333!==undefined) {return fixed_lam7333.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[3,4]);var cl7334 = function(ht4904, key4905, xform4906, default4907) {return do_hash_update($rjs_core.PrimitiveSymbol.make("hash-update!"),true,M0.hash_set_bang_,ht4904,key4905,xform4906,default4907);};var cl7335 = function(ht4908, key4909, xform4910) {return hash_update_bang_(ht4908,key4909,xform4910,not_there);};var hash_update_bang_ = $rjs_core.attachProcedureArity(function() {var fixed_lam7336 = {'4':cl7334,'3':cl7335}[arguments.length];if (fixed_lam7336!==undefined) {return fixed_lam7336.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[3,4]);var hash_has_key_p = function(ht4911, key4912) {if (M0.hash_p(ht4911)!==false) {var if_res7337 = M0.rvoid();} else {var if_res7337 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("hash-has-key?"),$rjs_core.UString.make("hash?"),0,ht4911,key4912);}if_res7337;return M0.not(M0.eq_p(not_there,M0.hash_ref(ht4911,key4912,not_there)));};var hash_ref_bang_ = function(ht4913, key4914, new4915) {if (M0.hash_p(ht4913)!==false) {var if_res7338 = M0.not(M0.immutable_p(ht4913));} else {var if_res7338 = false;}if (if_res7338!==false) {var if_res7339 = M0.rvoid();} else {var if_res7339 = M0.raise_argument_error($rjs_core.PrimitiveSymbol.make("hash-ref!"),$rjs_core.UString.make("(and/c hash? (not/c immutable?))"),0,ht4913,key4914,new4915);}if_res7339;var v4916 = M0.hash_ref(ht4913,key4914,not_there);if (M0.eq_p(not_there,v4916)!==false) {if (M0.procedure_p(new4915)!==false) {var if_res7340 = new4915();} else {var if_res7340 = new4915;}var n4917 = if_res7340;M0.hash_set_bang_(ht4913,key4914,n4917);return n4917;} else {return v4916;}};var __rjs_quoted__ = {};__rjs_quoted__.call_by_cc = call_by_cc;__rjs_quoted__.select_handler_by_no_breaks = select_handler_by_no_breaks;__rjs_quoted__.call_handled_body = call_handled_body;__rjs_quoted__.select_handler_by_breaks_as_is = select_handler_by_breaks_as_is;export { __rjs_quoted__,hash_update_bang_,hash_update,hash_has_key_p,hash_ref_bang_,call_by_cc,call_with_exception_handler,break_paramz_p as break_parameterization_p,call_with_break_parameterization,current_break_parameterization,call_with_parameterization,current_parameterization };