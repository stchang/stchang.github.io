import * as $rjs_core from '../../../runtime/core.js';import * as M0 from "../../../runtime/kernel.rkt.js";import * as M1 from "./kw.rkt.js";var cl5494 = function(f3832, l3833) {if (M0.variable_reference_from_unsafe_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res5501 = true;} else {if (M0.procedure_p(f3832)!==false) {if (M0.procedure_arity_includes_p(f3832,1)!==false) {var if_res5499 = M0.list_p(l3833);} else {var if_res5499 = false;}var if_res5500 = if_res5499;} else {var if_res5500 = false;}var if_res5501 = if_res5500;}if (if_res5501!==false) {var loop3834 = function(l3835) {if (M0.null_p(l3835)!==false) {return M0.rnull;} else {var r3836 = M0.cdr(l3835);return M0.cons(f3832(M0.car(l3835)),loop3834(r3836));}};return loop3834(l3833);} else {return gen_map(f3832,M0.list(l3833));}};var cl5495 = function(f3837, l13838, l23839) {if (M0.variable_reference_from_unsafe_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res5508 = true;} else {if (M0.procedure_p(f3837)!==false) {if (M0.procedure_arity_includes_p(f3837,2)!==false) {if (M0.list_p(l13838)!==false) {if (M0.list_p(l23839)!==false) {var if_res5504 = M0.__eq_(M0.length(l13838),M0.length(l23839));} else {var if_res5504 = false;}var if_res5505 = if_res5504;} else {var if_res5505 = false;}var if_res5506 = if_res5505;} else {var if_res5506 = false;}var if_res5507 = if_res5506;} else {var if_res5507 = false;}var if_res5508 = if_res5507;}if (if_res5508!==false) {var loop3840 = function(l13841, l23842) {if (M0.null_p(l13841)!==false) {return M0.rnull;} else {var r13843 = M0.cdr(l13841);var r23844 = M0.cdr(l23842);return M0.cons(f3837(M0.car(l13841),M0.car(l23842)),loop3840(r13843,r23844));}};return loop3840(l13838,l23839);} else {return gen_map(f3837,M0.list(l13838,l23839));}};var cl5496 = $rjs_core.attachProcedureArity(function(f3845, l3846, ...args38475511) {var args3847 = $rjs_core.Pair.listFromArray(args38475511);return gen_map(f3845,M0.cons(l3846,args3847));});var map3831 = $rjs_core.attachProcedureArity(function() {var fixed_lam5497 = {'2':cl5494,'3':cl5495}[arguments.length];if (fixed_lam5497!==undefined) {return fixed_lam5497.apply(null,arguments);} else if (M0.__gt__eq_(cl5496.length,1)!==false) {return cl5496.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[M0.make_arity_at_least(2)]);var map2 = map3831;var cl5512 = function(f3849, l3850) {if (M0.variable_reference_from_unsafe_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res5519 = true;} else {if (M0.procedure_p(f3849)!==false) {if (M0.procedure_arity_includes_p(f3849,1)!==false) {var if_res5517 = M0.list_p(l3850);} else {var if_res5517 = false;}var if_res5518 = if_res5517;} else {var if_res5518 = false;}var if_res5519 = if_res5518;}if (if_res5519!==false) {var loop3851 = function(_l38525616) {lambda_start5615:while (true){let l3852 = _l38525616;if (M0.null_p(l3852)!==false) {return M0.rvoid();} else {var r3853 = M0.cdr(l3852);f3849(M0.car(l3852));_l38525616 = r3853;continue lambda_start5615;}}};return loop3851(l3850);} else {return gen_for_each(f3849,M0.list(l3850));}};var cl5513 = function(f3854, l13855, l23856) {if (M0.variable_reference_from_unsafe_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res5526 = true;} else {if (M0.procedure_p(f3854)!==false) {if (M0.procedure_arity_includes_p(f3854,2)!==false) {if (M0.list_p(l13855)!==false) {if (M0.list_p(l23856)!==false) {var if_res5522 = M0.__eq_(M0.length(l13855),M0.length(l23856));} else {var if_res5522 = false;}var if_res5523 = if_res5522;} else {var if_res5523 = false;}var if_res5524 = if_res5523;} else {var if_res5524 = false;}var if_res5525 = if_res5524;} else {var if_res5525 = false;}var if_res5526 = if_res5525;}if (if_res5526!==false) {var loop3857 = function(_l138585619, _l238595620) {lambda_start5618:while (true){let l13858 = _l138585619;let l23859 = _l238595620;if (M0.null_p(l13858)!==false) {return M0.rvoid();} else {var r13860 = M0.cdr(l13858);var r23861 = M0.cdr(l23859);f3854(M0.car(l13858),M0.car(l23859));_l138585619 = r13860;_l238595620 = r23861;continue lambda_start5618;}}};return loop3857(l13855,l23856);} else {return gen_for_each(f3854,M0.list(l13855,l23856));}};var cl5514 = $rjs_core.attachProcedureArity(function(f3862, l3863, ...args38645529) {var args3864 = $rjs_core.Pair.listFromArray(args38645529);return gen_for_each(f3862,M0.cons(l3863,args3864));});var for_each3848 = $rjs_core.attachProcedureArity(function() {var fixed_lam5515 = {'2':cl5512,'3':cl5513}[arguments.length];if (fixed_lam5515!==undefined) {return fixed_lam5515.apply(null,arguments);} else if (M0.__gt__eq_(cl5514.length,1)!==false) {return cl5514.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[M0.make_arity_at_least(2)]);var for_each2 = for_each3848;var cl5530 = function(f3866, l3867) {if (M0.variable_reference_from_unsafe_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res5537 = true;} else {if (M0.procedure_p(f3866)!==false) {if (M0.procedure_arity_includes_p(f3866,1)!==false) {var if_res5535 = M0.list_p(l3867);} else {var if_res5535 = false;}var if_res5536 = if_res5535;} else {var if_res5536 = false;}var if_res5537 = if_res5536;}if (if_res5537!==false) {if (M0.null_p(l3867)!==false) {return true;} else {var loop3868 = function(_l38695625) {lambda_start5624:while (true){let l3869 = _l38695625;if (M0.null_p(M0.cdr(l3869))!==false) {return f3866(M0.car(l3869));} else {var r3870 = M0.cdr(l3869);if (f3866(M0.car(l3869))!==false) {_l38695625 = r3870;continue lambda_start5624;} else {return false;}}}};return loop3868(l3867);}} else {return gen_andmap(f3866,M0.list(l3867));}};var cl5531 = function(f3871, l13872, l23873) {if (M0.variable_reference_from_unsafe_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res5546 = true;} else {if (M0.procedure_p(f3871)!==false) {if (M0.procedure_arity_includes_p(f3871,2)!==false) {if (M0.list_p(l13872)!==false) {if (M0.list_p(l23873)!==false) {var if_res5542 = M0.__eq_(M0.length(l13872),M0.length(l23873));} else {var if_res5542 = false;}var if_res5543 = if_res5542;} else {var if_res5543 = false;}var if_res5544 = if_res5543;} else {var if_res5544 = false;}var if_res5545 = if_res5544;} else {var if_res5545 = false;}var if_res5546 = if_res5545;}if (if_res5546!==false) {if (M0.null_p(l13872)!==false) {return true;} else {var loop3874 = function(_l138755628, _l238765629) {lambda_start5627:while (true){let l13875 = _l138755628;let l23876 = _l238765629;if (M0.null_p(M0.cdr(l13875))!==false) {return f3871(M0.car(l13875),M0.car(l23876));} else {var r13877 = M0.cdr(l13875);var r23878 = M0.cdr(l23876);if (f3871(M0.car(l13875),M0.car(l23876))!==false) {_l138755628 = r13877;_l238765629 = r23878;continue lambda_start5627;} else {return false;}}}};return loop3874(l13872,l23873);}} else {return gen_andmap(f3871,M0.list(l13872,l23873));}};var cl5532 = $rjs_core.attachProcedureArity(function(f3879, l3880, ...args38815551) {var args3881 = $rjs_core.Pair.listFromArray(args38815551);return gen_andmap(f3879,M0.cons(l3880,args3881));});var andmap3865 = $rjs_core.attachProcedureArity(function() {var fixed_lam5533 = {'2':cl5530,'3':cl5531}[arguments.length];if (fixed_lam5533!==undefined) {return fixed_lam5533.apply(null,arguments);} else if (M0.__gt__eq_(cl5532.length,1)!==false) {return cl5532.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[M0.make_arity_at_least(2)]);var andmap2 = andmap3865;var cl5552 = function(f3883, l3884) {if (M0.variable_reference_from_unsafe_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res5559 = true;} else {if (M0.procedure_p(f3883)!==false) {if (M0.procedure_arity_includes_p(f3883,1)!==false) {var if_res5557 = M0.list_p(l3884);} else {var if_res5557 = false;}var if_res5558 = if_res5557;} else {var if_res5558 = false;}var if_res5559 = if_res5558;}if (if_res5559!==false) {if (M0.null_p(l3884)!==false) {return false;} else {var loop3885 = function(_l38865634) {lambda_start5633:while (true){let l3886 = _l38865634;if (M0.null_p(M0.cdr(l3886))!==false) {return f3883(M0.car(l3886));} else {var r3887 = M0.cdr(l3886);var or_part3888 = f3883(M0.car(l3886));if (or_part3888!==false) {return or_part3888;} else {_l38865634 = r3887;continue lambda_start5633;}}}};return loop3885(l3884);}} else {return gen_ormap(f3883,M0.list(l3884));}};var cl5553 = function(f3889, l13890, l23891) {if (M0.variable_reference_from_unsafe_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res5568 = true;} else {if (M0.procedure_p(f3889)!==false) {if (M0.procedure_arity_includes_p(f3889,2)!==false) {if (M0.list_p(l13890)!==false) {if (M0.list_p(l23891)!==false) {var if_res5564 = M0.__eq_(M0.length(l13890),M0.length(l23891));} else {var if_res5564 = false;}var if_res5565 = if_res5564;} else {var if_res5565 = false;}var if_res5566 = if_res5565;} else {var if_res5566 = false;}var if_res5567 = if_res5566;} else {var if_res5567 = false;}var if_res5568 = if_res5567;}if (if_res5568!==false) {if (M0.null_p(l13890)!==false) {return false;} else {var loop3892 = function(_l138935637, _l238945638) {lambda_start5636:while (true){let l13893 = _l138935637;let l23894 = _l238945638;if (M0.null_p(M0.cdr(l13893))!==false) {return f3889(M0.car(l13893),M0.car(l23894));} else {var r13895 = M0.cdr(l13893);var r23896 = M0.cdr(l23894);var or_part3897 = f3889(M0.car(l13893),M0.car(l23894));if (or_part3897!==false) {return or_part3897;} else {_l138935637 = r13895;_l238945638 = r23896;continue lambda_start5636;}}}};return loop3892(l13890,l23891);}} else {return gen_ormap(f3889,M0.list(l13890,l23891));}};var cl5554 = $rjs_core.attachProcedureArity(function(f3898, l3899, ...args39005573) {var args3900 = $rjs_core.Pair.listFromArray(args39005573);return gen_ormap(f3898,M0.cons(l3899,args3900));});var ormap3882 = $rjs_core.attachProcedureArity(function() {var fixed_lam5555 = {'2':cl5552,'3':cl5553}[arguments.length];if (fixed_lam5555!==undefined) {return fixed_lam5555.apply(null,arguments);} else if (M0.__gt__eq_(cl5554.length,1)!==false) {return cl5554.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[M0.make_arity_at_least(2)]);var ormap2 = ormap3882;var check_args = function(who3901, f3902, ls3903) {if (M0.procedure_p(f3902)!==false) {var if_res5574 = M0.rvoid();} else {var if_res5574 = M0.raise_argument_error(who3901,$rjs_core.UString.make("procedure?"),f3902);}if_res5574;var loop3904 = function(_prev_len39055643, _ls39065644, _i39075645) {lambda_start5642:while (true){let prev_len3905 = _prev_len39055643;let ls3906 = _ls39065644;let i3907 = _i39075645;if (M0.null_p(ls3906)!==false) {return M0.rvoid();} else {var l3908 = M0.car(ls3906);if (M0.list_p(l3908)!==false) {var if_res5575 = M0.rvoid();} else {var if_res5575 = M0.raise_argument_error(who3901,$rjs_core.UString.make("list?"),l3908);}if_res5575;var len3909 = M0.length(l3908);if (prev_len3905!==false) {var if_res5576 = M0.not(M0.__eq_(len3909,prev_len3905));} else {var if_res5576 = false;}if (if_res5576!==false) {var if_res5577 = M0.raise_arguments_error(who3901,$rjs_core.UString.make("all lists must have same size"),$rjs_core.UString.make("first list length"),prev_len3905,$rjs_core.UString.make("other list length"),len3909,$rjs_core.UString.make("procedure"),f3902);} else {var if_res5577 = M0.rvoid();}if_res5577;_prev_len39055643 = len3909;_ls39065644 = M0.cdr(ls3906);_i39075645 = M0.add1(i3907);continue lambda_start5642;}}};loop3904(false,ls3903,1);if (M0.procedure_arity_includes_p(f3902,M0.length(ls3903))!==false) {return M0.rvoid();} else {var let_result5579 = M1.procedure_keywords(f3902);var required_keywords3910 = let_result5579.getAt(0);var optional_keywords3911 = let_result5579.getAt(1);if (M0.pair_p(required_keywords3910)!==false) {var if_res5594 = M0.string_append($rjs_core.UString.make("argument mismatch;\n"),$rjs_core.UString.make(" the given procedure expects keyword arguments"));} else {var if_res5594 = M0.string_append($rjs_core.UString.make("argument mismatch;\n"),$rjs_core.UString.make(" the given procedure's expected number of arguments does not match"),$rjs_core.UString.make(" the given number of lists"));}var temp5593 = $rjs_core.UString.make("given procedure");var n3913 = M0.object_name(f3902);if (M0.symbol_p(n3913)!==false) {var if_res5590 = M0.symbol__gt_string(n3913);} else {var if_res5590 = false;}var or_part3912 = if_res5590;if (or_part3912!==false) {var if_res5591 = or_part3912;} else {var if_res5591 = $rjs_core.UString.make("#<procedure>");}var temp5592 = M0.unquoted_printing_string(if_res5591);var a3914 = M0.procedure_arity(f3902);if (M0.pair_p(required_keywords3910)!==false) {var if_res5589 = M0.rnull;} else {if (M0.integer_p(a3914)!==false) {var if_res5588 = M0.list($rjs_core.UString.make("expected"),a3914);} else {if (M0.arity_at_least_p(a3914)!==false) {var if_res5587 = M0.list($rjs_core.UString.make("expected"),M0.unquoted_printing_string(M0.string_append($rjs_core.UString.make("at least "),M0.number__gt_string(M0.arity_at_least_value(a3914)))));} else {var if_res5587 = M0.rnull;}var if_res5588 = if_res5587;}var if_res5589 = if_res5588;}if (M0.pair_p(required_keywords3910)!==false) {var if_res5586 = M0.rnull;} else {var if_res5586 = M0.list($rjs_core.UString.make("given"),M0.length(ls3903));}if (M0.pair_p(required_keywords3910)!==false) {var temp5584 = $rjs_core.UString.make("required keywords");var loop3915 = function(kws3916) {if (M0.null_p(kws3916)!==false) {return M0.rnull;} else {return M0.list_times_($rjs_core.UString.make(" "),M0.string_append($rjs_core.UString.make("#:"),M0.__rjs_quoted__.keyword__gt_string(M0.car(kws3916))),loop3915(M0.cdr(kws3916)));}};var if_res5585 = M0.list(temp5584,M0.unquoted_printing_string(M0.apply(M0.string_append,M0.cdr(loop3915(required_keywords3910)))));} else {var if_res5585 = M0.rnull;}var w3917 = M0.quotient(M0.error_print_width(),M0.length(ls3903));if (M0.__gt_(w3917,10)!==false) {var temp5581 = $rjs_core.UString.make("argument lists...");var loop3918 = function(ls3919) {if (M0.null_p(ls3919)!==false) {return M0.rnull;} else {return M0.cons(M0.string_append($rjs_core.UString.make("\n   "),M0.error_value__gt_string_handler()(M0.car(ls3919),w3917)),loop3918(M0.cdr(ls3919)));}};var if_res5582 = M0.list(temp5581,M0.unquoted_printing_string(M0.apply(M0.string_append,loop3918(ls3903))));} else {var if_res5582 = M0.rnull;}return M0.apply(M0.raise_arguments_error,who3901,if_res5594,temp5593,temp5592,M0.append(if_res5589,if_res5586,if_res5585,if_res5582));}};var gen_map = function(f3920, ls3921) {if (M0.variable_reference_from_unsafe_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res5596 = true;} else {var if_res5596 = check_args($rjs_core.PrimitiveSymbol.make("map"),f3920,ls3921);}if_res5596;var loop3922 = function(ls3923) {if (M0.null_p(M0.car(ls3923))!==false) {return M0.rnull;} else {var next_ls3924 = map2(M0.cdr,ls3923);return M0.cons(M0.apply(f3920,map2(M0.car,ls3923)),loop3922(next_ls3924));}};return loop3922(ls3921);};var gen_for_each = function(f3925, ls3926) {if (M0.variable_reference_from_unsafe_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res5598 = true;} else {var if_res5598 = check_args($rjs_core.PrimitiveSymbol.make("for-each"),f3925,ls3926);}if_res5598;var loop3927 = function(_ls39285652) {lambda_start5651:while (true){let ls3928 = _ls39285652;if (M0.null_p(M0.car(ls3928))!==false) {return M0.rvoid();} else {var next_ls3929 = map2(M0.cdr,ls3928);M0.apply(f3925,map2(M0.car,ls3928));_ls39285652 = next_ls3929;continue lambda_start5651;}}};return loop3927(ls3926);};var gen_andmap = function(f3930, ls3931) {if (M0.variable_reference_from_unsafe_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res5600 = true;} else {var if_res5600 = check_args($rjs_core.PrimitiveSymbol.make("andmap"),f3930,ls3931);}if_res5600;var loop3932 = function(_ls39335655) {lambda_start5654:while (true){let ls3933 = _ls39335655;if (M0.null_p(M0.car(ls3933))!==false) {return true;} else if (M0.null_p(M0.cdar(ls3933))!==false) {return M0.apply(f3930,map2(M0.car,ls3933));} else {var next_ls3934 = map2(M0.cdr,ls3933);if (M0.apply(f3930,map2(M0.car,ls3933))!==false) {_ls39335655 = next_ls3934;continue lambda_start5654;} else {return false;}}}};return loop3932(ls3931);};var gen_ormap = function(f3935, ls3936) {if (M0.variable_reference_from_unsafe_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res5604 = true;} else {var if_res5604 = check_args($rjs_core.PrimitiveSymbol.make("ormap"),f3935,ls3936);}if_res5604;var loop3937 = function(_ls39385658) {lambda_start5657:while (true){let ls3938 = _ls39385658;if (M0.null_p(M0.car(ls3938))!==false) {return false;} else if (M0.null_p(M0.cdar(ls3938))!==false) {return M0.apply(f3935,map2(M0.car,ls3938));} else {var next_ls3939 = map2(M0.cdr,ls3938);var or_part3940 = M0.apply(f3935,map2(M0.car,ls3938));if (or_part3940!==false) {return or_part3940;} else {_ls39385658 = next_ls3939;continue lambda_start5657;}}}};return loop3937(ls3936);};M0.rvoid();var __rjs_quoted__ = {};export { __rjs_quoted__,ormap2 as ormap,andmap2 as andmap,for_each2 as for_each,map2 as map };