import * as $rjs_core from '../../../runtime/core.js';import * as M0 from "../../../runtime/kernel.rkt.js";import * as M1 from "../../../runtime/unsafe.rkt.js";var let_result2388 = M0.make_struct_type_property($rjs_core.PrimitiveSymbol.make("keyword-impersonator"));var prop_keyword_impersonator = let_result2388.getAt(0);var keyword_impersonator_p = let_result2388.getAt(1);var keyword_impersonator_ref = let_result2388.getAt(2);var keyword_procedure_impersonator_of = function(v1753) {if (keyword_impersonator_p(v1753)!==false) {return keyword_impersonator_ref(v1753)(v1753);} else {return false;}};var let_result2390 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("keyword-procedure"),false,4,0,false,M0.list(M0.cons(M0.prop_checked_procedure,true),M0.cons(M0.prop_impersonator_of,keyword_procedure_impersonator_of)),M0.current_inspector(),false,$rjs_core.Pair.makeList(0,1,2,3));var struct_keyword_procedure = let_result2390.getAt(0);var mk_kw_proc = let_result2390.getAt(1);var keyword_procedure_p = let_result2390.getAt(2);var keyword_procedure_ref = let_result2390.getAt(3);var keyword_procedure_set_bang_ = let_result2390.getAt(4);var keyword_procedure_checker = M0.make_struct_field_accessor(keyword_procedure_ref,0);var keyword_procedure_proc = M0.make_struct_field_accessor(keyword_procedure_ref,1);var keyword_procedure_required = M0.make_struct_field_accessor(keyword_procedure_ref,2);var keyword_procedure_allowed = M0.make_struct_field_accessor(keyword_procedure_ref,3);var let_result2391 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("procedure"),struct_keyword_procedure,0,0,false,M0.list(M0.cons(M0.prop_method_arity_error,true)));var struct_keyword_method = let_result2391.getAt(0);var make_km = let_result2391.getAt(1);var keyword_method_p = let_result2391.getAt(2);var km_ref = let_result2391.getAt(3);var km_set_bang_ = let_result2391.getAt(4);var generate_arity_string = function(proc1754) {var let_result2392 = procedure_keywords(proc1754);var req1755 = let_result2392.getAt(0);var allowed1756 = let_result2392.getAt(1);var a1757 = M0.procedure_arity(proc1754);var keywords_desc1758 = function(opt1760, req1761) {var temp2398 = $rjs_core.UString.make("~a with keyword~a~a");if (M0.null_p(M0.cdr(req1761))!==false) {var if_res2397 = M0.format($rjs_core.UString.make("an ~aargument"),opt1760);} else {var if_res2397 = M0.format($rjs_core.UString.make("~aarguments"),opt1760);}if (M0.null_p(M0.cdr(req1761))!==false) {var if_res2396 = $rjs_core.UString.make("");} else {var if_res2396 = $rjs_core.UString.make("s");}var tmp1762 = M0.length(req1761);if (M0.equal_p(tmp1762,1)!==false) {var if_res2395 = M0.format($rjs_core.UString.make(" ~a"),M0.car(req1761));} else {if (M0.equal_p(tmp1762,2)!==false) {var if_res2394 = M0.format($rjs_core.UString.make(" ~a and ~a"),M0.car(req1761),M0.cadr(req1761));} else {var loop1763 = function(req1764) {if (M0.null_p(M0.cdr(req1764))!==false) {return M0.format($rjs_core.UString.make(" and ~a"),M0.car(req1764));} else {return M0.format($rjs_core.UString.make(" ~a,~a"),M0.car(req1764),loop1763(M0.cdr(req1764)));}};var if_res2394 = loop1763(req1761);}var if_res2395 = if_res2394;}return M0.format(temp2398,if_res2397,if_res2396,if_res2395);};var method_adjust1759 = function(a1765) {var or_part1766 = okm_p(proc1754);if (or_part1766!==false) {var if_res2399 = or_part1766;} else {var if_res2399 = keyword_method_p(proc1754);}if (if_res2399!==false) {if (M0.zero_p(a1765)!==false) {return 0;} else {return M0.sub1(a1765);}} else {return a1765;}};if (M0.number_p(a1757)!==false) {var a1767 = method_adjust1759(a1757);var if_res2408 = M0.format($rjs_core.UString.make("~a"),a1767);} else {if (M0.arity_at_least_p(a1757)!==false) {var a1768 = method_adjust1759(M0.arity_at_least_value(a1757));var if_res2407 = M0.format($rjs_core.UString.make("at least ~a"),a1768);} else {var if_res2407 = $rjs_core.UString.make("a different number");}var if_res2408 = if_res2407;}if (M0.null_p(req1755)!==false) {var if_res2406 = $rjs_core.UString.make("");} else {var if_res2406 = M0.format($rjs_core.UString.make(" plus ~a"),keywords_desc1758($rjs_core.UString.make(""),req1755));}if (allowed1756!==false) {var loop1770 = function(_req17712736, _allowed17722737) {lambda_start2735:while (true){let req1771 = _req17712736;let allowed1772 = _allowed17722737;if (M0.null_p(req1771)!==false) {return allowed1772;} else if (M0.eq_p(M0.car(req1771),M0.car(allowed1772))!==false) {_req17712736 = M0.cdr(req1771);_allowed17722737 = M0.cdr(allowed1772);continue lambda_start2735;} else {return M0.cons(M0.car(allowed1772),loop1770(req1771,M0.cdr(allowed1772)));}}};var others1769 = loop1770(req1755,allowed1756);if (M0.null_p(others1769)!==false) {var if_res2404 = $rjs_core.UString.make("");} else {var if_res2404 = M0.format($rjs_core.UString.make(" plus ~a"),keywords_desc1758($rjs_core.UString.make("optional "),others1769));}var if_res2405 = if_res2404;} else {var if_res2405 = $rjs_core.UString.make(" plus arbitrary keyword arguments");}return M0.string_append(if_res2408,if_res2406,if_res2405);};var let_result2409 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("procedure"),struct_keyword_procedure,1,0,false,M0.list(M0.cons(M0.prop_arity_string,generate_arity_string)),M0.current_inspector(),0);var struct_okp = let_result2409.getAt(0);var make_optional_keyword_procedure = let_result2409.getAt(1);var okp_p = let_result2409.getAt(2);var okp_ref = let_result2409.getAt(3);var okp_set_bang_ = let_result2409.getAt(4);var let_result2410 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("procedure"),struct_okp,0,0,false,M0.list(M0.cons(M0.prop_method_arity_error,true)));var struct_okm = let_result2410.getAt(0);var make_optional_keyword_method = let_result2410.getAt(1);var okm_p = let_result2410.getAt(2);var okm_ref = let_result2410.getAt(3);var okm_set_bang_ = let_result2410.getAt(4);var let_result2411 = M0.make_struct_type_property($rjs_core.PrimitiveSymbol.make("named-keyword-procedure"));var prop_named_keyword_procedure = let_result2411.getAt(0);var named_keyword_procedure_p = let_result2411.getAt(1);var keyword_procedure_name_plus_fail = let_result2411.getAt(2);var let_result2413 = M0.make_struct_type_property($rjs_core.PrimitiveSymbol.make("procedure"),function(v1773, info_l1774) {if (M0.exact_integer_p(v1773)!==false) {return M0.make_struct_field_accessor(M0.list_ref(info_l1774,3),v1773);} else {return false;}});var prop_procedure_accessor = let_result2413.getAt(0);var procedure_accessor_p = let_result2413.getAt(1);var procedure_accessor_ref = let_result2413.getAt(2);var let_result2414 = M0.make_struct_type_property($rjs_core.PrimitiveSymbol.make("procedure"),false,M0.list(M0.cons(M0.prop_procedure,M0.values),M0.cons(prop_procedure_accessor,M0.values)),true);var new_prop_procedure = let_result2414.getAt(0);var new_procedure_p = let_result2414.getAt(1);var new_procedure_ref = let_result2414.getAt(2);var let_result2415 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("procedure"),struct_keyword_procedure,1,0,false,M0.list(M0.cons(prop_keyword_impersonator,function(v1775) {return kpp_ref(v1775,0);})));var struct_keyword_procedure_impersonator = let_result2415.getAt(0);var make_kpp = let_result2415.getAt(1);var keyword_procedure_impersonator_p = let_result2415.getAt(2);var kpp_ref = let_result2415.getAt(3);var kpp_set_bang_ = let_result2415.getAt(4);var let_result2416 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("procedure"),struct_keyword_method,1,0,false,M0.list(M0.cons(prop_keyword_impersonator,function(v1776) {return kmp_ref(v1776,0);})));var struct_keyword_method_impersonator = let_result2416.getAt(0);var make_kmp = let_result2416.getAt(1);var keyword_method_impersonator_p = let_result2416.getAt(2);var kmp_ref = let_result2416.getAt(3);var kmp_set_bang_ = let_result2416.getAt(4);var let_result2417 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("procedure"),struct_okp,1,0,false,M0.list(M0.cons(prop_keyword_impersonator,function(v1777) {return okpp_ref(v1777,0);})));var struct_okpp = let_result2417.getAt(0);var make_optional_keyword_procedure_impersonator = let_result2417.getAt(1);var okpp_p = let_result2417.getAt(2);var okpp_ref = let_result2417.getAt(3);var okpp_set_bang_ = let_result2417.getAt(4);var let_result2418 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("procedure"),struct_okp,1,0,false,M0.list(M0.cons(prop_keyword_impersonator,function(v1778) {return okmp_ref(v1778,0);})));var struct_okmp = let_result2418.getAt(0);var make_optional_keyword_method_impersonator = let_result2418.getAt(1);var okmp_p = let_result2418.getAt(2);var okmp_ref = let_result2418.getAt(3);var okmp_set_bang_ = let_result2418.getAt(4);var let_result2419 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("procedure"),struct_keyword_procedure,0,0,false,M0.list(M0.cons(M0.prop_arity_string,generate_arity_string),M0.cons(M0.prop_incomplete_arity,true)));var struct_keyword_procedure_by_arity_error = let_result2419.getAt(0);var make_kp_by_ae = let_result2419.getAt(1);var kp_by_ae_p = let_result2419.getAt(2);var kp_by_ae_ref = let_result2419.getAt(3);var kp_by_ae_set_bang_ = let_result2419.getAt(4);var let_result2420 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("procedure"),struct_keyword_method,0,0,false,M0.list(M0.cons(M0.prop_arity_string,generate_arity_string),M0.cons(M0.prop_incomplete_arity,true)));var struct_keyword_method_by_arity_error = let_result2420.getAt(0);var make_km_by_ae = let_result2420.getAt(1);var km_by_ae_p = let_result2420.getAt(2);var km_by_ae_ref = let_result2420.getAt(3);var km_by_ae_set_bang_ = let_result2420.getAt(4);var let_result2421 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("procedure"),struct_keyword_procedure_impersonator,0,0,false,M0.list(M0.cons(M0.prop_arity_string,generate_arity_string),M0.cons(M0.prop_incomplete_arity,true)));var struct_keyword_procedure_impersonator_by_arity_error = let_result2421.getAt(0);var make_kpi_by_ae = let_result2421.getAt(1);var kpi_by_ae_p = let_result2421.getAt(2);var kpi_by_ae_ref = let_result2421.getAt(3);var kpi_by_ae_set_bang_ = let_result2421.getAt(4);var let_result2422 = M0.make_struct_type($rjs_core.PrimitiveSymbol.make("procedure"),struct_keyword_method_impersonator,0,0,false,M0.list(M0.cons(M0.prop_arity_string,generate_arity_string),M0.cons(M0.prop_incomplete_arity,true)));var struct_keyword_method_impersonator_by_arity_error = let_result2422.getAt(0);var make_kmi_by_ae = let_result2422.getAt(1);var kmi_by_ae_p = let_result2422.getAt(2);var kmi_by_ae_ref = let_result2422.getAt(3);var kmi_by_ae_set_bang_ = let_result2422.getAt(4);var make_required = function(name1779, realm1780, fail_proc1781, method_p1782, impersonator_p1783) {var or_part1789 = name1779;if (or_part1789!==false) {var if_res2426 = or_part1789;} else {var if_res2426 = $rjs_core.PrimitiveSymbol.make("unknown");}if (impersonator_p1783!==false) {if (method_p1782!==false) {var if_res2423 = struct_keyword_method_impersonator_by_arity_error;} else {var if_res2423 = struct_keyword_procedure_impersonator_by_arity_error;}var if_res2425 = if_res2423;} else {if (method_p1782!==false) {var if_res2424 = struct_keyword_method_by_arity_error;} else {var if_res2424 = struct_keyword_procedure_by_arity_error;}var if_res2425 = if_res2424;}var let_result2427 = M0.make_struct_type(if_res2426,if_res2425,0,0,false,M0.list(M0.cons(prop_named_keyword_procedure,M0.vector(name1779,realm1780,fail_proc1781))),M0.current_inspector(),fail_proc1781);var s_1784 = let_result2427.getAt(0);var mk1785 = let_result2427.getAt(1);var __p1786 = let_result2427.getAt(2);var __ref1787 = let_result2427.getAt(3);var __set_bang_1788 = let_result2427.getAt(4);return mk1785;};var cl2428 = function(proc1790) {var proc_name1791 = M0.object_name(proc1790);if (M0.procedure_p(proc1790)!==false) {var if_res2431 = M0.__rjs_quoted__.procedure_realm(proc1790);} else {var if_res2431 = false;}var proc_realm1792 = if_res2431;var plain_proc1793 = $rjs_core.attachProcedureArity(function(...args17942432) {var args1794 = $rjs_core.Pair.listFromArray(args17942432);return M0.apply(proc1790,M0.rnull,M0.rnull,args1794);});if (M0.procedure_p(proc1790)!==false) {var if_res2433 = M0.arithmetic_shift(M0.procedure_arity_mask(proc1790),-2);} else {var if_res2433 = false;}var mask1795 = if_res2433;if (M0.procedure_p(plain_proc1793)!==false) {if (M0.exact_integer_p(mask1795)!==false) {if (M0.symbol_p(proc_name1791)!==false) {if (M0.symbol_p(proc_realm1792)!==false) {var if_res2434 = M0.__rjs_quoted__.procedure_reduce_arity_mask(plain_proc1793,mask1795,proc_name1791,proc_realm1792);} else {var if_res2434 = M0.__rjs_quoted__.procedure_reduce_arity_mask(plain_proc1793,mask1795,false,$rjs_core.PrimitiveSymbol.make("ignored"));}var if_res2435 = if_res2434;} else {var if_res2435 = M0.__rjs_quoted__.procedure_reduce_arity_mask(plain_proc1793,mask1795,false,$rjs_core.PrimitiveSymbol.make("ignored"));}var if_res2436 = if_res2435;} else {var if_res2436 = plain_proc1793;}var if_res2437 = if_res2436;} else {var if_res2437 = plain_proc1793;}return make_keyword_procedure(proc1790,if_res2437);};var cl2429 = function(proc1796, plain_proc1797) {if (M0.procedure_p(proc1796)!==false) {var if_res2438 = M0.procedure_arity_mask(proc1796);} else {var if_res2438 = false;}return make_optional_keyword_procedure(make_keyword_checker(M0.rnull,false,if_res2438),proc1796,M0.rnull,false,plain_proc1797);};var make_keyword_procedure = $rjs_core.attachProcedureArity(function() {var fixed_lam2430 = {'1':cl2428,'2':cl2429}[arguments.length];if (fixed_lam2430!==undefined) {return fixed_lam2430.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[1,2]);var keyword_apply = $rjs_core.attachProcedureArity(function(proc1798, kws1799, kw_vals1800, normal_args1801, ...normal_argss18022439) {var normal_argss1802 = $rjs_core.Pair.listFromArray(normal_argss18022439);var type_error1803 = function(what1804, which1805) {return M0.apply(M0.raise_argument_error,$rjs_core.PrimitiveSymbol.make("keyword-apply"),what1804,which1805,proc1798,kws1799,kw_vals1800,normal_args1801,normal_argss1802);};if (M0.procedure_p(proc1798)!==false) {var if_res2440 = M0.rvoid();} else {var if_res2440 = type_error1803($rjs_core.UString.make("procedure?"),0);}if_res2440;var loop1806 = function(_ks18072751) {lambda_start2750:while (true){let ks1807 = _ks18072751;if (M0.null_p(ks1807)!==false) {return M0.rvoid();} else {var or_part1808 = M0.not(M0.pair_p(ks1807));if (or_part1808!==false) {var if_res2441 = or_part1808;} else {var if_res2441 = M0.not(M0.keyword_p(M0.car(ks1807)));}if (if_res2441!==false) {return type_error1803($rjs_core.UString.make("(listof keyword?)"),1);} else if (M0.null_p(M0.cdr(ks1807))!==false) {return M0.rvoid();} else {var or_part1809 = M0.not(M0.pair_p(M0.cdr(ks1807)));if (or_part1809!==false) {var if_res2442 = or_part1809;} else {var if_res2442 = M0.not(M0.keyword_p(M0.cadr(ks1807)));}if (if_res2442!==false) {_ks18072751 = M0.cdr(ks1807);continue lambda_start2750;} else if (M0.keyword_lt__p(M0.car(ks1807),M0.cadr(ks1807))!==false) {_ks18072751 = M0.cdr(ks1807);continue lambda_start2750;} else {return type_error1803($rjs_core.UString.make("(and/c (listof? keyword?) sorted? distinct?)"),1);}}}}};loop1806(kws1799);if (M0.list_p(kw_vals1800)!==false) {var if_res2448 = M0.rvoid();} else {var if_res2448 = type_error1803($rjs_core.UString.make("list?"),2);}if_res2448;if (M0.__eq_(M0.length(kws1799),M0.length(kw_vals1800))!==false) {var if_res2449 = M0.rvoid();} else {var if_res2449 = M0.__rjs_quoted__.raise_arguments_error_times_($rjs_core.PrimitiveSymbol.make("keyword-apply"),$rjs_core.PrimitiveSymbol.make("racket/primitive"),$rjs_core.UString.make("keyword list length does not match value list length"),$rjs_core.UString.make("keyword list length"),M0.length(kws1799),$rjs_core.UString.make("value list length"),M0.length(kw_vals1800),$rjs_core.UString.make("keyword list"),kws1799,$rjs_core.UString.make("value list"),kw_vals1800);}if_res2449;var loop1811 = function(normal_argss1812, pos1813) {if (M0.null_p(M0.cdr(normal_argss1812))!==false) {var l1814 = M0.car(normal_argss1812);if (M0.list_p(l1814)!==false) {return l1814;} else {return type_error1803($rjs_core.UString.make("list?"),pos1813);}} else {return M0.cons(M0.car(normal_argss1812),loop1811(M0.cdr(normal_argss1812),M0.add1(pos1813)));}};var normal_args1810 = loop1811(M0.cons(normal_args1801,normal_argss1802),3);if (M0.null_p(kws1799)!==false) {return M0.apply(proc1798,normal_args1810);} else {return M0.apply(keyword_procedure_extract_by_method(kws1799,2+M0.length(normal_args1810),proc1798,0),kws1799,kw_vals1800,normal_args1810);}});var procedure_keywords = function(_p18152754) {lambda_start2753:while (true){let p1815 = _p18152754;if (keyword_procedure_p(p1815)!==false) {return M0.values(keyword_procedure_required(p1815),keyword_procedure_allowed(p1815));} else if (M0.procedure_p(p1815)!==false) {if (new_procedure_p(p1815)!==false) {var v1816 = new_procedure_ref(p1815);if (M0.procedure_p(v1816)!==false) {_p18152754 = v1816;continue lambda_start2753;} else {var a1817 = procedure_accessor_ref(p1815);if (a1817!==false) {_p18152754 = a1817(p1815);continue lambda_start2753;} else {return M0.values(M0.rnull,M0.rnull);}}} else {return M0.values(M0.rnull,M0.rnull);}} else {return M0.__rjs_quoted__.raise_argument_error_times_($rjs_core.PrimitiveSymbol.make("procedure-keywords"),$rjs_core.PrimitiveSymbol.make("racket/primitive"),$rjs_core.UString.make("procedure?"),p1815);}}};var extract_keyword_root = function(_p18182756) {lambda_start2755:while (true){let p1818 = _p18182756;if (keyword_procedure_p(p1818)!==false) {return p1818;} else if (M0.procedure_p(p1818)!==false) {var v1819 = new_procedure_ref(p1818,false);if (M0.procedure_p(v1819)!==false) {_p18182756 = v1819;continue lambda_start2755;} else {var a1820 = procedure_accessor_ref(p1818,false);if (a1820!==false) {_p18182756 = a1820(p1818);continue lambda_start2755;} else {return false;}}} else {return false;}}};var missing_kw = $rjs_core.attachProcedureArity(function(proc1821, ...args18222462) {var args1822 = $rjs_core.Pair.listFromArray(args18222462);return M0.apply(keyword_procedure_extract_by_method(M0.rnull,0,proc1821,0),M0.rnull,M0.rnull,args1822);});var check_kw_args = function(p1823, kws1824) {var loop1825 = function(_kws18262760, _required18272761, _allowed18282762) {lambda_start2759:while (true){let kws1826 = _kws18262760;let required1827 = _required18272761;let allowed1828 = _allowed18282762;if (M0.null_p(kws1826)!==false) {if (M0.null_p(required1827)!==false) {return M0.values(false,false);} else {return M0.values(M0.car(required1827),false);}} else {if (M0.pair_p(required1827)!==false) {var if_res2464 = M0.eq_p(M0.car(required1827),M0.car(kws1826));} else {var if_res2464 = false;}if (if_res2464!==false) {var temp2467 = M0.cdr(kws1826);var temp2466 = M0.cdr(required1827);if (allowed1828!==false) {var if_res2465 = M0.cdr(allowed1828);} else {var if_res2465 = false;}_kws18262760 = temp2467;_required18272761 = temp2466;_allowed18282762 = if_res2465;continue lambda_start2759;} else if (M0.not(allowed1828)!==false) {_kws18262760 = M0.cdr(kws1826);_required18272761 = required1827;_allowed18282762 = false;continue lambda_start2759;} else if (M0.pair_p(allowed1828)!==false) {if (M0.eq_p(M0.car(allowed1828),M0.car(kws1826))!==false) {_kws18262760 = M0.cdr(kws1826);_required18272761 = required1827;_allowed18282762 = M0.cdr(allowed1828);continue lambda_start2759;} else {_kws18262760 = kws1826;_required18272761 = required1827;_allowed18282762 = M0.cdr(allowed1828);continue lambda_start2759;}} else {return M0.values(false,M0.car(kws1826));}}}};return loop1825(kws1824,keyword_procedure_required(p1823),keyword_procedure_allowed(p1823));};var make_keyword_checker = function(req_kws1829, allowed_kws1830, arity_mask1831) {if (M0.not(allowed_kws1830)!==false) {if (M0.null_p(req_kws1829)!==false) {return function(kws1832, a1833) {if (true!==false) {return M0.bitwise_bit_set_p(arity_mask1831,a1833);} else {return false;}};} else {return function(kws1834, a1835) {if (subset_p(req_kws1829,kws1834)!==false) {return M0.bitwise_bit_set_p(arity_mask1831,a1835);} else {return false;}};}} else if (M0.null_p(allowed_kws1830)!==false) {return function(kws1836, a1837) {if (M0.null_p(kws1836)!==false) {return M0.bitwise_bit_set_p(arity_mask1831,a1837);} else {return false;}};} else if (M0.null_p(req_kws1829)!==false) {return function(kws1838, a1839) {if (subset_p(kws1838,allowed_kws1830)!==false) {return M0.bitwise_bit_set_p(arity_mask1831,a1839);} else {return false;}};} else {if (M0.list_p(req_kws1829)!==false) {if (M0.list_p(allowed_kws1830)!==false) {var if_res2478 = M0.eq_p(M0.length(req_kws1829),M0.length(allowed_kws1830));} else {var if_res2478 = false;}var if_res2479 = if_res2478;} else {var if_res2479 = false;}if (if_res2479!==false) {return function(kws1840, a1841) {var loop1842 = function(_kws18432770, _req_kws18442771) {lambda_start2769:while (true){let kws1843 = _kws18432770;let req_kws1844 = _req_kws18442771;if (M0.null_p(req_kws1844)!==false) {return M0.null_p(kws1843);} else if (M0.null_p(kws1843)!==false) {return false;} else if (M0.eq_p(M0.car(kws1843),M0.car(req_kws1844))!==false) {_kws18432770 = M0.cdr(kws1843);_req_kws18442771 = M0.cdr(req_kws1844);continue lambda_start2769;} else {return false;}}};if (loop1842(kws1840,req_kws1829)!==false) {return M0.bitwise_bit_set_p(arity_mask1831,a1841);} else {return false;}};} else {return function(kws1845, a1846) {if (subsets_p(req_kws1829,kws1845,allowed_kws1830)!==false) {return M0.bitwise_bit_set_p(arity_mask1831,a1846);} else {return false;}};}}};var subset_p = function(_l118472774, _l218482775) {lambda_start2773:while (true){let l11847 = _l118472774;let l21848 = _l218482775;if (M0.null_p(l11847)!==false) {return true;} else if (M0.null_p(l21848)!==false) {return false;} else if (M0.eq_p(M0.car(l11847),M0.car(l21848))!==false) {_l118472774 = M0.cdr(l11847);_l218482775 = M0.cdr(l21848);continue lambda_start2773;} else {_l118472774 = l11847;_l218482775 = M0.cdr(l21848);continue lambda_start2773;}}};var subsets_p = function(_l118492777, _l218502778, _l318512779) {lambda_start2776:while (true){let l11849 = _l118492777;let l21850 = _l218502778;let l31851 = _l318512779;if (M0.null_p(l11849)!==false) {return subset_p(l21850,l31851);} else if (M0.null_p(l21850)!==false) {return false;} else if (M0.null_p(l31851)!==false) {return false;} else {var v21852 = M0.car(l21850);if (M0.eq_p(M0.car(l11849),v21852)!==false) {_l118492777 = M0.cdr(l11849);_l218502778 = M0.cdr(l21850);_l318512779 = M0.cdr(l31851);continue lambda_start2776;} else if (M0.eq_p(v21852,M0.car(l31851))!==false) {_l118492777 = l11849;_l218502778 = M0.cdr(l21850);_l318512779 = M0.cdr(l31851);continue lambda_start2776;} else {_l118492777 = l11849;_l218502778 = l21850;_l318512779 = M0.cdr(l31851);continue lambda_start2776;}}}};var keyword_procedure_extract_by_method = function(_kws18532782, _n18542783, _p18552784, _method_n18562785) {lambda_start2780:while (true){let kws1853 = _kws18532782;let n1854 = _n18542783;let p1855 = _p18552784;let method_n1856 = _method_n18562785;if (keyword_procedure_p(p1855)!==false) {var if_res2497 = keyword_procedure_checker(p1855)(kws1853,n1854);} else {var if_res2497 = false;}if (if_res2497!==false) {return keyword_procedure_proc(p1855);} else {if (M0.not(keyword_procedure_p(p1855))!==false) {if (M0.procedure_p(p1855)!==false) {if (new_procedure_p(p1855)!==false) {var a1859 = procedure_accessor_ref(p1855);if (a1859!==false) {var if_res2498 = a1859(p1855);} else {var if_res2498 = false;}var if_res2499 = if_res2498;} else {var if_res2499 = false;}var or_part1858 = if_res2499;if (or_part1858!==false) {var if_res2502 = or_part1858;} else {var or_part1860 = M0.procedure_extract_target(p1855);if (or_part1860!==false) {var if_res2501 = or_part1860;} else {if (new_procedure_p(p1855)!==false) {var if_res2500 = $rjs_core.PrimitiveSymbol.make("method");} else {var if_res2500 = false;}var if_res2501 = if_res2500;}var if_res2502 = if_res2501;}var if_res2503 = if_res2502;} else {var if_res2503 = false;}var if_res2504 = if_res2503;} else {var if_res2504 = false;}var p21857 = if_res2504;if (p21857!==false) {if (M0.eq_p(p21857,$rjs_core.PrimitiveSymbol.make("method"))!==false) {var p31861 = keyword_procedure_extract_by_method(kws1853,M0.add1(n1854),new_procedure_ref(p1855),M0.add1(method_n1856));return $rjs_core.attachProcedureArity(function(kws1862, kw_args1863, ...args18642505) {var args1864 = $rjs_core.Pair.listFromArray(args18642505);return M0.apply(p31861,kws1862,kw_args1863,M0.cons(p1855,args1864));});} else {_kws18532782 = kws1853;_n18542783 = n1854;_p18552784 = p21857;_method_n18562785 = method_n1856;continue lambda_start2780;}} else {return $rjs_core.attachProcedureArity(function(kws1865, kw_args1866, ...args18672507) {var args1867 = $rjs_core.Pair.listFromArray(args18672507);if (keyword_procedure_p(p1855)!==false) {var if_res2508 = check_kw_args(p1855,kws1865);} else {var if_res2508 = M0.values(false,M0.car(kws1865));}var let_result2509 = if_res2508;var missing_kw1868 = let_result2509.getAt(0);var extra_kw1869 = let_result2509.getAt(1);var or_part1874 = keyword_method_p(p1855);if (or_part1874!==false) {var if_res2510 = or_part1874;} else {var if_res2510 = okm_p(p1855);}if (if_res2510!==false) {var if_res2511 = 1;} else {var if_res2511 = 0;}var method_n1873 = method_n1856+if_res2511;if (M0.__gt__eq_(n1854,method_n1873)!==false) {var if_res2512 = n1854-method_n1873;} else {var if_res2512 = n1854;}var n1870 = if_res2512;if (M0.null_p(args1867)!==false) {var if_res2513 = M0.null_p(kws1865);} else {var if_res2513 = false;}if (if_res2513!==false) {var if_res2514 = $rjs_core.UString.make("");} else {var if_res2514 = M0.apply(M0.string_append,$rjs_core.UString.make("\n  arguments...:"),M0.append(M0.map(function(v1875) {return M0.format($rjs_core.UString.make("\n   ~e"),v1875);},args1867),M0.map(function(kw1876, kw_arg1877) {return M0.format($rjs_core.UString.make("\n   ~a ~e"),kw1876,kw_arg1877);},kws1865,kw_args1866)));}var args_str1871 = if_res2514;var proc_name1872 = function(p1878) {if (named_keyword_procedure_p(p1878)!==false) {var if_res2515 = M0.vector_ref(keyword_procedure_name_plus_fail(p1878),0);} else {var if_res2515 = false;}var or_part1879 = if_res2515;if (or_part1879!==false) {return or_part1879;} else {var or_part1880 = M0.object_name(p1878);if (or_part1880!==false) {return or_part1880;} else {return p1878;}}};var application_message1881 = function(str1882) {return M0.__rjs_quoted__.error_message__gt_adjusted_string($rjs_core.PrimitiveSymbol.make("application"),$rjs_core.PrimitiveSymbol.make("racket/primitive"),str1882,$rjs_core.PrimitiveSymbol.make("racket/primitive"));};var or_part1883 = extra_kw1869;if (or_part1883!==false) {var if_res2524 = or_part1883;} else {var if_res2524 = missing_kw1868;}if (if_res2524!==false) {var if_res2525 = M0.__rjs_quoted__.exn_fail_contract;} else {var if_res2525 = M0.__rjs_quoted__.exn_fail_contract_arity;}if (extra_kw1869!==false) {if (keyword_procedure_p(p1855)!==false) {var if_res2519 = application_message1881(M0.format(M0.string_append($rjs_core.UString.make("procedure does not expect an argument with given keyword\n"),$rjs_core.UString.make("  procedure: ~a\n"),$rjs_core.UString.make("  given keyword: ~a"),$rjs_core.UString.make("~a")),proc_name1872(p1855),extra_kw1869,args_str1871));} else {if (M0.procedure_p(p1855)!==false) {var if_res2518 = application_message1881(M0.format(M0.string_append($rjs_core.UString.make("procedure does not accept keyword arguments\n"),$rjs_core.UString.make("  procedure: ~a"),$rjs_core.UString.make("~a")),proc_name1872(p1855),args_str1871));} else {var if_res2518 = application_message1881(M0.format(M0.string_append($rjs_core.UString.make("not a procedure;\n"),$rjs_core.UString.make(" expected a procedure that can be applied to arguments\n"),$rjs_core.UString.make("  given: ~e"),$rjs_core.UString.make("~a")),p1855,args_str1871));}var if_res2519 = if_res2518;}var if_res2523 = if_res2519;} else {if (missing_kw1868!==false) {var if_res2522 = application_message1881(M0.format(M0.string_append($rjs_core.UString.make("required keyword argument not supplied\n"),$rjs_core.UString.make("  procedure: ~a\n"),$rjs_core.UString.make("  required keyword: ~a"),$rjs_core.UString.make("~a")),proc_name1872(p1855),missing_kw1868,args_str1871));} else {var temp2521 = M0.string_append($rjs_core.UString.make("no case matching ~a non-keyword argument~a\n"),$rjs_core.UString.make("  procedure: ~a"),$rjs_core.UString.make("~a"));if (M0.__eq_(1,n1870-2)!==false) {var if_res2520 = $rjs_core.UString.make("");} else {var if_res2520 = $rjs_core.UString.make("s");}var if_res2522 = application_message1881(M0.format(temp2521,n1870-2,if_res2520,proc_name1872(p1855),args_str1871));}var if_res2523 = if_res2522;}return M0.raise(if_res2525(if_res2523,M0.current_continuation_marks()));});}}}};var keyword_procedure_extract = function(p1884, kws1885, n1886) {return keyword_procedure_extract_by_method(kws1885,n1886,p1884,0);};var cl2528 = function(proc1887, arity1888, req_kw1889, allowed_kw1890, name1891, realm1892) {return do_procedure_reduce_keyword_arity($rjs_core.PrimitiveSymbol.make("procedure-reduce-keyword-arity"),proc1887,arity1888,false,name1891,realm1892,req_kw1889,allowed_kw1890);};var cl2529 = function(proc1893, arity1894, req_kw1895, allowed_kw1896, name1897) {return do_procedure_reduce_keyword_arity($rjs_core.PrimitiveSymbol.make("procedure-reduce-keyword-arity"),proc1893,arity1894,false,name1897,$rjs_core.PrimitiveSymbol.make("racket"),req_kw1895,allowed_kw1896);};var cl2530 = function(proc1898, arity1899, req_kw1900, allowed_kw1901) {return do_procedure_reduce_keyword_arity($rjs_core.PrimitiveSymbol.make("procedure-reduce-keyword-arity"),proc1898,arity1899,false,false,$rjs_core.PrimitiveSymbol.make("racket"),req_kw1900,allowed_kw1901);};var procedure_reduce_keyword_arity = $rjs_core.attachProcedureArity(function() {var fixed_lam2531 = {'6':cl2528,'5':cl2529,'4':cl2530}[arguments.length];if (fixed_lam2531!==undefined) {return fixed_lam2531.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[4,5,6]);var cl2532 = function(proc1902, mask1903, req_kw1904, allowed_kw1905, name1906, realm1907) {return do_procedure_reduce_keyword_arity($rjs_core.PrimitiveSymbol.make("procedure-reduce-keyword-arity-mask"),proc1902,false,mask1903,name1906,realm1907,req_kw1904,allowed_kw1905);};var cl2533 = function(proc1908, mask1909, req_kw1910, allowed_kw1911, name1912) {return do_procedure_reduce_keyword_arity($rjs_core.PrimitiveSymbol.make("procedure-reduce-keyword-arity-mask"),proc1908,false,mask1909,name1912,$rjs_core.PrimitiveSymbol.make("racket"),req_kw1910,allowed_kw1911);};var cl2534 = function(proc1913, mask1914, req_kw1915, allowed_kw1916) {return do_procedure_reduce_keyword_arity($rjs_core.PrimitiveSymbol.make("procedure-reduce-keyword-arity-mask"),proc1913,false,mask1914,false,$rjs_core.PrimitiveSymbol.make("racket"),req_kw1915,allowed_kw1916);};var procedure_reduce_keyword_arity_mask = $rjs_core.attachProcedureArity(function() {var fixed_lam2535 = {'6':cl2532,'5':cl2533,'4':cl2534}[arguments.length];if (fixed_lam2535!==undefined) {return fixed_lam2535.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[4,5,6]);var do_procedure_reduce_keyword_arity = function(who1917, proc1918, arity1919, mask1920, name1921, realm1922, req_kw1923, allowed_kw1924) {if (okp_p(proc1918)!==false) {var if_res2536 = okp_ref(proc1918,0);} else {var if_res2536 = proc1918;}var p1926 = if_res2536;if (arity1919!==false) {var if_res2537 = M0.__rjs_quoted__.procedure_reduce_arity(p1926,arity1919,name1921,realm1922);} else {var if_res2537 = M0.__rjs_quoted__.procedure_reduce_arity_mask(p1926,mask1920,name1921,realm1922);}var plain_proc1925 = if_res2537;var sorted_p1927 = function(kws1928) {var loop1929 = function(_kws19302803) {lambda_start2802:while (true){let kws1930 = _kws19302803;if (M0.null_p(kws1930)!==false) {return true;} else if (M0.null_p(M0.cdr(kws1930))!==false) {return true;} else if (M0.keyword_lt__p(M0.car(kws1930),M0.cadr(kws1930))!==false) {_kws19302803 = M0.cdr(kws1930);continue lambda_start2802;} else {return false;}}};return loop1929(kws1928);};if (M0.list_p(req_kw1923)!==false) {if (M0.andmap(M0.keyword_p,req_kw1923)!==false) {var if_res2541 = sorted_p1927(req_kw1923);} else {var if_res2541 = false;}var if_res2542 = if_res2541;} else {var if_res2542 = false;}if (if_res2542!==false) {var if_res2546 = M0.rvoid();} else {var temp2545 = $rjs_core.PrimitiveSymbol.make("racket/primitive");var temp2544 = $rjs_core.UString.make("(and/c (listof? keyword?) sorted? distinct?)");var or_part1931 = arity1919;if (or_part1931!==false) {var if_res2543 = or_part1931;} else {var if_res2543 = mask1920;}var if_res2546 = M0.__rjs_quoted__.raise_argument_error_times_(who1917,temp2545,temp2544,2,proc1918,if_res2543,req_kw1923,allowed_kw1924);}if_res2546;if (allowed_kw1924!==false) {if (M0.list_p(allowed_kw1924)!==false) {if (M0.andmap(M0.keyword_p,allowed_kw1924)!==false) {var if_res2547 = sorted_p1927(allowed_kw1924);} else {var if_res2547 = false;}var if_res2548 = if_res2547;} else {var if_res2548 = false;}if (if_res2548!==false) {var if_res2552 = M0.rvoid();} else {var temp2551 = $rjs_core.PrimitiveSymbol.make("racket/primitive");var temp2550 = $rjs_core.UString.make("(or/c (and/c (listof? keyword?) sorted? distinct?) #f)");var or_part1932 = arity1919;if (or_part1932!==false) {var if_res2549 = or_part1932;} else {var if_res2549 = mask1920;}var if_res2552 = M0.__rjs_quoted__.raise_argument_error_times_(who1917,temp2551,temp2550,3,proc1918,if_res2549,req_kw1923,allowed_kw1924);}if_res2552;if (subset_p(req_kw1923,allowed_kw1924)!==false) {var if_res2553 = M0.rvoid();} else {var if_res2553 = M0.__rjs_quoted__.raise_arguments_error_times_(who1917,$rjs_core.PrimitiveSymbol.make("racket/primitive"),$rjs_core.UString.make("allowed-keyword list does not include all required keywords"),$rjs_core.UString.make("allowed-keyword list"),allowed_kw1924,$rjs_core.UString.make("required keywords"),req_kw1923);}var if_res2554 = if_res2553;} else {var if_res2554 = M0.rvoid();}if_res2554;var let_result2555 = procedure_keywords(proc1918);var old_req1933 = let_result2555.getAt(0);var old_allowed1934 = let_result2555.getAt(1);if (subset_p(old_req1933,req_kw1923)!==false) {var if_res2556 = M0.rvoid();} else {var if_res2556 = M0.__rjs_quoted__.raise_arguments_error_times_(who1917,$rjs_core.PrimitiveSymbol.make("racket/primitive"),$rjs_core.UString.make("cannot reduce required keyword set"),$rjs_core.UString.make("required keywords"),old_req1933,$rjs_core.UString.make("requested required keywords"),req_kw1923);}if_res2556;if (old_allowed1934!==false) {if (subset_p(req_kw1923,old_allowed1934)!==false) {var if_res2557 = M0.rvoid();} else {var if_res2557 = M0.__rjs_quoted__.raise_arguments_error_times_(who1917,$rjs_core.PrimitiveSymbol.make("racket/primitive"),$rjs_core.UString.make("cannot require keywords not in original allowed set"),$rjs_core.UString.make("original allowed keywords"),old_allowed1934,$rjs_core.UString.make("requested required keywords"),req_kw1923);}if_res2557;var or_part1935 = M0.not(allowed_kw1924);if (or_part1935!==false) {var if_res2558 = or_part1935;} else {var if_res2558 = subset_p(allowed_kw1924,old_allowed1934);}if (if_res2558!==false) {var if_res2559 = M0.rvoid();} else {var if_res2559 = M0.__rjs_quoted__.raise_arguments_error_times_(who1917,$rjs_core.PrimitiveSymbol.make("racket/primitive"),$rjs_core.UString.make("cannot allow keywords not in original allowed set"),$rjs_core.UString.make("original allowed keywords"),old_allowed1934,$rjs_core.UString.make("requested allowed keywords"),allowed_kw1924);}var if_res2560 = if_res2559;} else {var if_res2560 = M0.rvoid();}if_res2560;if (M0.null_p(allowed_kw1924)!==false) {return plain_proc1925;} else {var or_part1937 = mask1920;if (or_part1937!==false) {var if_res2561 = or_part1937;} else {var if_res2561 = arity__gt_mask(arity1919);}var mask1936 = if_res2561;var new_mask1938 = M0.arithmetic_shift(mask1936,2);var kw_checker1939 = make_keyword_checker(req_kw1923,allowed_kw1924,new_mask1938);var proc1940 = normalize_proc(proc1918);var new_kw_proc1941 = M0.__rjs_quoted__.procedure_reduce_arity_mask(keyword_procedure_proc(proc1940),new_mask1938);if (M0.null_p(req_kw1923)!==false) {if (okm_p(proc1940)!==false) {var if_res2562 = make_optional_keyword_method;} else {var if_res2562 = make_optional_keyword_procedure;}return if_res2562(kw_checker1939,new_kw_proc1941,req_kw1923,allowed_kw1924,plain_proc1925);} else {var or_part1942 = name1921;if (or_part1942!==false) {var if_res2572 = or_part1942;} else {if (named_keyword_procedure_p(proc1940)!==false) {var if_res2570 = M0.vector_ref(keyword_procedure_name_plus_fail(proc1940),0);} else {var if_res2570 = false;}var or_part1943 = if_res2570;if (or_part1943!==false) {var if_res2571 = or_part1943;} else {var if_res2571 = M0.object_name(proc1940);}var if_res2572 = if_res2571;}if (name1921!==false) {var if_res2565 = realm1922;} else {var if_res2565 = false;}var or_part1944 = if_res2565;if (or_part1944!==false) {var if_res2569 = or_part1944;} else {if (named_keyword_procedure_p(proc1940)!==false) {var or_part1946 = M0.vector_ref(keyword_procedure_name_plus_fail(proc1940),1);if (or_part1946!==false) {var if_res2566 = or_part1946;} else {var if_res2566 = M0.__rjs_quoted__.procedure_realm(M0.vector_ref(keyword_procedure_name_plus_fail(proc1940),2));}var if_res2567 = if_res2566;} else {var if_res2567 = false;}var or_part1945 = if_res2567;if (or_part1945!==false) {var if_res2568 = or_part1945;} else {var if_res2568 = M0.__rjs_quoted__.procedure_realm(proc1940);}var if_res2569 = if_res2568;}var temp2564 = M0.__rjs_quoted__.procedure_reduce_arity_mask(missing_kw,M0.arithmetic_shift(mask1936,1));var or_part1947 = okm_p(proc1940);if (or_part1947!==false) {var if_res2563 = or_part1947;} else {var if_res2563 = keyword_method_p(proc1940);}return make_required(if_res2572,if_res2569,temp2564,if_res2563,false)(kw_checker1939,new_kw_proc1941,req_kw1923,allowed_kw1924);}}};var arity__gt_mask = function(a1948) {if (M0.exact_nonnegative_integer_p(a1948)!==false) {return M0.arithmetic_shift(1,a1948);} else if (M0.arity_at_least_p(a1948)!==false) {return M0.bitwise_xor(-1,M0.sub1(M0.arithmetic_shift(1,M0.arity_at_least_value(a1948))));} else if (M0.list_p(a1948)!==false) {var loop1949 = function(_mask19502806, _l19512807) {lambda_start2805:while (true){let mask1950 = _mask19502806;let l1951 = _l19512807;if (M0.null_p(l1951)!==false) {return mask1950;} else {var a1952 = M0.car(l1951);var or_part1953 = M0.exact_nonnegative_integer_p(a1952);if (or_part1953!==false) {var if_res2575 = or_part1953;} else {var if_res2575 = M0.arity_at_least_p(a1952);}if (if_res2575!==false) {_mask19502806 = M0.bitwise_ior(mask1950,arity__gt_mask(a1952));_l19512807 = M0.cdr(l1951);continue lambda_start2805;} else {return false;}}}};return loop1949(0,a1948);} else {return false;}};var cl2581 = function(proc1955, arity1956, name1957, realm1958) {if (M0.procedure_p(proc1955)!==false) {var let_result2585 = procedure_keywords(proc1955);var req1959 = let_result2585.getAt(0);var allows1960 = let_result2585.getAt(1);if (M0.pair_p(req1959)!==false) {var if_res2586 = M0.not(M0.null_p(arity1956));} else {var if_res2586 = false;}var if_res2587 = if_res2586;} else {var if_res2587 = false;}if (if_res2587!==false) {return M0.__rjs_quoted__.raise_arguments_error_times_($rjs_core.PrimitiveSymbol.make("procedure-reduce-arity"),$rjs_core.PrimitiveSymbol.make("racket/primitive"),$rjs_core.UString.make("procedure has required keyword arguments"),$rjs_core.UString.make("procedure"),proc1955);} else {if (okm_p(proc1955)!==false) {var if_res2588 = M0.__rjs_quoted__.procedure__gt_method(proc1955);} else {var if_res2588 = proc1955;}return M0.__rjs_quoted__.procedure_reduce_arity(if_res2588,arity1956,name1957,realm1958);}};var cl2582 = function(proc1961, arity1962, name1963) {return new_procedure_reduce_arity(proc1961,arity1962,name1963,$rjs_core.PrimitiveSymbol.make("racket"));};var cl2583 = function(proc1964, arity1965) {return new_procedure_reduce_arity(proc1964,arity1965,false,$rjs_core.PrimitiveSymbol.make("racket"));};var procedure_reduce_arity1954 = $rjs_core.attachProcedureArity(function() {var fixed_lam2584 = {'4':cl2581,'3':cl2582,'2':cl2583}[arguments.length];if (fixed_lam2584!==undefined) {return fixed_lam2584.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[2,3,4]);var new_procedure_reduce_arity = procedure_reduce_arity1954;var cl2590 = function(proc1967, mask1968, name1969, realm1970) {if (M0.procedure_p(proc1967)!==false) {var let_result2594 = procedure_keywords(proc1967);var req1971 = let_result2594.getAt(0);var allows1972 = let_result2594.getAt(1);if (M0.pair_p(req1971)!==false) {var if_res2595 = M0.not(M0.eqv_p(mask1968,0));} else {var if_res2595 = false;}var if_res2596 = if_res2595;} else {var if_res2596 = false;}if (if_res2596!==false) {return M0.__rjs_quoted__.raise_arguments_error_times_($rjs_core.PrimitiveSymbol.make("procedure-reduce-arity"),$rjs_core.PrimitiveSymbol.make("racket/primitive"),$rjs_core.UString.make("procedure has required keyword arguments"),$rjs_core.UString.make("procedure"),proc1967);} else {if (okm_p(proc1967)!==false) {var if_res2597 = M0.__rjs_quoted__.procedure__gt_method(proc1967);} else {var if_res2597 = proc1967;}return M0.__rjs_quoted__.procedure_reduce_arity_mask(if_res2597,mask1968,name1969,realm1970);}};var cl2591 = function(proc1973, mask1974, name1975) {return new_procedure_reduce_arity_mask(proc1973,mask1974,name1975,$rjs_core.PrimitiveSymbol.make("racket"));};var cl2592 = function(proc1976, mask1977) {return new_procedure_reduce_arity_mask(proc1976,mask1977,false,$rjs_core.PrimitiveSymbol.make("racket"));};var procedure_reduce_arity1966 = $rjs_core.attachProcedureArity(function() {var fixed_lam2593 = {'4':cl2590,'3':cl2591,'2':cl2592}[arguments.length];if (fixed_lam2593!==undefined) {return fixed_lam2593.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[2,3,4]);var new_procedure_reduce_arity_mask = procedure_reduce_arity1966;var procedure__gt_method1978 = function(proc1979) {var proc1980 = normalize_proc(proc1979);if (keyword_procedure_p(proc1980)!==false) {if (okm_p(proc1980)!==false) {return proc1980;} else if (keyword_method_p(proc1980)!==false) {return proc1980;} else if (okp_p(proc1980)!==false) {return make_optional_keyword_method(keyword_procedure_checker(proc1980),keyword_procedure_proc(proc1980),keyword_procedure_required(proc1980),keyword_procedure_allowed(proc1980),okp_ref(proc1980,0));} else {var name_plus_fail1981 = keyword_procedure_name_plus_fail(proc1980);var mk1982 = make_required(M0.vector_ref(name_plus_fail1981,0),M0.vector_ref(name_plus_fail1981,1),M0.vector_ref(name_plus_fail1981,2),true,false);return mk1982(keyword_procedure_checker(proc1980),keyword_procedure_proc(proc1980),keyword_procedure_required(proc1980),keyword_procedure_allowed(proc1980));}} else {return M0.__rjs_quoted__.procedure__gt_method(proc1980);}};var new_procedure__gt_method = procedure__gt_method1978;var cl2603 = function(proc1984, name1985, realm1986) {if (M0.symbol_p(name1985)!==false) {var if_res2606 = M0.symbol_p(realm1986);} else {var if_res2606 = false;}if (M0.not(if_res2606)!==false) {return M0.__rjs_quoted__.procedure_rename(proc1984,name1985,realm1986);} else {var c11987 = extract_keyword_root(proc1984);if (c11987!==false) {return (function(kw_p1988) {return do_procedure_reduce_keyword_arity($rjs_core.PrimitiveSymbol.make("procedure-rename"),proc1984,false,M0.procedure_arity_mask(proc1984),name1985,realm1986,keyword_procedure_required(kw_p1988),keyword_procedure_allowed(kw_p1988));})(c11987);} else {return M0.__rjs_quoted__.procedure_rename(proc1984,name1985,realm1986);}}};var cl2604 = function(proc1989, name1990) {return new_procedure_rename(proc1989,name1990,$rjs_core.PrimitiveSymbol.make("racket"));};var procedure_rename1983 = $rjs_core.attachProcedureArity(function() {var fixed_lam2605 = {'3':cl2603,'2':cl2604}[arguments.length];if (fixed_lam2605!==undefined) {return fixed_lam2605.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[2,3]);var new_procedure_rename = procedure_rename1983;var procedure_realm1991 = function(proc1992) {if (keyword_procedure_p(proc1992)!==false) {if (named_keyword_procedure_p(proc1992)!==false) {var name_plus_fail1993 = keyword_procedure_name_plus_fail(proc1992);var or_part1994 = M0.vector_ref(name_plus_fail1993,1);if (or_part1994!==false) {return or_part1994;} else {return M0.__rjs_quoted__.procedure_realm(M0.vector_ref(name_plus_fail1993,2));}} else if (okp_p(proc1992)!==false) {return M0.__rjs_quoted__.procedure_realm(okp_ref(proc1992,0));} else {return M0.__rjs_quoted__.procedure_realm(keyword_procedure_proc(proc1992));}} else {return M0.__rjs_quoted__.procedure_realm(proc1992);}};var new_procedure_realm = procedure_realm1991;var chaperone_procedure1995 = $rjs_core.attachProcedureArity(function(proc1996, wrap_proc1997, ...props19982613) {var props1998 = $rjs_core.Pair.listFromArray(props19982613);return do_chaperone_procedure(false,false,M0.__rjs_quoted__.chaperone_procedure,$rjs_core.PrimitiveSymbol.make("chaperone-procedure"),proc1996,wrap_proc1997,props1998);});var new_chaperone_procedure = chaperone_procedure1995;var unsafe_chaperone_procedure1999 = $rjs_core.attachProcedureArity(function(proc2000, wrap_proc2001, ...props20022614) {var props2002 = $rjs_core.Pair.listFromArray(props20022614);return do_unsafe_chaperone_procedure(M1.__rjs_quoted__.unsafe_chaperone_procedure,$rjs_core.PrimitiveSymbol.make("unsafe-chaperone-procedure"),proc2000,wrap_proc2001,props2002);});var new_unsafe_chaperone_procedure = unsafe_chaperone_procedure1999;var impersonate_procedure2003 = $rjs_core.attachProcedureArity(function(proc2004, wrap_proc2005, ...props20062615) {var props2006 = $rjs_core.Pair.listFromArray(props20062615);return do_chaperone_procedure(true,false,M0.__rjs_quoted__.impersonate_procedure,$rjs_core.PrimitiveSymbol.make("impersonate-procedure"),proc2004,wrap_proc2005,props2006);});var new_impersonate_procedure = impersonate_procedure2003;var unsafe_impersonate_procedure2007 = $rjs_core.attachProcedureArity(function(proc2008, wrap_proc2009, ...props20102616) {var props2010 = $rjs_core.Pair.listFromArray(props20102616);return do_unsafe_chaperone_procedure(M1.__rjs_quoted__.unsafe_impersonate_procedure,$rjs_core.PrimitiveSymbol.make("unsafe-impersonate-procedure"),proc2008,wrap_proc2009,props2010);});var new_unsafe_impersonate_procedure = unsafe_impersonate_procedure2007;var chaperone_procedure_times_2011 = $rjs_core.attachProcedureArity(function(proc2012, wrap_proc2013, ...props20142617) {var props2014 = $rjs_core.Pair.listFromArray(props20142617);return do_chaperone_procedure(false,true,M0.__rjs_quoted__.chaperone_procedure_times_,$rjs_core.PrimitiveSymbol.make("chaperone-procedure"),proc2012,wrap_proc2013,props2014);});var new_chaperone_procedure_times_ = chaperone_procedure_times_2011;var impersonate_procedure_times_2015 = $rjs_core.attachProcedureArity(function(proc2016, wrap_proc2017, ...props20182618) {var props2018 = $rjs_core.Pair.listFromArray(props20182618);return do_chaperone_procedure(true,true,M0.__rjs_quoted__.impersonate_procedure_times_,$rjs_core.PrimitiveSymbol.make("impersonate-procedure"),proc2016,wrap_proc2017,props2018);});var new_impersonate_procedure_times_ = impersonate_procedure_times_2015;var do_chaperone_procedure = function(is_impersonator_p2019, self_arg_p2020, chaperone_procedure2021, name2022, proc2023, wrap_proc2024, props2025) {var n_proc2026 = normalize_proc(proc2023);var n_wrap_proc2027 = normalize_proc(wrap_proc2024);var or_part2028 = M0.not(keyword_procedure_p(n_proc2026));if (or_part2028!==false) {var if_res2620 = or_part2028;} else {var or_part2029 = M0.not(M0.procedure_p(wrap_proc2024));if (or_part2029!==false) {var if_res2619 = or_part2029;} else {var if_res2619 = bad_props_p(props2025);}var if_res2620 = if_res2619;}if (if_res2620!==false) {return M0.apply(chaperone_procedure2021,proc2023,wrap_proc2024,props2025);} else {chaperone_arity_match_checking(self_arg_p2020,name2022,proc2023,wrap_proc2024,props2025);var loop2031 = function(_props20322829) {lambda_start2828:while (true){let props2032 = _props20322829;if (M0.null_p(props2032)!==false) {return false;} else if (M0.eq_p(M0.car(props2032),M0.__rjs_quoted__.impersonator_prop_application_mark)!==false) {return M0.cadr(props2032);} else {_props20322829 = M0.cddr(props2032);continue lambda_start2828;}}};var mark_prop2030 = loop2031(props2025);var chaperone_procedure_by_add_mark2033 = function(proc2034, wrap_proc2035) {if (mark_prop2030!==false) {return chaperone_procedure2021(proc2034,wrap_proc2035,M0.__rjs_quoted__.impersonator_prop_application_mark,mark_prop2030);} else {return chaperone_procedure2021(proc2034,wrap_proc2035);}};var p2037 = keyword_procedure_proc(n_wrap_proc2027);if (self_arg_p2020!==false) {var cl2624 = $rjs_core.attachProcedureArity(function(self_proc2038, kws2039, args2040, ...rest20412629) {var rest2041 = $rjs_core.Pair.listFromArray(rest20412629);return M0.call_with_values(function() {return M0.apply(p2037,kws2039,args2040,self_proc2038,rest2041);},$rjs_core.attachProcedureArity(function(...results20422630) {var results2042 = $rjs_core.Pair.listFromArray(results20422630);var len2043 = M0.length(results2042);var alen2044 = M0.length(rest2041);if (M0.__lt_(len2043,alen2044+1)!==false) {var if_res2631 = M0.__rjs_quoted__.raise_arguments_error_times_($rjs_core.PrimitiveSymbol.make("keyword procedure chaperone"),$rjs_core.PrimitiveSymbol.make("racket/primitive"),$rjs_core.UString.make("wrong number of results from wrapper procedure"),$rjs_core.UString.make("expected minimum number of results"),alen2044+1,$rjs_core.UString.make("received number of results"),len2043,$rjs_core.UString.make("wrapper procedure"),wrap_proc2024);} else {var if_res2631 = M0.rvoid();}if_res2631;var num_extra2045 = len2043-(alen2044+1);var new_args2046 = M0.list_ref(results2042,num_extra2045);if (M0.list_p(new_args2046)!==false) {var if_res2632 = M0.__eq_(M0.length(new_args2046),M0.length(args2040));} else {var if_res2632 = false;}if (if_res2632!==false) {var if_res2637 = M0.rvoid();} else {var temp2636 = $rjs_core.PrimitiveSymbol.make("keyword procedure chaperone");var temp2635 = $rjs_core.PrimitiveSymbol.make("racket/primitive");var temp2634 = $rjs_core.UString.make("expected a list of keyword-argument values as first result~a from wrapper procedure");if (M0.__eq_(len2043,alen2044)!==false) {var if_res2633 = $rjs_core.UString.make("");} else {var if_res2633 = $rjs_core.UString.make(" (after the result-wrapper procedure or mark specifications)");}var if_res2637 = M0.__rjs_quoted__.raise_arguments_error_times_(temp2636,temp2635,M0.format(temp2634,if_res2633),$rjs_core.UString.make("first result"),new_args2046,$rjs_core.UString.make("wrapper procedure"),wrap_proc2024);}if_res2637;M0.for_each(function(kw2047, new_arg2048, arg2049) {if (is_impersonator_p2019!==false) {return M0.rvoid();} else if (M0.__rjs_quoted__.chaperone_of_p(new_arg2048,arg2049)!==false) {return M0.rvoid();} else {return M0.__rjs_quoted__.raise_arguments_error_times_($rjs_core.PrimitiveSymbol.make("keyword procedure chaperone"),$rjs_core.PrimitiveSymbol.make("racket/primitive"),M0.format($rjs_core.UString.make("~a keyword result is not a chaperone of original argument from chaperoning procedure"),kw2047),$rjs_core.UString.make("result"),new_arg2048,$rjs_core.UString.make("wrapper procedure"),wrap_proc2024);}},kws2039,new_args2046,args2040);var tmp2050 = num_extra2045;if (M0.equal_p(tmp2050,0)!==false) {return M0.apply(M0.values,kws2039,results2042);} else if (M0.equal_p(tmp2050,1)!==false) {return M0.apply(M0.values,M0.car(results2042),kws2039,M0.cdr(results2042));} else {var loop2051 = function(results2052, c2053) {if (M0.zero_p(c2053)!==false) {return M0.cons(kws2039,results2052);} else {return M0.cons(M0.car(results2052),loop2051(M0.cdr(results2052),M0.sub1(c2053)));}};return M0.apply(M0.values,loop2051(results2042,num_extra2045));}}));});var cl2625 = $rjs_core.attachProcedureArity(function(...other20542643) {var other2054 = $rjs_core.Pair.listFromArray(other20542643);return M0.error($rjs_core.UString.make("shouldn't get here"));});var if_res2664 = $rjs_core.attachProcedureArity(function() {var fixed_lam2626 = {}[arguments.length];if (fixed_lam2626!==undefined) {return fixed_lam2626.apply(null,arguments);} else if (M0.__gt__eq_(cl2624.length,1)!==false) {return cl2624.apply(null,arguments);} else if (true!==false) {return cl2625.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[M0.make_arity_at_least(0)]);} else {var cl2644 = $rjs_core.attachProcedureArity(function(kws2055, args2056, ...rest20572649) {var rest2057 = $rjs_core.Pair.listFromArray(rest20572649);return M0.call_with_values(function() {return M0.apply(p2037,kws2055,args2056,rest2057);},$rjs_core.attachProcedureArity(function(...results20582650) {var results2058 = $rjs_core.Pair.listFromArray(results20582650);var len2059 = M0.length(results2058);var alen2060 = M0.length(rest2057);if (M0.__lt_(len2059,alen2060+1)!==false) {var if_res2651 = M0.__rjs_quoted__.raise_arguments_error_times_($rjs_core.PrimitiveSymbol.make("keyword procedure chaperone"),$rjs_core.PrimitiveSymbol.make("racket/primitive"),$rjs_core.UString.make("wrong number of results from wrapper procedure"),$rjs_core.UString.make("expected minimum number of results"),alen2060+1,$rjs_core.UString.make("received number of results"),len2059,$rjs_core.UString.make("wrapper procedure"),wrap_proc2024);} else {var if_res2651 = M0.rvoid();}if_res2651;var num_extra2061 = len2059-(alen2060+1);var new_args2062 = M0.list_ref(results2058,num_extra2061);if (M0.list_p(new_args2062)!==false) {var if_res2652 = M0.__eq_(M0.length(new_args2062),M0.length(args2056));} else {var if_res2652 = false;}if (if_res2652!==false) {var if_res2657 = M0.rvoid();} else {var temp2656 = $rjs_core.PrimitiveSymbol.make("keyword procedure chaperone");var temp2655 = $rjs_core.PrimitiveSymbol.make("racket/primitive");var temp2654 = $rjs_core.UString.make("expected a list of keyword-argument values as first result~a from wrapper procedure");if (M0.__eq_(len2059,alen2060)!==false) {var if_res2653 = $rjs_core.UString.make("");} else {var if_res2653 = $rjs_core.UString.make(" (after the result-wrapper procedure or mark specifications)");}var if_res2657 = M0.__rjs_quoted__.raise_arguments_error_times_(temp2656,temp2655,M0.format(temp2654,if_res2653),$rjs_core.UString.make("first result"),new_args2062,$rjs_core.UString.make("wrapper procedure"),wrap_proc2024);}if_res2657;M0.for_each(function(kw2063, new_arg2064, arg2065) {if (is_impersonator_p2019!==false) {return M0.rvoid();} else if (M0.__rjs_quoted__.chaperone_of_p(new_arg2064,arg2065)!==false) {return M0.rvoid();} else {return M0.__rjs_quoted__.raise_arguments_error_times_($rjs_core.PrimitiveSymbol.make("keyword procedure chaperone"),$rjs_core.PrimitiveSymbol.make("racket/primitive"),M0.format($rjs_core.UString.make("~a keyword result is not a chaperone of original argument from chaperoning procedure"),kw2063),$rjs_core.UString.make("result"),new_arg2064,$rjs_core.UString.make("wrapper procedure"),wrap_proc2024);}},kws2055,new_args2062,args2056);var tmp2066 = num_extra2061;if (M0.equal_p(tmp2066,0)!==false) {return M0.apply(M0.values,kws2055,results2058);} else if (M0.equal_p(tmp2066,1)!==false) {return M0.apply(M0.values,M0.car(results2058),kws2055,M0.cdr(results2058));} else {var loop2067 = function(results2068, c2069) {if (M0.zero_p(c2069)!==false) {return M0.cons(kws2055,results2068);} else {return M0.cons(M0.car(results2068),loop2067(M0.cdr(results2068),M0.sub1(c2069)));}};return M0.apply(M0.values,loop2067(results2058,num_extra2061));}}));});var cl2645 = $rjs_core.attachProcedureArity(function(...other20702663) {var other2070 = $rjs_core.Pair.listFromArray(other20702663);return M0.error($rjs_core.UString.make("shouldn't get here"));});var if_res2664 = $rjs_core.attachProcedureArity(function() {var fixed_lam2646 = {}[arguments.length];if (fixed_lam2646!==undefined) {return fixed_lam2646.apply(null,arguments);} else if (M0.__gt__eq_(cl2644.length,1)!==false) {return cl2644.apply(null,arguments);} else if (true!==false) {return cl2645.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[M0.make_arity_at_least(0)]);}var kw_chaperone2036 = if_res2664;var wrap2073 = function(proc2074, n_proc2075) {if (M0.not(M0.eq_p(n_proc2075,proc2074))!==false) {var if_res2665 = new_procedure_p(proc2074);} else {var if_res2665 = false;}if (if_res2665!==false) {var v2076 = new_procedure_ref(proc2074);if (M0.exact_integer_p(v2076)!==false) {var acc2077 = procedure_accessor_ref(proc2074);return M0.values(M0.__rjs_quoted__.chaperone_struct(proc2074,acc2077,function(self2078, sub_proc2079) {var let_result2666 = wrap2073(sub_proc2079,normalize_proc(sub_proc2079));var f2080 = let_result2666.getAt(0);var acc2081 = let_result2666.getAt(1);return f2080;}),acc2077);} else {if (is_impersonator_p2019!==false) {var if_res2692 = M0.__rjs_quoted__.impersonate_struct;} else {var if_res2692 = M0.__rjs_quoted__.chaperone_struct;}if (okp_p(n_proc2075)!==false) {var if_res2691 = chaperone_procedure_by_add_mark2033(proc2074,wrap_proc2024);} else {var if_res2691 = proc2074;}var new_kw_proc2082 = if_res2692(if_res2691,new_procedure_ref,function(self2083, proc2084) {if (is_impersonator_p2019!==false) {var if_res2690 = new_impersonate_procedure;} else {var if_res2690 = new_chaperone_procedure;}if (self_arg_p2020!==false) {var cl2667 = $rjs_core.attachProcedureArity(function(proc_self2085, kws2086, kw_args2087, self2088, ...args20892672) {var args2089 = $rjs_core.Pair.listFromArray(args20892672);var len2090 = M0.length(args2089);return M0.call_with_values(function() {return M0.apply(kw_chaperone2036,proc_self2085,kws2086,kw_args2087,args2089);},$rjs_core.attachProcedureArity(function(...results20912673) {var results2091 = $rjs_core.Pair.listFromArray(results20912673);var r_len2092 = M0.length(results2091);var list_take2093 = function(l2094, n2095) {if (M0.zero_p(n2095)!==false) {return M0.rnull;} else {return M0.cons(M0.car(l2094),list_take2093(M0.cdr(l2094),M0.sub1(n2095)));}};if (M0.null_p($rjs_core.Pair.makeList($rjs_core.PrimitiveSymbol.make("proc-self")))!==false) {var if_res2675 = M0.__eq_(r_len2092,2+len2090);} else {var if_res2675 = false;}if (if_res2675!==false) {return M0.apply(M0.values,M0.cadr(results2091),self2088,M0.cddr(results2091));} else {var skip2096 = r_len2092-len2090;return M0.apply(M0.values,M0.append(list_take2093(results2091,skip2096-2),M0.list(M0.list_ref(results2091,M0.sub1(skip2096)),self2088),M0.__rjs_quoted__.list_tail(results2091,skip2096)));}}));});var cl2668 = $rjs_core.attachProcedureArity(function(...args20972677) {var args2097 = $rjs_core.Pair.listFromArray(args20972677);return M0.rvoid();});var if_res2689 = $rjs_core.attachProcedureArity(function() {var fixed_lam2669 = {}[arguments.length];if (fixed_lam2669!==undefined) {return fixed_lam2669.apply(null,arguments);} else if (M0.__gt__eq_(cl2667.length,1)!==false) {return cl2667.apply(null,arguments);} else if (true!==false) {return cl2668.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[M0.make_arity_at_least(0)]);} else {var cl2678 = $rjs_core.attachProcedureArity(function(kws2098, kw_args2099, self2100, ...args21012683) {var args2101 = $rjs_core.Pair.listFromArray(args21012683);var len2102 = M0.length(args2101);return M0.call_with_values(function() {return M0.apply(kw_chaperone2036,kws2098,kw_args2099,args2101);},$rjs_core.attachProcedureArity(function(...results21032684) {var results2103 = $rjs_core.Pair.listFromArray(results21032684);var r_len2104 = M0.length(results2103);var list_take2105 = function(l2106, n2107) {if (M0.zero_p(n2107)!==false) {return M0.rnull;} else {return M0.cons(M0.car(l2106),list_take2105(M0.cdr(l2106),M0.sub1(n2107)));}};if (M0.null_p($rjs_core.Pair.EMPTY)!==false) {var if_res2686 = M0.__eq_(r_len2104,2+len2102);} else {var if_res2686 = false;}if (if_res2686!==false) {return M0.apply(M0.values,M0.cadr(results2103),self2100,M0.cddr(results2103));} else {var skip2108 = r_len2104-len2102;return M0.apply(M0.values,M0.append(list_take2105(results2103,skip2108-2),M0.list(M0.list_ref(results2103,M0.sub1(skip2108)),self2100),M0.__rjs_quoted__.list_tail(results2103,skip2108)));}}));});var cl2679 = $rjs_core.attachProcedureArity(function(...args21092688) {var args2109 = $rjs_core.Pair.listFromArray(args21092688);return M0.rvoid();});var if_res2689 = $rjs_core.attachProcedureArity(function() {var fixed_lam2680 = {}[arguments.length];if (fixed_lam2680!==undefined) {return fixed_lam2680.apply(null,arguments);} else if (M0.__gt__eq_(cl2678.length,1)!==false) {return cl2678.apply(null,arguments);} else if (true!==false) {return cl2679.apply(null,arguments);} else {return M0.error($rjs_core.UString.make("case-lambda: invalid case"));}},[M0.make_arity_at_least(0)]);}return if_res2690(proc2084,make_keyword_procedure(if_res2689));});return M0.values(new_kw_proc2082,new_procedure_ref);}} else if (okp_p(n_proc2075)!==false) {if (is_impersonator_p2019!==false) {if (okm_p(n_proc2075)!==false) {var if_res2694 = make_optional_keyword_method_impersonator;} else {var if_res2694 = make_optional_keyword_procedure_impersonator;}var if_res2695 = if_res2694(keyword_procedure_checker(n_proc2075),chaperone_procedure_by_add_mark2033(keyword_procedure_proc(n_proc2075),kw_chaperone2036),keyword_procedure_required(n_proc2075),keyword_procedure_allowed(n_proc2075),chaperone_procedure_by_add_mark2033(okp_ref(n_proc2075,0),okp_ref(n_wrap_proc2027,0)),n_proc2075);} else {var if_res2695 = M0.__rjs_quoted__.chaperone_struct(proc2074,keyword_procedure_proc,function(self2110, proc2111) {return chaperone_procedure_by_add_mark2033(proc2111,kw_chaperone2036);},M0.make_struct_field_accessor(okp_ref,0),function(self2112, proc2113) {return chaperone_procedure_by_add_mark2033(proc2113,okp_ref(n_wrap_proc2027,0));});}return M0.values(if_res2695,keyword_procedure_proc);} else {if (is_impersonator_p2019!==false) {var name_plus_fail2114 = keyword_procedure_name_plus_fail(n_proc2075);var mk2115 = make_required(M0.vector_ref(name_plus_fail2114,0),M0.vector_ref(name_plus_fail2114,1),M0.vector_ref(name_plus_fail2114,2),keyword_method_p(n_proc2075),true);var if_res2696 = mk2115(keyword_procedure_checker(n_proc2075),chaperone_procedure_by_add_mark2033(keyword_procedure_proc(n_proc2075),kw_chaperone2036),keyword_procedure_required(n_proc2075),keyword_procedure_allowed(n_proc2075),n_proc2075);} else {var if_res2696 = M0.__rjs_quoted__.chaperone_struct(n_proc2075,keyword_procedure_proc,function(self2116, proc2117) {return chaperone_procedure_by_add_mark2033(proc2117,kw_chaperone2036);});}return M0.values(if_res2696,keyword_procedure_proc);}};var let_result2699 = wrap2073(proc2023,n_proc2026);var new_proc2071 = let_result2699.getAt(0);var chap_accessor2072 = let_result2699.getAt(1);if (M0.null_p(props2025)!==false) {return new_proc2071;} else {return M0.apply(M0.__rjs_quoted__.chaperone_struct,new_proc2071,chap_accessor2072,false,props2025);}}};var do_unsafe_chaperone_procedure = function(unsafe_chaperone_procedure2118, name2119, proc2120, wrap_proc2121, props2122) {var n_proc2123 = normalize_proc(proc2120);var n_wrap_proc2124 = normalize_proc(wrap_proc2121);var or_part2125 = M0.not(keyword_procedure_p(n_proc2123));if (or_part2125!==false) {var if_res2703 = or_part2125;} else {var or_part2126 = M0.not(M0.procedure_p(wrap_proc2121));if (or_part2126!==false) {var if_res2702 = or_part2126;} else {var if_res2702 = bad_props_p(props2122);}var if_res2703 = if_res2702;}if (if_res2703!==false) {return M0.apply(unsafe_chaperone_procedure2118,proc2120,wrap_proc2121,props2122);} else {chaperone_arity_match_checking(false,name2119,proc2120,wrap_proc2121,props2122);return M0.apply(unsafe_chaperone_procedure2118,proc2120,wrap_proc2121,props2122);}};var bad_props_p = function(props2127) {var loop2128 = function(_props21292866) {lambda_start2865:while (true){let props2129 = _props21292866;if (M0.null_p(props2129)!==false) {return false;} else if (M0.__rjs_quoted__.impersonator_property_p(M0.car(props2129))!==false) {var props2130 = M0.cdr(props2129);var or_part2131 = M0.null_p(props2130);if (or_part2131!==false) {return or_part2131;} else {_props21292866 = M0.cdr(props2130);continue lambda_start2865;}} else {return true;}}};return loop2128(props2127);};var chaperone_arity_match_checking = function(self_arg_p2132, name2133, proc2134, wrap_proc2135, props2136) {var a2137 = M0.procedure_arity(proc2134);var b2138 = M0.procedure_arity(wrap_proc2135);if (self_arg_p2132!==false) {var if_res2708 = 1;} else {var if_res2708 = 0;}var d2139 = if_res2708;var let_result2709 = procedure_keywords(proc2134);var a_req2140 = let_result2709.getAt(0);var a_allow2141 = let_result2709.getAt(1);var let_result2710 = procedure_keywords(wrap_proc2135);var b_req2142 = let_result2710.getAt(0);var b_allow2143 = let_result2710.getAt(1);var includes_p2144 = function(a2145, b2146) {if (M0.number_p(b2146)!==false) {if (M0.number_p(a2145)!==false) {return M0.__eq_(b2146,a2145+d2139);} else if (M0.arity_at_least_p(a2145)!==false) {return M0.__gt__eq_(b2146,M0.arity_at_least_value(a2145)+d2139);} else {return M0.ormap(function(a2147) {return includes_p2144(a2147,b2146);},a2145);}} else if (M0.arity_at_least_p(b2146)!==false) {if (M0.number_p(a2145)!==false) {return false;} else if (M0.arity_at_least_p(a2145)!==false) {return M0.__gt__eq_(M0.arity_at_least_value(b2146),M0.arity_at_least_value(a2145)+d2139);} else {return M0.ormap(function(a2148) {return includes_p2144(b2146,a2148);},a2145);}} else {return M0.andmap(function(b2149) {return includes_p2144(a2145,b2149);},b2146);}};if (includes_p2144(b2138,a2137)!==false) {var if_res2717 = M0.rvoid();} else {var if_res2717 = M0.apply(M0.__rjs_quoted__.chaperone_procedure,proc2134,wrap_proc2135,props2136);}if_res2717;if (subset_p(b_req2142,a_req2140)!==false) {var if_res2718 = M0.rvoid();} else {var if_res2718 = M0.__rjs_quoted__.raise_arguments_error_times_(name2133,$rjs_core.PrimitiveSymbol.make("racket/primitive"),$rjs_core.UString.make("wrapper procedure requires more keywords than original procedure"),$rjs_core.UString.make("wrapper procedure"),wrap_proc2135,$rjs_core.UString.make("original procedure"),proc2134);}if_res2718;var or_part2150 = M0.not(b_allow2143);if (or_part2150!==false) {var if_res2720 = or_part2150;} else {if (a_allow2141!==false) {var if_res2719 = subset_p(a_allow2141,b_allow2143);} else {var if_res2719 = false;}var if_res2720 = if_res2719;}if (if_res2720!==false) {var if_res2721 = M0.rvoid();} else {var if_res2721 = M0.__rjs_quoted__.raise_arguments_error_times_(name2133,$rjs_core.PrimitiveSymbol.make("racket/primitive"),$rjs_core.UString.make("wrapper procedure does not accept all keywords of original procedure"),$rjs_core.UString.make("wrapper procedure"),wrap_proc2135,$rjs_core.UString.make("original procedure"),proc2134);}if_res2721;return M0.rvoid();};var normalize_proc = function(proc2151) {if (keyword_procedure_p(proc2151)!==false) {return proc2151;} else if (new_procedure_p(proc2151)!==false) {var let_result2722 = procedure_keywords(proc2151);var req_kws2152 = let_result2722.getAt(0);var allowed_kws2153 = let_result2722.getAt(1);if (M0.null_p(allowed_kws2153)!==false) {return proc2151;} else {return make_optional_keyword_procedure(function(given_kws2154, given_argc2155) {if (M0.procedure_arity_includes_p(proc2151,given_argc2155-2,true)!==false) {var or_part2156 = M0.not(allowed_kws2153);if (or_part2156!==false) {var if_res2724 = or_part2156;} else {var if_res2724 = subset_p(given_kws2154,allowed_kws2153);}if (if_res2724!==false) {return subset_p(req_kws2152,given_kws2154);} else {return false;}} else {return false;}},$rjs_core.attachProcedureArity(function(kws2157, kw_args2158, ...vals21592723) {var vals2159 = $rjs_core.Pair.listFromArray(vals21592723);return keyword_apply(proc2151,kws2157,kw_args2158,vals2159);}),req_kws2152,allowed_kws2153,proc2151);}} else {return proc2151;}};var __rjs_quoted__ = {};__rjs_quoted__.make_optional_keyword_method = make_optional_keyword_method;__rjs_quoted__.struct_keyword_procedure_by_arity_error = struct_keyword_procedure_by_arity_error;__rjs_quoted__.prop_named_keyword_procedure = prop_named_keyword_procedure;__rjs_quoted__.make_optional_keyword_procedure = make_optional_keyword_procedure;__rjs_quoted__.struct_keyword_procedure = struct_keyword_procedure;__rjs_quoted__.struct_keyword_method_by_arity_error = struct_keyword_method_by_arity_error;__rjs_quoted__.subset_p = subset_p;__rjs_quoted__.missing_kw = missing_kw;__rjs_quoted__.subsets_p = subsets_p;__rjs_quoted__.keyword_procedure_extract = keyword_procedure_extract;export { __rjs_quoted__,new_impersonate_procedure_times_,new_chaperone_procedure_times_,new_unsafe_impersonate_procedure,new_impersonate_procedure,new_unsafe_chaperone_procedure,new_chaperone_procedure,new_procedure_realm,new_procedure_rename,new_procedure__gt_method,new_prop_procedure,procedure_reduce_keyword_arity_mask,procedure_reduce_keyword_arity,new_procedure_reduce_arity_mask,new_procedure_reduce_arity,procedure_keywords,keyword_apply,make_keyword_procedure };