import * as $rjs_core from '../../runtime/core.js';import * as M0 from "./private/pre-base.rkt.js";import * as M1 from "./private/reverse.rkt.js";import * as M2 from "./private/map.rkt.js";import * as M3 from "./private/qq-and-or.rkt.js";import * as M4 from "../../runtime/kernel.rkt.js";import * as M5 from "./private/more-scheme.rkt.js";import * as M6 from "./private/member.rkt.js";import * as M7 from "./private/for.rkt.js";import * as M8 from "./private/list.rkt.js";import * as M9 from "./private/kw.rkt.js";import * as M10 from "../../runtime/unsafe.rkt.js";var first = function(x2213) {if (M4.pair_p(x2213)!==false) {var if_res3073 = M4.list_p(x2213);} else {var if_res3073 = false;}if (if_res3073!==false) {return M4.car(x2213);} else {return M4.raise_argument_error($rjs_core.PrimitiveSymbol.make("first"),$rjs_core.UString.make("(and/c list? (not/c empty?))"),x2213);}};var second = function(l02214) {if (M4.list_p(l02214)!==false) {var loop2215 = function(_l22163641, _pos22173642) {lambda_start3640:while (true){let l2216 = _l22163641;let pos2217 = _pos22173642;if (M4.pair_p(l2216)!==false) {if (M4.eq_p(pos2217,1)!==false) {return M4.car(l2216);} else {_l22163641 = M4.cdr(l2216);_pos22173642 = M4.sub1(pos2217);continue lambda_start3640;}} else {return M4.raise_arguments_error($rjs_core.PrimitiveSymbol.make("second"),$rjs_core.UString.make("list contains too few elements"),$rjs_core.UString.make("list"),l02214);}}};return loop2215(l02214,2);} else {return M4.raise_argument_error($rjs_core.PrimitiveSymbol.make("second"),$rjs_core.UString.make("list?"),l02214);}};var third = function(l02218) {if (M4.list_p(l02218)!==false) {var loop2219 = function(_l22203645, _pos22213646) {lambda_start3644:while (true){let l2220 = _l22203645;let pos2221 = _pos22213646;if (M4.pair_p(l2220)!==false) {if (M4.eq_p(pos2221,1)!==false) {return M4.car(l2220);} else {_l22203645 = M4.cdr(l2220);_pos22213646 = M4.sub1(pos2221);continue lambda_start3644;}} else {return M4.raise_arguments_error($rjs_core.PrimitiveSymbol.make("third"),$rjs_core.UString.make("list contains too few elements"),$rjs_core.UString.make("list"),l02218);}}};return loop2219(l02218,3);} else {return M4.raise_argument_error($rjs_core.PrimitiveSymbol.make("third"),$rjs_core.UString.make("list?"),l02218);}};var fourth = function(l02222) {if (M4.list_p(l02222)!==false) {var loop2223 = function(_l22243649, _pos22253650) {lambda_start3648:while (true){let l2224 = _l22243649;let pos2225 = _pos22253650;if (M4.pair_p(l2224)!==false) {if (M4.eq_p(pos2225,1)!==false) {return M4.car(l2224);} else {_l22243649 = M4.cdr(l2224);_pos22253650 = M4.sub1(pos2225);continue lambda_start3648;}} else {return M4.raise_arguments_error($rjs_core.PrimitiveSymbol.make("fourth"),$rjs_core.UString.make("list contains too few elements"),$rjs_core.UString.make("list"),l02222);}}};return loop2223(l02222,4);} else {return M4.raise_argument_error($rjs_core.PrimitiveSymbol.make("fourth"),$rjs_core.UString.make("list?"),l02222);}};var fifth = function(l02226) {if (M4.list_p(l02226)!==false) {var loop2227 = function(_l22283653, _pos22293654) {lambda_start3652:while (true){let l2228 = _l22283653;let pos2229 = _pos22293654;if (M4.pair_p(l2228)!==false) {if (M4.eq_p(pos2229,1)!==false) {return M4.car(l2228);} else {_l22283653 = M4.cdr(l2228);_pos22293654 = M4.sub1(pos2229);continue lambda_start3652;}} else {return M4.raise_arguments_error($rjs_core.PrimitiveSymbol.make("fifth"),$rjs_core.UString.make("list contains too few elements"),$rjs_core.UString.make("list"),l02226);}}};return loop2227(l02226,5);} else {return M4.raise_argument_error($rjs_core.PrimitiveSymbol.make("fifth"),$rjs_core.UString.make("list?"),l02226);}};var sixth = function(l02230) {if (M4.list_p(l02230)!==false) {var loop2231 = function(_l22323657, _pos22333658) {lambda_start3656:while (true){let l2232 = _l22323657;let pos2233 = _pos22333658;if (M4.pair_p(l2232)!==false) {if (M4.eq_p(pos2233,1)!==false) {return M4.car(l2232);} else {_l22323657 = M4.cdr(l2232);_pos22333658 = M4.sub1(pos2233);continue lambda_start3656;}} else {return M4.raise_arguments_error($rjs_core.PrimitiveSymbol.make("sixth"),$rjs_core.UString.make("list contains too few elements"),$rjs_core.UString.make("list"),l02230);}}};return loop2231(l02230,6);} else {return M4.raise_argument_error($rjs_core.PrimitiveSymbol.make("sixth"),$rjs_core.UString.make("list?"),l02230);}};var seventh = function(l02234) {if (M4.list_p(l02234)!==false) {var loop2235 = function(_l22363661, _pos22373662) {lambda_start3660:while (true){let l2236 = _l22363661;let pos2237 = _pos22373662;if (M4.pair_p(l2236)!==false) {if (M4.eq_p(pos2237,1)!==false) {return M4.car(l2236);} else {_l22363661 = M4.cdr(l2236);_pos22373662 = M4.sub1(pos2237);continue lambda_start3660;}} else {return M4.raise_arguments_error($rjs_core.PrimitiveSymbol.make("seventh"),$rjs_core.UString.make("list contains too few elements"),$rjs_core.UString.make("list"),l02234);}}};return loop2235(l02234,7);} else {return M4.raise_argument_error($rjs_core.PrimitiveSymbol.make("seventh"),$rjs_core.UString.make("list?"),l02234);}};var eighth = function(l02238) {if (M4.list_p(l02238)!==false) {var loop2239 = function(_l22403665, _pos22413666) {lambda_start3664:while (true){let l2240 = _l22403665;let pos2241 = _pos22413666;if (M4.pair_p(l2240)!==false) {if (M4.eq_p(pos2241,1)!==false) {return M4.car(l2240);} else {_l22403665 = M4.cdr(l2240);_pos22413666 = M4.sub1(pos2241);continue lambda_start3664;}} else {return M4.raise_arguments_error($rjs_core.PrimitiveSymbol.make("eighth"),$rjs_core.UString.make("list contains too few elements"),$rjs_core.UString.make("list"),l02238);}}};return loop2239(l02238,8);} else {return M4.raise_argument_error($rjs_core.PrimitiveSymbol.make("eighth"),$rjs_core.UString.make("list?"),l02238);}};var ninth = function(l02242) {if (M4.list_p(l02242)!==false) {var loop2243 = function(_l22443669, _pos22453670) {lambda_start3668:while (true){let l2244 = _l22443669;let pos2245 = _pos22453670;if (M4.pair_p(l2244)!==false) {if (M4.eq_p(pos2245,1)!==false) {return M4.car(l2244);} else {_l22443669 = M4.cdr(l2244);_pos22453670 = M4.sub1(pos2245);continue lambda_start3668;}} else {return M4.raise_arguments_error($rjs_core.PrimitiveSymbol.make("ninth"),$rjs_core.UString.make("list contains too few elements"),$rjs_core.UString.make("list"),l02242);}}};return loop2243(l02242,9);} else {return M4.raise_argument_error($rjs_core.PrimitiveSymbol.make("ninth"),$rjs_core.UString.make("list?"),l02242);}};var tenth = function(l02246) {if (M4.list_p(l02246)!==false) {var loop2247 = function(_l22483673, _pos22493674) {lambda_start3672:while (true){let l2248 = _l22483673;let pos2249 = _pos22493674;if (M4.pair_p(l2248)!==false) {if (M4.eq_p(pos2249,1)!==false) {return M4.car(l2248);} else {_l22483673 = M4.cdr(l2248);_pos22493674 = M4.sub1(pos2249);continue lambda_start3672;}} else {return M4.raise_arguments_error($rjs_core.PrimitiveSymbol.make("tenth"),$rjs_core.UString.make("list contains too few elements"),$rjs_core.UString.make("list"),l02246);}}};return loop2247(l02246,10);} else {return M4.raise_argument_error($rjs_core.PrimitiveSymbol.make("tenth"),$rjs_core.UString.make("list?"),l02246);}};var last_pair = function(l2250) {if (M4.pair_p(l2250)!==false) {var loop2251 = function(_l22523677, _x22533678) {lambda_start3676:while (true){let l2252 = _l22523677;let x2253 = _x22533678;if (M4.pair_p(x2253)!==false) {_l22523677 = x2253;_x22533678 = M4.cdr(x2253);continue lambda_start3676;} else {return l2252;}}};return loop2251(l2250,M4.cdr(l2250));} else {return M4.raise_argument_error($rjs_core.PrimitiveSymbol.make("last-pair"),$rjs_core.UString.make("pair?"),l2250);}};var last = function(l2254) {if (M4.pair_p(l2254)!==false) {var if_res3104 = M4.list_p(l2254);} else {var if_res3104 = false;}if (if_res3104!==false) {var loop2255 = function(_l22563681, _x22573682) {lambda_start3680:while (true){let l2256 = _l22563681;let x2257 = _x22573682;if (M4.pair_p(x2257)!==false) {_l22563681 = x2257;_x22573682 = M4.cdr(x2257);continue lambda_start3680;} else {return M4.car(l2256);}}};return loop2255(l2254,M4.cdr(l2254));} else {return M4.raise_argument_error($rjs_core.PrimitiveSymbol.make("last"),$rjs_core.UString.make("(and/c list? (not/c empty?))"),l2254);}};var rest = function(l2258) {if (M4.pair_p(l2258)!==false) {var if_res3107 = M4.list_p(l2258);} else {var if_res3107 = false;}if (if_res3107!==false) {return M4.cdr(l2258);} else {return M4.raise_argument_error($rjs_core.PrimitiveSymbol.make("rest"),$rjs_core.UString.make("(and/c list? (not/c empty?))"),l2258);}};var empty = $rjs_core.Pair.EMPTY;var make_list = function(n2259, x2260) {if (M4.exact_nonnegative_integer_p(n2259)!==false) {var if_res3109 = M4.rvoid();} else {var if_res3109 = M4.raise_argument_error($rjs_core.PrimitiveSymbol.make("make-list"),$rjs_core.UString.make("exact-nonnegative-integer?"),0,n2259,x2260);}if_res3109;var loop2261 = function(_n22623686, _r22633687) {lambda_start3685:while (true){let n2262 = _n22623686;let r2263 = _r22633687;if (M4.zero_p(n2262)!==false) {return r2263;} else {_n22623686 = M4.sub1(n2262);_r22633687 = M4.cons(x2260,r2263);continue lambda_start3685;}}};return loop2261(n2259,$rjs_core.Pair.EMPTY);};var list_update = function(l2264, i2265, f2266) {if (M4.list_p(l2264)!==false) {var if_res3111 = M4.rvoid();} else {var if_res3111 = M4.raise_argument_error($rjs_core.PrimitiveSymbol.make("list-update"),$rjs_core.UString.make("list?"),0,l2264,i2265,f2266);}if_res3111;if (M4.exact_nonnegative_integer_p(i2265)!==false) {var if_res3112 = M4.rvoid();} else {var if_res3112 = M4.raise_argument_error($rjs_core.PrimitiveSymbol.make("list-update"),$rjs_core.UString.make("exact-nonnegative-integer?"),1,l2264,i2265,f2266);}if_res3112;if (M4.procedure_p(f2266)!==false) {var if_res3113 = M4.procedure_arity_includes_p(f2266,1);} else {var if_res3113 = false;}if (if_res3113!==false) {var if_res3114 = M4.rvoid();} else {var if_res3114 = M4.raise_argument_error($rjs_core.PrimitiveSymbol.make("list-update"),$rjs_core.UString.make("(-> any/c any/c)"),2,l2264,i2265,f2266);}if_res3114;if (M4.zero_p(i2265)!==false) {return M4.cons(f2266(M4.car(l2264)),M4.cdr(l2264));} else {return M4.cons(M4.car(l2264),list_update(M4.cdr(l2264),M4.sub1(i2265),f2266));}};var list_set = function(l2267, k2268, v2269) {if (M4.list_p(l2267)!==false) {var if_res3116 = M4.rvoid();} else {var if_res3116 = M4.raise_argument_error($rjs_core.PrimitiveSymbol.make("list-set"),$rjs_core.UString.make("list?"),0,l2267,k2268,v2269);}if_res3116;if (M4.exact_nonnegative_integer_p(k2268)!==false) {var if_res3117 = M4.rvoid();} else {var if_res3117 = M4.raise_argument_error($rjs_core.PrimitiveSymbol.make("list-set"),$rjs_core.UString.make("exact-nonnegative-integer?"),1,l2267,k2268,v2269);}if_res3117;return list_update(l2267,k2268,function(_2270) {return v2269;});};var drop_times_ = function(_list22713692, _n22723693) {lambda_start3691:while (true){let list2271 = _list22713692;let n2272 = _n22723693;if (M4.zero_p(n2272)!==false) {return list2271;} else if (M4.pair_p(list2271)!==false) {_list22713692 = M4.cdr(list2271);_n22723693 = M4.sub1(n2272);continue lambda_start3691;} else {return false;}}};var too_large = function(who2273, list2274, n2275) {var proper_p2276 = M4.list_p(list2274);var temp3122 = $rjs_core.UString.make("a ~alist with at least ~a ~a");if (proper_p2276!==false) {var if_res3121 = $rjs_core.UString.make("");} else {var if_res3121 = $rjs_core.UString.make("(possibly improper) ");}if (proper_p2276!==false) {var if_res3120 = $rjs_core.UString.make("elements");} else {var if_res3120 = $rjs_core.UString.make("pairs");}return M4.raise_argument_error(who2273,M4.format(temp3122,if_res3121,n2275,if_res3120),list2274);};var take = function(list02277, n02278) {if (M4.exact_nonnegative_integer_p(n02278)!==false) {var if_res3123 = M4.rvoid();} else {var if_res3123 = M4.raise_argument_error($rjs_core.PrimitiveSymbol.make("take"),$rjs_core.UString.make("exact-nonnegative-integer?"),1,list02277,n02278);}if_res3123;var loop2279 = function(list2280, n2281) {if (M4.zero_p(n2281)!==false) {return $rjs_core.Pair.EMPTY;} else if (M4.pair_p(list2280)!==false) {return M4.cons(M4.car(list2280),loop2279(M4.cdr(list2280),M4.sub1(n2281)));} else {return too_large($rjs_core.PrimitiveSymbol.make("take"),list02277,n02278);}};return loop2279(list02277,n02278);};var drop = function(list2282, n2283) {if (M4.exact_nonnegative_integer_p(n2283)!==false) {var if_res3126 = M4.rvoid();} else {var if_res3126 = M4.raise_argument_error($rjs_core.PrimitiveSymbol.make("drop"),$rjs_core.UString.make("exact-nonnegative-integer?"),1,list2282,n2283);}if_res3126;var or_part2284 = drop_times_(list2282,n2283);if (or_part2284!==false) {return or_part2284;} else {return too_large($rjs_core.PrimitiveSymbol.make("drop"),list2282,n2283);}};var split_at = function(list02285, n02286) {if (M4.exact_nonnegative_integer_p(n02286)!==false) {var if_res3128 = M4.rvoid();} else {var if_res3128 = M4.raise_argument_error($rjs_core.PrimitiveSymbol.make("split-at"),$rjs_core.UString.make("exact-nonnegative-integer?"),1,list02285,n02286);}if_res3128;var loop2287 = function(_list22883700, _n22893701, _pfx22903702) {lambda_start3699:while (true){let list2288 = _list22883700;let n2289 = _n22893701;let pfx2290 = _pfx22903702;if (M4.zero_p(n2289)!==false) {return M4.values(M1.alt_reverse(pfx2290),list2288);} else if (M4.pair_p(list2288)!==false) {_list22883700 = M4.cdr(list2288);_n22893701 = M4.sub1(n2289);_pfx22903702 = M4.cons(M4.car(list2288),pfx2290);continue lambda_start3699;} else {return too_large($rjs_core.PrimitiveSymbol.make("split-at"),list02285,n02286);}}};return loop2287(list02285,n02286,$rjs_core.Pair.EMPTY);};var takef = function(list2291, pred2292) {if (M4.procedure_p(pred2292)!==false) {var if_res3131 = M4.rvoid();} else {var if_res3131 = M4.raise_argument_error($rjs_core.PrimitiveSymbol.make("takef"),$rjs_core.UString.make("procedure?"),1,list2291,pred2292);}if_res3131;var loop2293 = function(list2294) {if (M4.pair_p(list2294)!==false) {var x2295 = M4.car(list2294);if (pred2292(x2295)!==false) {return M4.cons(x2295,loop2293(M4.cdr(list2294)));} else {return $rjs_core.Pair.EMPTY;}} else {return $rjs_core.Pair.EMPTY;}};return loop2293(list2291);};var dropf = function(list2296, pred2297) {if (M4.procedure_p(pred2297)!==false) {var if_res3134 = M4.rvoid();} else {var if_res3134 = M4.raise_argument_error($rjs_core.PrimitiveSymbol.make("dropf"),$rjs_core.UString.make("procedure?"),1,list2296,pred2297);}if_res3134;var loop2298 = function(_list22993707) {lambda_start3706:while (true){let list2299 = _list22993707;if (M4.pair_p(list2299)!==false) {var if_res3135 = pred2297(M4.car(list2299));} else {var if_res3135 = false;}if (if_res3135!==false) {_list22993707 = M4.cdr(list2299);continue lambda_start3706;} else {return list2299;}}};return loop2298(list2296);};var splitf_at = function(list2300, pred2301) {if (M4.procedure_p(pred2301)!==false) {var if_res3137 = M4.rvoid();} else {var if_res3137 = M4.raise_argument_error($rjs_core.PrimitiveSymbol.make("splitf-at"),$rjs_core.UString.make("procedure?"),1,list2300,pred2301);}if_res3137;var loop2302 = function(_list23033710, _pfx23043711) {lambda_start3709:while (true){let list2303 = _list23033710;let pfx2304 = _pfx23043711;if (M4.pair_p(list2303)!==false) {var if_res3138 = pred2301(M4.car(list2303));} else {var if_res3138 = false;}if (if_res3138!==false) {_list23033710 = M4.cdr(list2303);_pfx23043711 = M4.cons(M4.car(list2303),pfx2304);continue lambda_start3709;} else {return M4.values(M1.alt_reverse(pfx2304),list2303);}}};return loop2302(list2300,$rjs_core.Pair.EMPTY);};var take_right = function(list2305, n2306) {if (M4.exact_nonnegative_integer_p(n2306)!==false) {var if_res3140 = M4.rvoid();} else {var if_res3140 = M4.raise_argument_error($rjs_core.PrimitiveSymbol.make("take-right"),$rjs_core.UString.make("exact-nonnegative-integer?"),1,list2305,n2306);}if_res3140;var loop2307 = function(_list23083714, _lead23093715) {lambda_start3713:while (true){let list2308 = _list23083714;let lead2309 = _lead23093715;if (M4.pair_p(lead2309)!==false) {_list23083714 = M4.cdr(list2308);_lead23093715 = M4.cdr(lead2309);continue lambda_start3713;} else {return list2308;}}};var or_part2310 = drop_times_(list2305,n2306);if (or_part2310!==false) {var if_res3141 = or_part2310;} else {var if_res3141 = too_large($rjs_core.PrimitiveSymbol.make("take-right"),list2305,n2306);}return loop2307(list2305,if_res3141);};var drop_right = function(list2311, n2312) {if (M4.exact_nonnegative_integer_p(n2312)!==false) {var if_res3143 = M4.rvoid();} else {var if_res3143 = M4.raise_argument_error($rjs_core.PrimitiveSymbol.make("drop-right"),$rjs_core.UString.make("exact-nonnegative-integer?"),1,list2311,n2312);}if_res3143;var loop2313 = function(list2314, lead2315) {if (M4.pair_p(lead2315)!==false) {return M4.cons(M4.car(list2314),loop2313(M4.cdr(list2314),M4.cdr(lead2315)));} else {return $rjs_core.Pair.EMPTY;}};var or_part2316 = drop_times_(list2311,n2312);if (or_part2316!==false) {var if_res3144 = or_part2316;} else {var if_res3144 = too_large($rjs_core.PrimitiveSymbol.make("drop-right"),list2311,n2312);}return loop2313(list2311,if_res3144);};var split_at_right = function(list2317, n2318) {if (M4.exact_nonnegative_integer_p(n2318)!==false) {var if_res3146 = M4.rvoid();} else {var if_res3146 = M4.raise_argument_error($rjs_core.PrimitiveSymbol.make("split-at-right"),$rjs_core.UString.make("exact-nonnegative-integer?"),1,list2317,n2318);}if_res3146;var loop2319 = function(_list23203720, _lead23213721, _pfx23223722) {lambda_start3719:while (true){let list2320 = _list23203720;let lead2321 = _lead23213721;let pfx2322 = _pfx23223722;if (M4.pair_p(lead2321)!==false) {_list23203720 = M4.cdr(list2320);_lead23213721 = M4.cdr(lead2321);_pfx23223722 = M4.cons(M4.car(list2320),pfx2322);continue lambda_start3719;} else {return M4.values(M1.alt_reverse(pfx2322),list2320);}}};var or_part2323 = drop_times_(list2317,n2318);if (or_part2323!==false) {var if_res3147 = or_part2323;} else {var if_res3147 = too_large($rjs_core.PrimitiveSymbol.make("split-at-right"),list2317,n2318);}return loop2319(list2317,if_res3147,$rjs_core.Pair.EMPTY);};var count_from_right = function(who2324, list2325, pred2326) {if (M4.procedure_p(pred2326)!==false) {var if_res3149 = M4.rvoid();} else {var if_res3149 = M4.raise_argument_error(who2324,$rjs_core.UString.make("procedure?"),1,list2325,pred2326);}if_res3149;var loop2327 = function(_list23283725, _rev23293726, _n23303727) {lambda_start3724:while (true){let list2328 = _list23283725;let rev2329 = _rev23293726;let n2330 = _n23303727;if (M4.pair_p(list2328)!==false) {_list23283725 = M4.cdr(list2328);_rev23293726 = M4.cons(M4.car(list2328),rev2329);_n23303727 = M4.add1(n2330);continue lambda_start3724;} else {var loop2331 = function(_n23323729, _list23333730) {lambda_start3728:while (true){let n2332 = _n23323729;let list2333 = _list23333730;if (M4.pair_p(list2333)!==false) {var if_res3150 = pred2326(M4.car(list2333));} else {var if_res3150 = false;}if (if_res3150!==false) {_n23323729 = M4.sub1(n2332);_list23333730 = M4.cdr(list2333);continue lambda_start3728;} else {return n2332;}}};return loop2331(n2330,rev2329);}}};return loop2327(list2325,$rjs_core.Pair.EMPTY,0);};var takef_right = function(list2334, pred2335) {return drop(list2334,count_from_right($rjs_core.PrimitiveSymbol.make("takef-right"),list2334,pred2335));};var dropf_right = function(list2336, pred2337) {return take(list2336,count_from_right($rjs_core.PrimitiveSymbol.make("dropf-right"),list2336,pred2337));};var splitf_at_right = function(list2338, pred2339) {return split_at(list2338,count_from_right($rjs_core.PrimitiveSymbol.make("splitf-at-right"),list2338,pred2339));};var list_prefix_p2340 = function(ls22341, rs32342, same_p12343) {var ls2344 = ls22341;var rs2345 = rs32342;if (M4.eq_p(same_p12343,M10.unsafe_undefined)!==false) {var if_res3153 = M4.equal_p;} else {var if_res3153 = same_p12343;}var same_p2346 = if_res3153;if (M4.list_p(ls2344)!==false) {var if_res3154 = M4.rvoid();} else {var if_res3154 = M4.raise_argument_error($rjs_core.PrimitiveSymbol.make("list-prefix?"),$rjs_core.UString.make("list?"),0,ls2344,rs2345);}if_res3154;if (M4.list_p(rs2345)!==false) {var if_res3155 = M4.rvoid();} else {var if_res3155 = M4.raise_argument_error($rjs_core.PrimitiveSymbol.make("list-prefix?"),$rjs_core.UString.make("list?"),1,ls2344,rs2345);}if_res3155;if (M4.procedure_p(same_p2346)!==false) {var if_res3156 = M4.procedure_arity_includes_p(same_p2346,2);} else {var if_res3156 = false;}if (if_res3156!==false) {var if_res3157 = M4.rvoid();} else {var if_res3157 = M4.raise_argument_error($rjs_core.PrimitiveSymbol.make("list-prefix?"),$rjs_core.UString.make("(any/c any/c . -> . any/c)"),2,ls2344,rs2345,same_p2346);}if_res3157;var or_part2347 = M4.null_p(ls2344);if (or_part2347!==false) {return or_part2347;} else if (M4.pair_p(rs2345)!==false) {if (same_p2346(M4.car(ls2344),M4.car(rs2345))!==false) {return list_prefix_p(M4.cdr(ls2344),M4.cdr(rs2345));} else {return false;}} else {return false;}};var cl3161 = function(ls2348, rs2349) {return list_prefix_p2340(ls2348,rs2349,M10.unsafe_undefined);};var cl3162 = function(ls2350, rs2351, same_p12352) {return list_prefix_p2340(ls2350,rs2351,same_p12352);};var list_prefix_p = $rjs_core.attachProcedureArity(function() {var fixed_lam3163 = {'2':cl3161,'3':cl3162}[arguments.length];if (fixed_lam3163!==undefined) {return fixed_lam3163.apply(null,arguments);} else {return M4.error($rjs_core.UString.make("case-lambda: invalid case"));}},[2,3]);var internal_split_common_prefix = function(as2353, bs2354, same_p2355, keep_prefix_p2356, name2357) {if (M4.list_p(as2353)!==false) {var if_res3164 = M4.rvoid();} else {var if_res3164 = M4.raise_argument_error(name2357,$rjs_core.UString.make("list?"),0,as2353,bs2354);}if_res3164;if (M4.list_p(bs2354)!==false) {var if_res3165 = M4.rvoid();} else {var if_res3165 = M4.raise_argument_error(name2357,$rjs_core.UString.make("list?"),1,as2353,bs2354);}if_res3165;if (M4.procedure_p(same_p2355)!==false) {var if_res3166 = M4.procedure_arity_includes_p(same_p2355,2);} else {var if_res3166 = false;}if (if_res3166!==false) {var if_res3167 = M4.rvoid();} else {var if_res3167 = M4.raise_argument_error(name2357,$rjs_core.UString.make("(any/c any/c . -> . any/c)"),2,as2353,bs2354,same_p2355);}if_res3167;var loop2358 = function(as2359, bs2360) {if (M4.pair_p(as2359)!==false) {if (M4.pair_p(bs2360)!==false) {var if_res3168 = same_p2355(M4.car(as2359),M4.car(bs2360));} else {var if_res3168 = false;}var if_res3169 = if_res3168;} else {var if_res3169 = false;}if (if_res3169!==false) {var let_result3170 = loop2358(M4.cdr(as2359),M4.cdr(bs2360));var prefix2361 = let_result3170.getAt(0);var atail2362 = let_result3170.getAt(1);var btail2363 = let_result3170.getAt(2);if (keep_prefix_p2356!==false) {var if_res3171 = M4.cons(M4.car(as2359),prefix2361);} else {var if_res3171 = false;}return M4.values(if_res3171,atail2362,btail2363);} else {return M4.values(M4.rnull,as2359,bs2360);}};return loop2358(as2353,bs2354);};var split_common_prefix2364 = function(as52365, bs62366, same_p42367) {var as2368 = as52365;var bs2369 = bs62366;if (M4.eq_p(same_p42367,M10.unsafe_undefined)!==false) {var if_res3173 = M4.equal_p;} else {var if_res3173 = same_p42367;}var same_p2370 = if_res3173;return internal_split_common_prefix(as2368,bs2369,same_p2370,true,$rjs_core.PrimitiveSymbol.make("split-common-prefix"));};var cl3174 = function(as2371, bs2372) {return split_common_prefix2364(as2371,bs2372,M10.unsafe_undefined);};var cl3175 = function(as2373, bs2374, same_p42375) {return split_common_prefix2364(as2373,bs2374,same_p42375);};var split_common_prefix = $rjs_core.attachProcedureArity(function() {var fixed_lam3176 = {'2':cl3174,'3':cl3175}[arguments.length];if (fixed_lam3176!==undefined) {return fixed_lam3176.apply(null,arguments);} else {return M4.error($rjs_core.UString.make("case-lambda: invalid case"));}},[2,3]);var take_common_prefix2376 = function(as82377, bs92378, same_p72379) {var as2380 = as82377;var bs2381 = bs92378;if (M4.eq_p(same_p72379,M10.unsafe_undefined)!==false) {var if_res3177 = M4.equal_p;} else {var if_res3177 = same_p72379;}var same_p2382 = if_res3177;var let_result3178 = internal_split_common_prefix(as2380,bs2381,same_p2382,true,$rjs_core.PrimitiveSymbol.make("take-common-prefix"));var prefix2383 = let_result3178.getAt(0);var atail2384 = let_result3178.getAt(1);var btail2385 = let_result3178.getAt(2);return prefix2383;};var cl3179 = function(as2386, bs2387) {return take_common_prefix2376(as2386,bs2387,M10.unsafe_undefined);};var cl3180 = function(as2388, bs2389, same_p72390) {return take_common_prefix2376(as2388,bs2389,same_p72390);};var take_common_prefix = $rjs_core.attachProcedureArity(function() {var fixed_lam3181 = {'2':cl3179,'3':cl3180}[arguments.length];if (fixed_lam3181!==undefined) {return fixed_lam3181.apply(null,arguments);} else {return M4.error($rjs_core.UString.make("case-lambda: invalid case"));}},[2,3]);var drop_common_prefix2391 = function(as112392, bs122393, same_p102394) {var as2395 = as112392;var bs2396 = bs122393;if (M4.eq_p(same_p102394,M10.unsafe_undefined)!==false) {var if_res3182 = M4.equal_p;} else {var if_res3182 = same_p102394;}var same_p2397 = if_res3182;var let_result3183 = internal_split_common_prefix(as2395,bs2396,same_p2397,false,$rjs_core.PrimitiveSymbol.make("drop-common-prefix"));var prefix2398 = let_result3183.getAt(0);var atail2399 = let_result3183.getAt(1);var btail2400 = let_result3183.getAt(2);return M4.values(atail2399,btail2400);};var cl3184 = function(as2401, bs2402) {return drop_common_prefix2391(as2401,bs2402,M10.unsafe_undefined);};var cl3185 = function(as2403, bs2404, same_p102405) {return drop_common_prefix2391(as2403,bs2404,same_p102405);};var drop_common_prefix = $rjs_core.attachProcedureArity(function() {var fixed_lam3186 = {'2':cl3184,'3':cl3185}[arguments.length];if (fixed_lam3186!==undefined) {return fixed_lam3186.apply(null,arguments);} else {return M4.error($rjs_core.UString.make("case-lambda: invalid case"));}},[2,3]);var cl3187 = function(ls2406) {return M4.apply(M4.append,ls2406);};var cl3188 = function(l12407, l22408) {return M4.apply(M4.append,l12407,l22408);};var cl3189 = function(l12409, l22410, l32411) {return M4.apply(M4.append,l12409,l22410,l32411);};var cl3190 = function(l12412, l22413, l32414, l42415) {return M4.apply(M4.append,l12412,l22413,l32414,l42415);};var cl3191 = $rjs_core.attachProcedureArity(function(l2416, ...lss24173194) {var lss2417 = $rjs_core.Pair.listFromArray(lss24173194);return M4.apply(M0.new_apply_proc,M4.append,l2416,lss2417);});var append_times_ = $rjs_core.attachProcedureArity(function() {var fixed_lam3192 = {'1':cl3187,'2':cl3188,'3':cl3189,'4':cl3190}[arguments.length];if (fixed_lam3192!==undefined) {return fixed_lam3192.apply(null,arguments);} else if (M4.__gt__eq_(cl3191.length,1)!==false) {return cl3191.apply(null,arguments);} else {return M4.error($rjs_core.UString.make("case-lambda: invalid case"));}},[M4.make_arity_at_least(1)]);var flatten = function(orig_sexp2418) {var loop2419 = function(_sexp24203760, _acc24213761) {lambda_start3759:while (true){let sexp2420 = _sexp24203760;let acc2421 = _acc24213761;if (M4.null_p(sexp2420)!==false) {return acc2421;} else if (M4.pair_p(sexp2420)!==false) {_sexp24203760 = M4.car(sexp2420);_acc24213761 = loop2419(M4.cdr(sexp2420),acc2421);continue lambda_start3759;} else {return M4.cons(sexp2420,acc2421);}}};return loop2419(orig_sexp2418,M4.rnull);};var add_between = function(after_last162422, before_first142423, before_last152424, splice_p132425, l212426, x222427) {var l2428 = l212426;var x2429 = x222427;if (false!==false) {var if_res3197 = false;} else {var if_res3197 = splice_p132425;}var splice_p2430 = if_res3197;if (false!==false) {var if_res3198 = $rjs_core.Pair.EMPTY;} else {var if_res3198 = before_first142423;}var before_first2431 = if_res3198;if (M4.eq_p(before_last152424,M10.unsafe_undefined)!==false) {var if_res3199 = x2429;} else {var if_res3199 = before_last152424;}var before_last2432 = if_res3199;if (false!==false) {var if_res3200 = $rjs_core.Pair.EMPTY;} else {var if_res3200 = after_last162422;}var after_last2433 = if_res3200;if (M4.list_p(l2428)!==false) {var if_res3201 = M4.rvoid();} else {var if_res3201 = M4.raise_argument_error($rjs_core.PrimitiveSymbol.make("add-between"),$rjs_core.UString.make("list?"),0,l2428,x2429);}if_res3201;if (splice_p2430!==false) {var check_list2434 = function(x2435, which2436) {if (M4.list_p(x2435)!==false) {return M4.rvoid();} else {return M4.raise_arguments_error($rjs_core.PrimitiveSymbol.make("add-between"),M4.string_append($rjs_core.UString.make("list needed in splicing mode"),which2436),$rjs_core.UString.make("given"),x2435,$rjs_core.UString.make("given list..."),l2428);}};check_list2434(x2429,$rjs_core.UString.make(""));check_list2434(before_first2431,$rjs_core.UString.make(" for #:before-first"));check_list2434(before_last2432,$rjs_core.UString.make(" for #:before-last"));var if_res3204 = check_list2434(after_last2433,$rjs_core.UString.make(" for #:after-last"));} else {var check_not_given2437 = function(x2438, which2439) {if (M4.eq_p($rjs_core.Pair.EMPTY,x2438)!==false) {return M4.rvoid();} else {return M4.raise_arguments_error($rjs_core.PrimitiveSymbol.make("add-between"),M4.string_append(which2439,$rjs_core.UString.make(" can only be used in splicing mode")),$rjs_core.UString.make("given"),x2438,$rjs_core.UString.make("given list..."),l2428);}};check_not_given2437(before_first2431,$rjs_core.UString.make("#:before-first"));var if_res3204 = check_not_given2437(after_last2433,$rjs_core.UString.make("#:after-last"));}if_res3204;var or_part2440 = M4.null_p(l2428);if (or_part2440!==false) {var if_res3205 = or_part2440;} else {var if_res3205 = M4.null_p(M4.cdr(l2428));}if (if_res3205!==false) {if (splice_p2430!==false) {return M4.append(before_first2431,l2428,after_last2433);} else {return l2428;}} else if (splice_p2430!==false) {var x2441 = M1.alt_reverse(x2429);var loop2443 = function(_i24443766, _l24453767, _r24463768) {lambda_start3765:while (true){let i2444 = _i24443766;let l2445 = _l24453767;let r2446 = _r24463768;if (M4.pair_p(l2445)!==false) {_i24443766 = M4.car(l2445);_l24453767 = M4.cdr(l2445);_r24463768 = M4.cons(i2444,M4.append(x2441,r2446));continue lambda_start3765;} else {return M4.cons(i2444,M4.append(M1.alt_reverse(before_last2432),r2446));}}};var r2442 = loop2443(M4.cadr(l2428),M4.cddr(l2428),$rjs_core.Pair.EMPTY);var r2447 = M1.alt_reverse(M4.append(M1.alt_reverse(after_last2433),r2442));return M3.__rjs_quoted__.qq_append(before_first2431,M4.list_times_(M4.car(l2428),r2447));} else {var temp3209 = M4.car(l2428);var loop2449 = function(_i24503770, _l24513771, _r24523772) {lambda_start3769:while (true){let i2450 = _i24503770;let l2451 = _l24513771;let r2452 = _r24523772;if (M4.pair_p(l2451)!==false) {_i24503770 = M4.car(l2451);_l24513771 = M4.cdr(l2451);_r24523772 = M4.cons(i2450,M4.cons(x2429,r2452));continue lambda_start3769;} else {return M4.cons(i2450,M4.cons(before_last2432,r2452));}}};return M4.cons(temp3209,M1.alt_reverse(loop2449(M4.cadr(l2428),M4.cddr(l2428),$rjs_core.Pair.EMPTY)));}};var add_between2210 = function(given_kws2453, given_args2454, l212455, x222456) {if (M4.pair_p(given_kws2453)!==false) {var if_res3212 = M4.eq_p($rjs_core.Keyword.make("after-last"),M4.car(given_kws2453));} else {var if_res3212 = false;}var after_last202457 = if_res3212;if (after_last202457!==false) {var if_res3213 = M4.car(given_args2454);} else {var if_res3213 = $rjs_core.Pair.EMPTY;}var after_last162458 = if_res3213;if (after_last202457!==false) {var if_res3214 = M4.cdr(given_kws2453);} else {var if_res3214 = given_kws2453;}var kws1092382459 = if_res3214;if (after_last202457!==false) {var if_res3215 = M4.cdr(given_args2454);} else {var if_res3215 = given_args2454;}var kw_args1092392460 = if_res3215;if (M4.pair_p(kws1092382459)!==false) {var if_res3216 = M4.eq_p($rjs_core.Keyword.make("before-first"),M4.car(kws1092382459));} else {var if_res3216 = false;}var before_first182461 = if_res3216;if (before_first182461!==false) {var if_res3217 = M4.car(kw_args1092392460);} else {var if_res3217 = $rjs_core.Pair.EMPTY;}var before_first142462 = if_res3217;if (before_first182461!==false) {var if_res3218 = M4.cdr(kws1092382459);} else {var if_res3218 = kws1092382459;}var kws1092402463 = if_res3218;if (before_first182461!==false) {var if_res3219 = M4.cdr(kw_args1092392460);} else {var if_res3219 = kw_args1092392460;}var kw_args1092412464 = if_res3219;if (M4.pair_p(kws1092402463)!==false) {var if_res3220 = M4.eq_p($rjs_core.Keyword.make("before-last"),M4.car(kws1092402463));} else {var if_res3220 = false;}var before_last192465 = if_res3220;if (before_last192465!==false) {var if_res3221 = M4.car(kw_args1092412464);} else {var if_res3221 = M10.unsafe_undefined;}var before_last152466 = if_res3221;if (before_last192465!==false) {var if_res3222 = M4.cdr(kws1092402463);} else {var if_res3222 = kws1092402463;}var kws1092422467 = if_res3222;if (before_last192465!==false) {var if_res3223 = M4.cdr(kw_args1092412464);} else {var if_res3223 = kw_args1092412464;}var kw_args1092432468 = if_res3223;var splice_p172469 = M4.pair_p(kws1092422467);if (splice_p172469!==false) {var if_res3224 = M4.car(kw_args1092432468);} else {var if_res3224 = false;}var splice_p132470 = if_res3224;return add_between(after_last162458,before_first142462,before_last152466,splice_p132470,l212455,x222456);};var cl3228 = function(given_kws2481, given_args2482, l2483, x2484) {return add_between2210(given_kws2481,given_args2482,l2483,x2484);};var temp3230 = $rjs_core.attachProcedureArity(function() {var fixed_lam3229 = {'4':cl3228}[arguments.length];if (fixed_lam3229!==undefined) {return fixed_lam3229.apply(null,arguments);} else {return M4.error($rjs_core.UString.make("case-lambda: invalid case"));}},[4]);var temp3227 = $rjs_core.Pair.makeList($rjs_core.Keyword.make("after-last"),$rjs_core.Keyword.make("before-first"),$rjs_core.Keyword.make("before-last"),$rjs_core.Keyword.make("splice?"));var cl3225 = function(l2485, x2486) {return add_between2210(M4.rnull,M4.rnull,l2485,x2486);};var add_between23 = M9.__rjs_quoted__.make_optional_keyword_procedure(function(given_kws2471, given_argc2472) {if (M4.__eq_(given_argc2472,4)!==false) {var l11092442473 = given_kws2471;if (M4.null_p(l11092442473)!==false) {var if_res3232 = l11092442473;} else {if (M4.eq_p(M4.car(l11092442473),$rjs_core.Keyword.make("after-last"))!==false) {var if_res3231 = M4.cdr(l11092442473);} else {var if_res3231 = l11092442473;}var if_res3232 = if_res3231;}var l11092442474 = if_res3232;var l11092452475 = l11092442474;if (M4.null_p(l11092452475)!==false) {var if_res3234 = l11092452475;} else {if (M4.eq_p(M4.car(l11092452475),$rjs_core.Keyword.make("before-first"))!==false) {var if_res3233 = M4.cdr(l11092452475);} else {var if_res3233 = l11092452475;}var if_res3234 = if_res3233;}var l11092452476 = if_res3234;var l11092462477 = l11092452476;if (M4.null_p(l11092462477)!==false) {var if_res3236 = l11092462477;} else {if (M4.eq_p(M4.car(l11092462477),$rjs_core.Keyword.make("before-last"))!==false) {var if_res3235 = M4.cdr(l11092462477);} else {var if_res3235 = l11092462477;}var if_res3236 = if_res3235;}var l11092462478 = if_res3236;var l11092472479 = l11092462478;if (M4.null_p(l11092472479)!==false) {var if_res3238 = l11092472479;} else {if (M4.eq_p(M4.car(l11092472479),$rjs_core.Keyword.make("splice?"))!==false) {var if_res3237 = M4.cdr(l11092472479);} else {var if_res3237 = l11092472479;}var if_res3238 = if_res3237;}var l11092472480 = if_res3238;return M4.null_p(l11092472480);} else {return false;}},temp3230,M4.rnull,temp3227,$rjs_core.attachProcedureArity(function() {var fixed_lam3226 = {'2':cl3225}[arguments.length];if (fixed_lam3226!==undefined) {return fixed_lam3226.apply(null,arguments);} else {return M4.error($rjs_core.UString.make("case-lambda: invalid case"));}},[2]));var remove_duplicates = function(key242487, l272488, __eq__p262489) {var l2490 = l272488;if (M4.eq_p(__eq__p262489,M10.unsafe_undefined)!==false) {var if_res3240 = M4.equal_p;} else {var if_res3240 = __eq__p262489;}var __eq__p2491 = if_res3240;if (false!==false) {var if_res3241 = false;} else {var if_res3241 = key242487;}var key2492 = if_res3241;if (M4.list_p(l2490)!==false) {var if_res3242 = M4.rvoid();} else {var if_res3242 = M4.raise_argument_error($rjs_core.PrimitiveSymbol.make("remove-duplicates"),$rjs_core.UString.make("list?"),l2490);}if_res3242;var len2493 = M4.length(l2490);if (M4.__lt__eq_(len2493,1)!==false) {var if_res3246 = true;} else {if (M4.__lt__eq_(len2493,40)!==false) {var if_res3245 = false;} else {if (M4.eq_p(__eq__p2491,M4.eq_p)!==false) {var if_res3244 = M4.make_hasheq();} else {if (M4.eq_p(__eq__p2491,M4.equal_p)!==false) {var if_res3243 = M4.make_hash();} else {var if_res3243 = false;}var if_res3244 = if_res3243;}var if_res3245 = if_res3244;}var if_res3246 = if_res3245;}var h2494 = if_res3246;var tmp2495 = h2494;if (M4.equal_p(tmp2495,true)!==false) {return l2490;} else if (M4.equal_p(tmp2495,false)!==false) {var or_part2497 = key2492;if (or_part2497!==false) {var if_res3247 = or_part2497;} else {var if_res3247 = function(x2498) {return x2498;};}var key2496 = if_res3247;if (M4.eq_p(__eq__p2491,M4.equal_p)!==false) {var loop2499 = function(_l25003782, _seen25013783) {lambda_start3781:while (true){let l2500 = _l25003782;let seen2501 = _seen25013783;if (M4.null_p(l2500)!==false) {return l2500;} else {var x2502 = M4.car(l2500);var k2503 = key2496(x2502);var l2504 = M4.cdr(l2500);if (M6.member(k2503,seen2501)!==false) {_l25003782 = l2504;_seen25013783 = seen2501;continue lambda_start3781;} else {return M4.cons(x2502,loop2499(l2504,M4.cons(k2503,seen2501)));}}}};return loop2499(l2490,M4.rnull);} else if (M4.eq_p(__eq__p2491,M4.eq_p)!==false) {var loop2505 = function(_l25063785, _seen25073786) {lambda_start3784:while (true){let l2506 = _l25063785;let seen2507 = _seen25073786;if (M4.null_p(l2506)!==false) {return l2506;} else {var x2508 = M4.car(l2506);var k2509 = key2496(x2508);var l2510 = M4.cdr(l2506);if (M4.memq(k2509,seen2507)!==false) {_l25063785 = l2510;_seen25073786 = seen2507;continue lambda_start3784;} else {return M4.cons(x2508,loop2505(l2510,M4.cons(k2509,seen2507)));}}}};return loop2505(l2490,M4.rnull);} else if (M4.eq_p(__eq__p2491,M4.eqv_p)!==false) {var loop2511 = function(_l25123788, _seen25133789) {lambda_start3787:while (true){let l2512 = _l25123788;let seen2513 = _seen25133789;if (M4.null_p(l2512)!==false) {return l2512;} else {var x2514 = M4.car(l2512);var k2515 = key2496(x2514);var l2516 = M4.cdr(l2512);if (M4.memv(k2515,seen2513)!==false) {_l25123788 = l2516;_seen25133789 = seen2513;continue lambda_start3787;} else {return M4.cons(x2514,loop2511(l2516,M4.cons(k2515,seen2513)));}}}};return loop2511(l2490,M4.rnull);} else {var loop2517 = function(_l25183791, _seen25193792) {lambda_start3790:while (true){let l2518 = _l25183791;let seen2519 = _seen25193792;if (M4.null_p(l2518)!==false) {return l2518;} else {var x2520 = M4.car(l2518);var k2521 = key2496(x2520);var l2522 = M4.cdr(l2518);if ((function(x2523, seen2524) {return M2.ormap(function(y2525) {return __eq__p2491(x2523,y2525);},seen2524);})(k2521,seen2519)!==false) {_l25183791 = l2522;_seen25193792 = seen2519;continue lambda_start3790;} else {return M4.cons(x2520,loop2517(l2522,M4.cons(k2521,seen2519)));}}}};return loop2517(l2490,M4.rnull);}} else if (key2492!==false) {var loop2526 = function(_l25273794) {lambda_start3793:while (true){let l2527 = _l25273794;if (M4.null_p(l2527)!==false) {return l2527;} else {var x2528 = M4.car(l2527);var k2529 = key2492(x2528);var l2530 = M4.cdr(l2527);if (M4.hash_ref(h2494,k2529,false)!==false) {_l25273794 = l2530;continue lambda_start3793;} else {M4.hash_set_bang_(h2494,k2529,true);return M4.cons(x2528,loop2526(l2530));}}}};return loop2526(l2490);} else {var loop2531 = function(_l25323796) {lambda_start3795:while (true){let l2532 = _l25323796;if (M4.null_p(l2532)!==false) {return l2532;} else {var x2533 = M4.car(l2532);var k2534 = x2533;var l2535 = M4.cdr(l2532);if (M4.hash_ref(h2494,k2534,false)!==false) {_l25323796 = l2535;continue lambda_start3795;} else {M4.hash_set_bang_(h2494,k2534,true);return M4.cons(x2533,loop2531(l2535));}}}};return loop2531(l2490);}};var remove_duplicates2211 = function(given_kws2536, given_args2537, l272538, __eq__p262539) {var key252540 = M4.pair_p(given_kws2536);if (key252540!==false) {var if_res3266 = M4.car(given_args2537);} else {var if_res3266 = false;}var key242541 = if_res3266;return remove_duplicates(key242541,l272538,__eq__p262539);};var cl3271 = function(given_kws2546, given_args2547, l2548) {return remove_duplicates2211(given_kws2546,given_args2547,l2548,M10.unsafe_undefined);};var cl3272 = function(given_kws2549, given_args2550, l2551, __eq__p262552) {return remove_duplicates2211(given_kws2549,given_args2550,l2551,__eq__p262552);};var temp3274 = $rjs_core.attachProcedureArity(function() {var fixed_lam3273 = {'3':cl3271,'4':cl3272}[arguments.length];if (fixed_lam3273!==undefined) {return fixed_lam3273.apply(null,arguments);} else {return M4.error($rjs_core.UString.make("case-lambda: invalid case"));}},[3,4]);var temp3270 = $rjs_core.Pair.makeList($rjs_core.Keyword.make("key"));var cl3267 = function(l2553) {return remove_duplicates2211(M4.rnull,M4.rnull,l2553,M10.unsafe_undefined);};var cl3268 = function(l2554, __eq__p262555) {return remove_duplicates2211(M4.rnull,M4.rnull,l2554,__eq__p262555);};var remove_duplicates28 = M9.__rjs_quoted__.make_optional_keyword_procedure(function(given_kws2542, given_argc2543) {if (M4.__gt__eq_(given_argc2543,3)!==false) {var if_res3275 = M4.__lt__eq_(given_argc2543,4);} else {var if_res3275 = false;}if (if_res3275!==false) {var l11092562544 = given_kws2542;if (M4.null_p(l11092562544)!==false) {var if_res3277 = l11092562544;} else {if (M4.eq_p(M4.car(l11092562544),$rjs_core.Keyword.make("key"))!==false) {var if_res3276 = M4.cdr(l11092562544);} else {var if_res3276 = l11092562544;}var if_res3277 = if_res3276;}var l11092562545 = if_res3277;return M4.null_p(l11092562545);} else {return false;}},temp3274,M4.rnull,temp3270,$rjs_core.attachProcedureArity(function() {var fixed_lam3269 = {'1':cl3267,'2':cl3268}[arguments.length];if (fixed_lam3269!==undefined) {return fixed_lam3269.apply(null,arguments);} else {return M4.error($rjs_core.UString.make("case-lambda: invalid case"));}},[1,2]));var check_duplicates = function(default302556, key292557, items342558, same_p332559) {var items2560 = items342558;if (M4.eq_p(same_p332559,M10.unsafe_undefined)!==false) {var if_res3279 = M4.equal_p;} else {var if_res3279 = same_p332559;}var same_p2561 = if_res3279;if (M4.eq_p(key292557,M10.unsafe_undefined)!==false) {var if_res3280 = M4.values;} else {var if_res3280 = key292557;}var key2562 = if_res3280;if (M4.eq_p(default302556,M10.unsafe_undefined)!==false) {var if_res3281 = function() {return false;};} else {var if_res3281 = default302556;}var failure_result2563 = if_res3281;if (M4.list_p(items2560)!==false) {var if_res3282 = M4.rvoid();} else {var if_res3282 = M4.raise_argument_error($rjs_core.PrimitiveSymbol.make("check-duplicates"),$rjs_core.UString.make("list?"),0,items2560);}if_res3282;if (M4.procedure_p(key2562)!==false) {var if_res3283 = M4.procedure_arity_includes_p(key2562,1);} else {var if_res3283 = false;}if (if_res3283!==false) {var if_res3284 = M4.rvoid();} else {var if_res3284 = M4.raise_argument_error($rjs_core.PrimitiveSymbol.make("check-duplicates"),$rjs_core.UString.make("(-> any/c any/c)"),key2562);}if_res3284;if (M4.procedure_p(failure_result2563)!==false) {var if_res3285 = failure_result2563;} else {var if_res3285 = function() {return failure_result2563;};}var fail_k2564 = if_res3285;if (M4.eq_p(same_p2561,M4.equal_p)!==false) {return check_duplicates_by_t(items2560,key2562,M4.make_hash(),fail_k2564);} else if (M4.eq_p(same_p2561,M4.eq_p)!==false) {return check_duplicates_by_t(items2560,key2562,M4.make_hasheq(),fail_k2564);} else if (M4.eq_p(same_p2561,M4.eqv_p)!==false) {return check_duplicates_by_t(items2560,key2562,M4.make_hasheqv(),fail_k2564);} else {if (M4.procedure_p(same_p2561)!==false) {var if_res3286 = M4.procedure_arity_includes_p(same_p2561,2);} else {var if_res3286 = false;}if (if_res3286!==false) {var if_res3287 = M4.rvoid();} else {var if_res3287 = M4.raise_argument_error($rjs_core.PrimitiveSymbol.make("check-duplicates"),$rjs_core.UString.make("(any/c any/c . -> . any/c)"),1,items2560,same_p2561);}if_res3287;return check_duplicates_by_list(items2560,key2562,same_p2561,fail_k2564);}};var check_duplicates2212 = function(given_kws2565, given_args2566, items342567, same_p332568) {if (M4.pair_p(given_kws2565)!==false) {var if_res3291 = M4.eq_p($rjs_core.Keyword.make("default"),M4.car(given_kws2565));} else {var if_res3291 = false;}var default322569 = if_res3291;if (default322569!==false) {var if_res3292 = M4.car(given_args2566);} else {var if_res3292 = M10.unsafe_undefined;}var default302570 = if_res3292;if (default322569!==false) {var if_res3293 = M4.cdr(given_kws2565);} else {var if_res3293 = given_kws2565;}var kws1092572571 = if_res3293;if (default322569!==false) {var if_res3294 = M4.cdr(given_args2566);} else {var if_res3294 = given_args2566;}var kw_args1092582572 = if_res3294;var key312573 = M4.pair_p(kws1092572571);if (key312573!==false) {var if_res3295 = M4.car(kw_args1092582572);} else {var if_res3295 = M10.unsafe_undefined;}var key292574 = if_res3295;return check_duplicates(default302570,key292574,items342567,same_p332568);};var cl3300 = function(given_kws2581, given_args2582, items2583) {return check_duplicates2212(given_kws2581,given_args2582,items2583,M10.unsafe_undefined);};var cl3301 = function(given_kws2584, given_args2585, items2586, same_p332587) {return check_duplicates2212(given_kws2584,given_args2585,items2586,same_p332587);};var temp3303 = $rjs_core.attachProcedureArity(function() {var fixed_lam3302 = {'3':cl3300,'4':cl3301}[arguments.length];if (fixed_lam3302!==undefined) {return fixed_lam3302.apply(null,arguments);} else {return M4.error($rjs_core.UString.make("case-lambda: invalid case"));}},[3,4]);var temp3299 = $rjs_core.Pair.makeList($rjs_core.Keyword.make("default"),$rjs_core.Keyword.make("key"));var cl3296 = function(items2588) {return check_duplicates2212(M4.rnull,M4.rnull,items2588,M10.unsafe_undefined);};var cl3297 = function(items2589, same_p332590) {return check_duplicates2212(M4.rnull,M4.rnull,items2589,same_p332590);};var check_duplicates35 = M9.__rjs_quoted__.make_optional_keyword_procedure(function(given_kws2575, given_argc2576) {if (M4.__gt__eq_(given_argc2576,3)!==false) {var if_res3304 = M4.__lt__eq_(given_argc2576,4);} else {var if_res3304 = false;}if (if_res3304!==false) {var l11092592577 = given_kws2575;if (M4.null_p(l11092592577)!==false) {var if_res3306 = l11092592577;} else {if (M4.eq_p(M4.car(l11092592577),$rjs_core.Keyword.make("default"))!==false) {var if_res3305 = M4.cdr(l11092592577);} else {var if_res3305 = l11092592577;}var if_res3306 = if_res3305;}var l11092592578 = if_res3306;var l11092602579 = l11092592578;if (M4.null_p(l11092602579)!==false) {var if_res3308 = l11092602579;} else {if (M4.eq_p(M4.car(l11092602579),$rjs_core.Keyword.make("key"))!==false) {var if_res3307 = M4.cdr(l11092602579);} else {var if_res3307 = l11092602579;}var if_res3308 = if_res3307;}var l11092602580 = if_res3308;return M4.null_p(l11092602580);} else {return false;}},temp3303,M4.rnull,temp3299,$rjs_core.attachProcedureArity(function() {var fixed_lam3298 = {'1':cl3296,'2':cl3297}[arguments.length];if (fixed_lam3298!==undefined) {return fixed_lam3298.apply(null,arguments);} else {return M4.error($rjs_core.UString.make("case-lambda: invalid case"));}},[1,2]));var check_duplicates_by_t = function(items2591, key2592, table2593, fail_k2594) {var loop2595 = function(_items25963818) {lambda_start3817:while (true){let items2596 = _items25963818;if (M4.pair_p(items2596)!==false) {var key_item2597 = key2592(M4.car(items2596));if (M4.hash_ref(table2593,key_item2597,false)!==false) {return M4.car(items2596);} else {M4.hash_set_bang_(table2593,key_item2597,true);_items25963818 = M4.cdr(items2596);continue lambda_start3817;}} else {return fail_k2594();}}};return loop2595(items2591);};var check_duplicates_by_list = function(items2598, key2599, same_p2600, fail_k2601) {var loop2602 = function(_items26033824, _sofar26043825) {lambda_start3820:while (true){let items2603 = _items26033824;let sofar2604 = _sofar26043825;if (M4.pair_p(items2603)!==false) {var key_item2605 = key2599(M4.car(items2603));var lst2606 = sofar2604;if (M4.variable_reference_from_unsafe_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res3312 = M4.rvoid();} else {var if_res3312 = M7.__rjs_quoted__.check_list(lst2606);}if_res3312;var for_loop2607 = function(_result26083822, _lst26093823) {lambda_start3821:while (true){let result2608 = _result26083822;let lst2609 = _lst26093823;if (M4.pair_p(lst2609)!==false) {var prev2610 = M10.unsafe_car(lst2609);var rest2611 = M10.unsafe_cdr(lst2609);if (true!==false) {var result2613 = result2608;var result2614 = same_p2600(key_item2605,prev2610);var result2612 = M4.values(result2614);if (true!==false) {var if_res3314 = M4.not($rjs_core.attachProcedureArity(function(...x26153313) {var x2615 = $rjs_core.Pair.listFromArray(x26153313);return result2612;})(prev2610));} else {var if_res3314 = false;}if (if_res3314!==false) {var if_res3315 = M4.not(false);} else {var if_res3315 = false;}if (if_res3315!==false) {_result26083822 = result2612;_lst26093823 = rest2611;continue lambda_start3821;} else {return result2612;}} else {return result2608;}} else {return result2608;}}};if (for_loop2607(false,lst2606)!==false) {return M4.car(items2603);} else {_items26033824 = M4.cdr(items2603);_sofar26043825 = M4.cons(key_item2605,sofar2604);continue lambda_start3820;}} else {return fail_k2601();}}};return loop2602(items2598,M4.rnull);};var check_filter_arguments = function(who2616, f2617, l2618, ls2619) {if (M4.procedure_p(f2617)!==false) {var if_res3321 = M4.rvoid();} else {var if_res3321 = M4.apply(M4.raise_argument_error,who2616,$rjs_core.UString.make("procedure?"),0,f2617,l2618,ls2619);}if_res3321;if (M4.procedure_arity_includes_p(f2617,M4.add1(M4.length(ls2619)))!==false) {var if_res3322 = M4.rvoid();} else {var if_res3322 = M4.raise_arguments_error(who2616,$rjs_core.UString.make("mismatch between procedure arity and argument count"),$rjs_core.UString.make("procedure"),f2617,$rjs_core.UString.make("expected arity"),M4.add1(M4.length(ls2619)));}if_res3322;if (M4.list_p(l2618)!==false) {var if_res3323 = M2.andmap(M4.list_p,ls2619);} else {var if_res3323 = false;}if (if_res3323!==false) {return M4.rvoid();} else {var let_result3324 = M7.__rjs_quoted__.make_sequence($rjs_core.Pair.makeList($rjs_core.PrimitiveSymbol.make("x")),M4.cons(l2618,ls2619));var pos__gt_vals2620 = let_result3324.getAt(0);var pos_pre_inc2621 = let_result3324.getAt(1);var pos_next2622 = let_result3324.getAt(2);var init2623 = let_result3324.getAt(3);var pos_cont_p2624 = let_result3324.getAt(4);var val_cont_p2625 = let_result3324.getAt(5);var all_cont_p2626 = let_result3324.getAt(6);var start2627 = 0;if (M4.rvoid()!==false) {if (M4.variable_reference_from_unsafe_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res3325 = M4.rvoid();} else {var if_res3325 = M7.__rjs_quoted__.check_naturals(start2627);}var if_res3326 = if_res3325;} else {var if_res3326 = false;}if_res3326;var for_loop2628 = function(_pos26293829, _pos26303830) {lambda_start3827:while (true){let pos2629 = _pos26293829;let pos2630 = _pos26303830;if (pos_cont_p2624!==false) {var if_res3327 = pos_cont_p2624(pos2629);} else {var if_res3327 = true;}if (if_res3327!==false) {var if_res3328 = true;} else {var if_res3328 = false;}if (if_res3328!==false) {var x2635 = pos__gt_vals2620(pos2629);if (all_cont_p2626!==false) {var if_res3329 = function(pos2636) {return all_cont_p2626(pos2636,x2635);};} else {var if_res3329 = false;}var let_result3330 = M4.values(x2635,if_res3329);var x2631 = let_result3330.getAt(0);var all_cont_p_by_pos2632 = let_result3330.getAt(1);if (pos_pre_inc2621!==false) {var if_res3331 = pos_pre_inc2621(pos2629);} else {var if_res3331 = pos2629;}var pos2633 = if_res3331;var i2634 = pos2630;if (val_cont_p2625!==false) {var if_res3332 = val_cont_p2625(x2631);} else {var if_res3332 = true;}if (if_res3332!==false) {var if_res3333 = true;} else {var if_res3333 = false;}if (if_res3333!==false) {if (M4.list_p(x2631)!==false) {var if_res3334 = M4.rvoid();} else {var if_res3334 = M4.apply(M4.raise_argument_error,who2616,$rjs_core.UString.make("list?"),M4.add1(i2634),f2617,l2618,ls2619);}if_res3334;var let_result3335 = M4.values();var let_result3336 = M4.values();if (all_cont_p_by_pos2632!==false) {var if_res3337 = all_cont_p_by_pos2632(pos2633);} else {var if_res3337 = true;}if (if_res3337!==false) {var if_res3338 = true;} else {var if_res3338 = false;}if (if_res3338!==false) {var if_res3339 = M4.not(false);} else {var if_res3339 = false;}if (if_res3339!==false) {_pos26293829 = pos_next2622(pos2633);_pos26303830 = pos2630+1;continue lambda_start3827;} else {return M4.values();}} else {return M4.values();}} else {return M4.values();}}};for_loop2628(init2623,start2627);return M4.rvoid();}};var filter_map = $rjs_core.attachProcedureArity(function(f2637, l2638, ...ls26393344) {var ls2639 = $rjs_core.Pair.listFromArray(ls26393344);check_filter_arguments($rjs_core.PrimitiveSymbol.make("filter-map"),f2637,l2638,ls2639);if (M4.pair_p(ls2639)!==false) {var len2640 = M4.length(l2638);if (M2.andmap(function(l2641) {return M4.__eq_(len2640,M4.length(l2641));},ls2639)!==false) {var loop2642 = function(_l26433834, _ls26443835) {lambda_start3833:while (true){let l2643 = _l26433834;let ls2644 = _ls26443835;if (M4.null_p(l2643)!==false) {return M4.rnull;} else {var x2645 = M4.apply(f2637,M4.car(l2643),M2.map(M4.car,ls2644));if (x2645!==false) {return M4.cons(x2645,loop2642(M4.cdr(l2643),M2.map(M4.cdr,ls2644)));} else {_l26433834 = M4.cdr(l2643);_ls26443835 = M2.map(M4.cdr,ls2644);continue lambda_start3833;}}}};return loop2642(l2638,ls2639);} else {return M4.raise_arguments_error($rjs_core.PrimitiveSymbol.make("filter-map"),$rjs_core.UString.make("all lists must have same size"));}} else {var loop2646 = function(_l26473837) {lambda_start3836:while (true){let l2647 = _l26473837;if (M4.null_p(l2647)!==false) {return M4.rnull;} else {var x2648 = f2637(M4.car(l2647));if (x2648!==false) {return M4.cons(x2648,loop2646(M4.cdr(l2647)));} else {_l26473837 = M4.cdr(l2647);continue lambda_start3836;}}}};return loop2646(l2638);}});var count = $rjs_core.attachProcedureArity(function(f2649, l2650, ...ls26513351) {var ls2651 = $rjs_core.Pair.listFromArray(ls26513351);check_filter_arguments($rjs_core.PrimitiveSymbol.make("count"),f2649,l2650,ls2651);if (M4.pair_p(ls2651)!==false) {var len2652 = M4.length(l2650);if (M2.andmap(function(l2653) {return M4.__eq_(len2652,M4.length(l2653));},ls2651)!==false) {var loop2654 = function(_l26553841, _ls26563842, _c26573843) {lambda_start3840:while (true){let l2655 = _l26553841;let ls2656 = _ls26563842;let c2657 = _c26573843;if (M4.null_p(l2655)!==false) {return c2657;} else {var temp3354 = M4.cdr(l2655);var temp3353 = M2.map(M4.cdr,ls2656);if (M4.apply(f2649,M4.car(l2655),M2.map(M4.car,ls2656))!==false) {var if_res3352 = M4.add1(c2657);} else {var if_res3352 = c2657;}_l26553841 = temp3354;_ls26563842 = temp3353;_c26573843 = if_res3352;continue lambda_start3840;}}};return loop2654(l2650,ls2651,0);} else {return M4.raise_arguments_error($rjs_core.PrimitiveSymbol.make("count"),$rjs_core.UString.make("all lists must have same size"));}} else {var loop2658 = function(_l26593845, _c26603846) {lambda_start3844:while (true){let l2659 = _l26593845;let c2660 = _c26603846;if (M4.null_p(l2659)!==false) {return c2660;} else {var temp3358 = M4.cdr(l2659);if (f2649(M4.car(l2659))!==false) {var if_res3357 = M4.add1(c2660);} else {var if_res3357 = c2660;}_l26593845 = temp3358;_c26603846 = if_res3357;continue lambda_start3844;}}};return loop2658(l2650,0);}});var partition = function(pred2661, l2662) {if (M4.procedure_p(pred2661)!==false) {var if_res3361 = M4.procedure_arity_includes_p(pred2661,1);} else {var if_res3361 = false;}if (if_res3361!==false) {var if_res3362 = M4.rvoid();} else {var if_res3362 = M4.raise_argument_error($rjs_core.PrimitiveSymbol.make("partition"),$rjs_core.UString.make("(any/c . -> . any/c)"),0,pred2661,l2662);}if_res3362;if (M4.list_p(l2662)!==false) {var if_res3363 = M4.rvoid();} else {var if_res3363 = M4.raise_argument_error($rjs_core.PrimitiveSymbol.make("partition"),$rjs_core.UString.make("list?"),1,pred2661,l2662);}if_res3363;var loop2663 = function(_l26643849, _i26653850, _o26663851) {lambda_start3848:while (true){let l2664 = _l26643849;let i2665 = _i26653850;let o2666 = _o26663851;if (M4.null_p(l2664)!==false) {return M4.values(M1.alt_reverse(i2665),M1.alt_reverse(o2666));} else {var x2667 = M4.car(l2664);var l2668 = M4.cdr(l2664);if (pred2661(x2667)!==false) {_l26643849 = l2668;_i26653850 = M4.cons(x2667,i2665);_o26663851 = o2666;continue lambda_start3848;} else {_l26643849 = l2668;_i26653850 = i2665;_o26663851 = M4.cons(x2667,o2666);continue lambda_start3848;}}}};return loop2663(l2662,$rjs_core.Pair.EMPTY,$rjs_core.Pair.EMPTY);};var cl3366 = function(end2670) {var start2671 = 0;var end2672 = end2670;var inc2673 = 1;if (M4.variable_reference_from_unsafe_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res3370 = M4.rvoid();} else {var if_res3370 = M7.__rjs_quoted__.check_range(start2671,end2672,inc2673);}if_res3370;var for_loop2674 = function(_fold_var26753854, _pos26763855) {lambda_start3853:while (true){let fold_var2675 = _fold_var26753854;let pos2676 = _pos26763855;if (M4.__lt_(pos2676,end2672)!==false) {var i2677 = pos2676;if (true!==false) {var fold_var2679 = fold_var2675;var fold_var2680 = M4.cons(i2677,fold_var2679);var fold_var2678 = M4.values(fold_var2680);if (true!==false) {var if_res3371 = M4.not(false);} else {var if_res3371 = false;}if (if_res3371!==false) {_fold_var26753854 = fold_var2678;_pos26763855 = pos2676+inc2673;continue lambda_start3853;} else {return fold_var2678;}} else {return fold_var2675;}} else {return fold_var2675;}}};return M1.alt_reverse(for_loop2674(M4.rnull,start2671));};var cl3367 = function(start2681, end2682) {var start2683 = start2681;var end2684 = end2682;var inc2685 = 1;if (M4.variable_reference_from_unsafe_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res3375 = M4.rvoid();} else {var if_res3375 = M7.__rjs_quoted__.check_range(start2683,end2684,inc2685);}if_res3375;var for_loop2686 = function(_fold_var26873858, _pos26883859) {lambda_start3857:while (true){let fold_var2687 = _fold_var26873858;let pos2688 = _pos26883859;if (M4.__lt_(pos2688,end2684)!==false) {var i2689 = pos2688;if (true!==false) {var fold_var2691 = fold_var2687;var fold_var2692 = M4.cons(i2689,fold_var2691);var fold_var2690 = M4.values(fold_var2692);if (true!==false) {var if_res3376 = M4.not(false);} else {var if_res3376 = false;}if (if_res3376!==false) {_fold_var26873858 = fold_var2690;_pos26883859 = pos2688+inc2685;continue lambda_start3857;} else {return fold_var2690;}} else {return fold_var2687;}} else {return fold_var2687;}}};return M1.alt_reverse(for_loop2686(M4.rnull,start2683));};var cl3368 = function(start2693, end2694, step2695) {var start2696 = start2693;var end2697 = end2694;var inc2698 = step2695;if (M4.variable_reference_from_unsafe_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res3380 = M4.rvoid();} else {var if_res3380 = M7.__rjs_quoted__.check_range(start2696,end2697,inc2698);}if_res3380;var for_loop2699 = function(_fold_var27003862, _pos27013863) {lambda_start3861:while (true){let fold_var2700 = _fold_var27003862;let pos2701 = _pos27013863;if (M4.__gt__eq_(step2695,0)!==false) {var if_res3381 = M4.__lt_(pos2701,end2697);} else {var if_res3381 = M4.__gt_(pos2701,end2697);}if (if_res3381!==false) {var i2702 = pos2701;if (true!==false) {var fold_var2704 = fold_var2700;var fold_var2705 = M4.cons(i2702,fold_var2704);var fold_var2703 = M4.values(fold_var2705);if (true!==false) {var if_res3382 = M4.not(false);} else {var if_res3382 = false;}if (if_res3382!==false) {_fold_var27003862 = fold_var2703;_pos27013863 = pos2701+inc2698;continue lambda_start3861;} else {return fold_var2703;}} else {return fold_var2700;}} else {return fold_var2700;}}};return M1.alt_reverse(for_loop2699(M4.rnull,start2696));};var range2669 = $rjs_core.attachProcedureArity(function() {var fixed_lam3369 = {'1':cl3366,'2':cl3367,'3':cl3368}[arguments.length];if (fixed_lam3369!==undefined) {return fixed_lam3369.apply(null,arguments);} else {return M4.error($rjs_core.UString.make("case-lambda: invalid case"));}},[1,2,3]);var range_proc = range2669;var cl3386 = function(start2707, end2708) {var start2709 = start2707;var end2710 = end2708;var inc2711 = 1;if (M4.variable_reference_from_unsafe_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res3389 = M4.rvoid();} else {var if_res3389 = M7.__rjs_quoted__.check_range_generic($rjs_core.PrimitiveSymbol.make("in-inclusive-range"),start2709,end2710,inc2711);}if_res3389;var for_loop2712 = function(_fold_var27133867, _pos27143868) {lambda_start3866:while (true){let fold_var2713 = _fold_var27133867;let pos2714 = _pos27143868;if (M4.__lt__eq_(pos2714,end2710)!==false) {var i2715 = pos2714;if (true!==false) {var fold_var2717 = fold_var2713;var fold_var2718 = M4.cons(i2715,fold_var2717);var fold_var2716 = M4.values(fold_var2718);if (true!==false) {var if_res3390 = M4.not(false);} else {var if_res3390 = false;}if (if_res3390!==false) {_fold_var27133867 = fold_var2716;_pos27143868 = pos2714+inc2711;continue lambda_start3866;} else {return fold_var2716;}} else {return fold_var2713;}} else {return fold_var2713;}}};return M1.alt_reverse(for_loop2712(M4.rnull,start2709));};var cl3387 = function(start2719, end2720, step2721) {var start2722 = start2719;var end2723 = end2720;var inc2724 = step2721;if (M4.variable_reference_from_unsafe_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res3394 = M4.rvoid();} else {var if_res3394 = M7.__rjs_quoted__.check_range_generic($rjs_core.PrimitiveSymbol.make("in-inclusive-range"),start2722,end2723,inc2724);}if_res3394;var for_loop2725 = function(_fold_var27263871, _pos27273872) {lambda_start3870:while (true){let fold_var2726 = _fold_var27263871;let pos2727 = _pos27273872;if (M4.__gt__eq_(step2721,0)!==false) {var if_res3395 = M4.__lt__eq_(pos2727,end2723);} else {var if_res3395 = M4.__gt__eq_(pos2727,end2723);}if (if_res3395!==false) {var i2728 = pos2727;if (true!==false) {var fold_var2730 = fold_var2726;var fold_var2731 = M4.cons(i2728,fold_var2730);var fold_var2729 = M4.values(fold_var2731);if (true!==false) {var if_res3396 = M4.not(false);} else {var if_res3396 = false;}if (if_res3396!==false) {_fold_var27263871 = fold_var2729;_pos27273872 = pos2727+inc2724;continue lambda_start3870;} else {return fold_var2729;}} else {return fold_var2726;}} else {return fold_var2726;}}};return M1.alt_reverse(for_loop2725(M4.rnull,start2722));};var inclusive_range2706 = $rjs_core.attachProcedureArity(function() {var fixed_lam3388 = {'2':cl3386,'3':cl3387}[arguments.length];if (fixed_lam3388!==undefined) {return fixed_lam3388.apply(null,arguments);} else {return M4.error($rjs_core.UString.make("case-lambda: invalid case"));}},[2,3]);var inclusive_range_proc = inclusive_range2706;var cl3400 = function(f2732, l2733) {return M4.apply(M4.append,M2.map(f2732,l2733));};var cl3401 = function(f2734, l12735, l22736) {return M4.apply(M4.append,M2.map(f2734,l12735,l22736));};var cl3402 = $rjs_core.attachProcedureArity(function(f2737, l2738, ...ls27393405) {var ls2739 = $rjs_core.Pair.listFromArray(ls27393405);return M4.apply(M4.append,M4.apply(M2.map,f2737,l2738,ls2739));});var append_map = $rjs_core.attachProcedureArity(function() {var fixed_lam3403 = {'2':cl3400,'3':cl3401}[arguments.length];if (fixed_lam3403!==undefined) {return fixed_lam3403.apply(null,arguments);} else if (M4.__gt__eq_(cl3402.length,1)!==false) {return cl3402.apply(null,arguments);} else {return M4.error($rjs_core.UString.make("case-lambda: invalid case"));}},[M4.make_arity_at_least(2)]);var filter_not = function(f2740, list2741) {if (M4.procedure_p(f2740)!==false) {var if_res3406 = M4.procedure_arity_includes_p(f2740,1);} else {var if_res3406 = false;}if (if_res3406!==false) {var if_res3407 = M4.rvoid();} else {var if_res3407 = M4.raise_argument_error($rjs_core.PrimitiveSymbol.make("filter-not"),$rjs_core.UString.make("(any/c . -> . any/c)"),0,f2740,list2741);}if_res3407;if (M4.list_p(list2741)!==false) {var if_res3408 = M4.rvoid();} else {var if_res3408 = M4.raise_argument_error($rjs_core.PrimitiveSymbol.make("filter-not"),$rjs_core.UString.make("list?"),1,f2740,list2741);}if_res3408;var loop2742 = function(_l27433880, _result27443881) {lambda_start3879:while (true){let l2743 = _l27433880;let result2744 = _result27443881;if (M4.null_p(l2743)!==false) {return M1.alt_reverse(result2744);} else {var temp3410 = M4.cdr(l2743);if (f2740(M4.car(l2743))!==false) {var if_res3409 = result2744;} else {var if_res3409 = M4.cons(M4.car(l2743),result2744);}_l27433880 = temp3410;_result27443881 = if_res3409;continue lambda_start3879;}}};return loop2742(list2741,M4.rnull);};var shuffle = function(l2745) {if (M4.list_p(l2745)!==false) {var if_res3412 = M4.rvoid();} else {var if_res3412 = M4.raise_argument_error($rjs_core.PrimitiveSymbol.make("shuffle"),$rjs_core.UString.make("list?"),0,l2745);}if_res3412;var let_result3413 = M4.values();var a2746 = M4.make_vector(M4.length(l2745));var lst2747 = l2745;var start2748 = 0;if (M4.variable_reference_from_unsafe_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res3414 = M4.rvoid();} else {var if_res3414 = M7.__rjs_quoted__.check_list(lst2747);}if_res3414;if (M4.variable_reference_from_unsafe_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res3415 = M4.rvoid();} else {var if_res3415 = M7.__rjs_quoted__.check_naturals(start2748);}if_res3415;var for_loop2749 = function(_lst27503884, _pos27513885) {lambda_start3883:while (true){let lst2750 = _lst27503884;let pos2751 = _pos27513885;if (M4.pair_p(lst2750)!==false) {var if_res3416 = true;} else {var if_res3416 = false;}if (if_res3416!==false) {var x2752 = M10.unsafe_car(lst2750);var rest2753 = M10.unsafe_cdr(lst2750);var i2754 = pos2751;if (true!==false) {var if_res3417 = true;} else {var if_res3417 = false;}if (if_res3417!==false) {var j2755 = M0.random(M4.add1(i2754));if (M4.__eq_(j2755,i2754)!==false) {var if_res3418 = M4.rvoid();} else {var if_res3418 = M4.vector_set_bang_(a2746,i2754,M4.vector_ref(a2746,j2755));}if_res3418;M4.vector_set_bang_(a2746,j2755,x2752);var let_result3419 = M4.values();var let_result3420 = M4.values();if (true!==false) {if (true!==false) {var if_res3421 = M4.not(false);} else {var if_res3421 = false;}var if_res3422 = if_res3421;} else {var if_res3422 = false;}if (if_res3422!==false) {_lst27503884 = rest2753;_pos27513885 = pos2751+1;continue lambda_start3883;} else {return M4.values();}} else {return M4.values();}} else {return M4.values();}}};for_loop2749(lst2747,start2748);M4.rvoid();return M4.vector__gt_list(a2746);};var combinations2756 = function(l372757, k362758) {var l2759 = l372757;if (false!==false) {var if_res3426 = false;} else {var if_res3426 = k362758;}var k2760 = if_res3426;var let_result3427 = M7.__rjs_quoted__.make_sequence($rjs_core.Pair.makeList($rjs_core.PrimitiveSymbol.make("x")),in_combinations(l2759,k2760));var pos__gt_vals2761 = let_result3427.getAt(0);var pos_pre_inc2762 = let_result3427.getAt(1);var pos_next2763 = let_result3427.getAt(2);var init2764 = let_result3427.getAt(3);var pos_cont_p2765 = let_result3427.getAt(4);var val_cont_p2766 = let_result3427.getAt(5);var all_cont_p2767 = let_result3427.getAt(6);M4.rvoid();var for_loop2768 = function(_fold_var27693889, _pos27703890) {lambda_start3887:while (true){let fold_var2769 = _fold_var27693889;let pos2770 = _pos27703890;if (pos_cont_p2765!==false) {var if_res3428 = pos_cont_p2765(pos2770);} else {var if_res3428 = true;}if (if_res3428!==false) {var x2774 = pos__gt_vals2761(pos2770);if (all_cont_p2767!==false) {var if_res3429 = function(pos2775) {return all_cont_p2767(pos2775,x2774);};} else {var if_res3429 = false;}var let_result3430 = M4.values(x2774,if_res3429);var x2771 = let_result3430.getAt(0);var all_cont_p_by_pos2772 = let_result3430.getAt(1);if (pos_pre_inc2762!==false) {var if_res3431 = pos_pre_inc2762(pos2770);} else {var if_res3431 = pos2770;}var pos2773 = if_res3431;if (val_cont_p2766!==false) {var if_res3432 = val_cont_p2766(x2771);} else {var if_res3432 = true;}if (if_res3432!==false) {var fold_var2777 = fold_var2769;var fold_var2778 = M4.cons(x2771,fold_var2777);var fold_var2776 = M4.values(fold_var2778);if (all_cont_p_by_pos2772!==false) {var if_res3433 = all_cont_p_by_pos2772(pos2773);} else {var if_res3433 = true;}if (if_res3433!==false) {var if_res3434 = M4.not(false);} else {var if_res3434 = false;}if (if_res3434!==false) {_fold_var27693889 = fold_var2776;_pos27703890 = pos_next2763(pos2773);continue lambda_start3887;} else {return fold_var2776;}} else {return fold_var2769;}} else {return fold_var2769;}}};return M1.alt_reverse(for_loop2768(M4.rnull,init2764));};var cl3438 = function(l2779) {return combinations2756(l2779,false);};var cl3439 = function(l2780, k362781) {return combinations2756(l2780,k362781);};var combinations = $rjs_core.attachProcedureArity(function() {var fixed_lam3440 = {'1':cl3438,'2':cl3439}[arguments.length];if (fixed_lam3440!==undefined) {return fixed_lam3440.apply(null,arguments);} else {return M4.error($rjs_core.UString.make("case-lambda: invalid case"));}},[1,2]);var in_combinations2782 = function(l392783, k382784) {var l2785 = l392783;if (false!==false) {var if_res3441 = false;} else {var if_res3441 = k382784;}var k2786 = if_res3441;if (M4.list_p(l2785)!==false) {var if_res3442 = M4.rvoid();} else {var if_res3442 = M4.raise_argument_error($rjs_core.PrimitiveSymbol.make("in-combinations"),$rjs_core.UString.make("list?"),0,l2785);}if_res3442;var let_result3443 = M4.values();if (k2786!==false) {var if_res3444 = M4.not(M4.exact_nonnegative_integer_p(k2786));} else {var if_res3444 = false;}if (if_res3444!==false) {var if_res3445 = M4.raise_argument_error($rjs_core.PrimitiveSymbol.make("in-combinations"),$rjs_core.UString.make("exact-nonnegative-integer?"),1,l2785,k2786);} else {var if_res3445 = M4.rvoid();}if_res3445;var let_result3446 = M4.values();var v2787 = M4.list__gt_vector(l2785);var N2788 = M4.vector_length(v2787);var N_12789 = N2788-1;if (M4.not(k2786)!==false) {var limit2791 = M4.expt(2,N2788);var curr_box2792 = M4.box(0);var if_res3483 = function() {var curr2793 = M4.unbox(curr_box2792);if (M4.__lt_(curr2793,limit2791)!==false) {var start2794 = N_12789;var end2795 = -1;var inc2796 = -1;if (M4.variable_reference_from_unsafe_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res3448 = M4.rvoid();} else {var if_res3448 = M7.__rjs_quoted__.check_range(start2794,end2795,inc2796);}if_res3448;var for_loop2797 = function(_acc27983897, _pos27993898) {lambda_start3896:while (true){let acc2798 = _acc27983897;let pos2799 = _pos27993898;if (M4.__gt_(pos2799,end2795)!==false) {var i2800 = pos2799;if (true!==false) {var acc2802 = acc2798;if (M4.bitwise_bit_set_p(curr2793,i2800)!==false) {var if_res3449 = M4.cons(M4.vector_ref(v2787,i2800),acc2802);} else {var if_res3449 = acc2802;}var acc2803 = if_res3449;var acc2801 = M4.values(acc2803);if (true!==false) {var if_res3450 = M4.not(false);} else {var if_res3450 = false;}if (if_res3450!==false) {_acc27983897 = acc2801;_pos27993898 = pos2799+inc2796;continue lambda_start3896;} else {return acc2801;}} else {return acc2798;}} else {return acc2798;}}};var begin_res3447 = for_loop2797($rjs_core.Pair.EMPTY,start2794);M4.set_box_bang_(curr_box2792,curr2793+1);return begin_res3447;} else {return false;}};} else {if (M4.__lt_(N2788,k2786)!==false) {var if_res3482 = function() {return false;};} else {var running_p2804 = true;var k_times_2805 = M8.build_vector(k2786,function(i2806) {return i2806;});var k_12807 = k2786-1;var if_res3482 = function() {if (running_p2804!==false) {var vec2810 = k_times_2805;M7.__rjs_quoted__.check_vector(vec2810);var let_result3456 = M4.values(vec2810,M10.unsafe_vector_length(vec2810));var vec2808 = let_result3456.getAt(0);var len2809 = let_result3456.getAt(1);false;var for_loop2811 = function(_fold_var28123903, _pos28133904) {lambda_start3902:while (true){let fold_var2812 = _fold_var28123903;let pos2813 = _pos28133904;if (M10.unsafe_fx_lt_(pos2813,len2809)!==false) {var i2814 = M10.unsafe_vector_ref(vec2808,pos2813);if (true!==false) {var fold_var2816 = fold_var2812;var fold_var2817 = M4.cons(M4.vector_ref(v2787,i2814),fold_var2816);var fold_var2815 = M4.values(fold_var2817);if (true!==false) {var if_res3457 = M4.not(false);} else {var if_res3457 = false;}if (if_res3457!==false) {_fold_var28123903 = fold_var2815;_pos28133904 = M10.unsafe_fx_plus_(1,pos2813);continue lambda_start3902;} else {return fold_var2815;}} else {return fold_var2812;}} else {return fold_var2812;}}};var begin_res3455 = M1.alt_reverse(for_loop2811(M4.rnull,0));var index_to_change2818 = false;var start2819 = k_12807;var end2820 = -1;var inc2821 = -1;if (M4.variable_reference_from_unsafe_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res3461 = M4.rvoid();} else {var if_res3461 = M7.__rjs_quoted__.check_range(start2819,end2820,inc2821);}if_res3461;var for_loop2822 = function(pos2823) {if (M4.__gt_(pos2823,end2820)!==false) {var i2824 = pos2823;if (true!==false) {var next_k_proc2825 = function() {if (true!==false) {return for_loop2822(pos2823+inc2821);} else {return M4.values();}};if (M4.not(M4.eq_p(M4.vector_ref(k_times_2805,i2824),i2824+N2788+M4.__(k2786)))!==false) {index_to_change2818 = i2824;var if_res3463 = true;} else {var if_res3463 = false;}if (if_res3463!==false) {return M4.values();} else {M4.rvoid();var let_result3464 = M4.values();if (false!==false) {return M4.values();} else {return next_k_proc2825();}}} else {return M4.values();}} else {return M4.values();}};for_loop2822(start2819);M4.rvoid();if (index_to_change2818!==false) {var val_to_change2826 = M4.add1(M4.vector_ref(k_times_2805,index_to_change2818));var start2827 = index_to_change2818;var end2828 = k2786;var inc2829 = 1;var start2830 = val_to_change2826;if (M4.variable_reference_from_unsafe_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res3469 = M4.rvoid();} else {var if_res3469 = M7.__rjs_quoted__.check_range(start2827,end2828,inc2829);}if_res3469;if (M4.variable_reference_from_unsafe_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res3470 = M4.rvoid();} else {var if_res3470 = M7.__rjs_quoted__.check_naturals(start2830);}if_res3470;var for_loop2831 = function(_pos28323908, _pos28333909) {lambda_start3907:while (true){let pos2832 = _pos28323908;let pos2833 = _pos28333909;if (M4.__lt_(pos2832,end2828)!==false) {var if_res3471 = true;} else {var if_res3471 = false;}if (if_res3471!==false) {var i2834 = pos2832;var v2835 = pos2833;if (true!==false) {var if_res3472 = true;} else {var if_res3472 = false;}if (if_res3472!==false) {M4.vector_set_bang_(k_times_2805,i2834,v2835);var let_result3473 = M4.values();var let_result3474 = M4.values();if (true!==false) {if (true!==false) {var if_res3475 = M4.not(false);} else {var if_res3475 = false;}var if_res3476 = if_res3475;} else {var if_res3476 = false;}if (if_res3476!==false) {_pos28323908 = pos2832+inc2829;_pos28333909 = pos2833+1;continue lambda_start3907;} else {return M4.values();}} else {return M4.values();}} else {return M4.values();}}};for_loop2831(start2827,start2830);var if_res3480 = M4.rvoid();} else {running_p2804 = false;var if_res3480 = null;}if_res3480;return begin_res3455;} else {return false;}};}var if_res3483 = if_res3482;}var gen_combinations2790 = if_res3483;return M7.__rjs_quoted__.in_producer(gen_combinations2790,false);};var cl3484 = function(l2836) {return in_combinations2782(l2836,false);};var cl3485 = function(l2837, k382838) {return in_combinations2782(l2837,k382838);};var in_combinations = $rjs_core.attachProcedureArity(function() {var fixed_lam3486 = {'1':cl3484,'2':cl3485}[arguments.length];if (fixed_lam3486!==undefined) {return fixed_lam3486.apply(null,arguments);} else {return M4.error($rjs_core.UString.make("case-lambda: invalid case"));}},[1,2]);var swap_plus_flip = function(l2839, i2840, j2841) {var tmp2842 = j2841;if (M4.equal_p(tmp2842,0)!==false) {return M4.list_times_(M4.cadr(l2839),M4.car(l2839),M4.cddr(l2839));} else if (M4.equal_p(tmp2842,1)!==false) {var a2843 = M4.car(l2839);var b2844 = M4.cadr(l2839);var c2845 = M4.caddr(l2839);var l2846 = M4.cdddr(l2839);var tmp2847 = i2840;if (M4.equal_p(tmp2847,0)!==false) {return M4.list_times_(b2844,c2845,a2843,l2846);} else {return M4.list_times_(c2845,a2843,b2844,l2846);}} else if (M4.equal_p(tmp2842,2)!==false) {var a2848 = M4.car(l2839);var b2849 = M4.cadr(l2839);var c2850 = M4.caddr(l2839);var d2851 = M4.cadddr(l2839);var l2852 = M4.cddddr(l2839);var tmp2853 = i2840;if (M4.equal_p(tmp2853,0)!==false) {return M4.list_times_(c2850,b2849,d2851,a2848,l2852);} else if (M4.equal_p(tmp2853,1)!==false) {return M4.list_times_(c2850,d2851,a2848,b2849,l2852);} else {return M4.list_times_(d2851,b2849,a2848,c2850,l2852);}} else {var loop2854 = function(_n28553915, _l128563916, _r128573917) {lambda_start3914:while (true){let n2855 = _n28553915;let l12856 = _l128563916;let r12857 = _r128573917;if (M4.__gt_(n2855,0)!==false) {_n28553915 = M4.sub1(n2855);_l128563916 = M4.cons(M4.car(r12857),l12856);_r128573917 = M4.cdr(r12857);continue lambda_start3914;} else {var loop2858 = function(_n28593919, _l228603920, _r228613921) {lambda_start3918:while (true){let n2859 = _n28593919;let l22860 = _l228603920;let r22861 = _r228613921;if (M4.__gt_(n2859,0)!==false) {_n28593919 = M4.sub1(n2859);_l228603920 = M4.cons(M4.car(r22861),l22860);_r228613921 = M4.cdr(r22861);continue lambda_start3918;} else {return M3.__rjs_quoted__.qq_append(l22860,M4.list_times_(M4.car(r22861),M3.__rjs_quoted__.qq_append(l12856,M4.list_times_(M4.car(r12857),M4.cdr(r22861)))));}}};return loop2858(j2841-i2840,$rjs_core.Pair.EMPTY,M4.cdr(r12857));}}};return loop2854(i2840,$rjs_core.Pair.EMPTY,l2839);}};var permutations = function(l2862) {if (M4.not(M4.list_p(l2862))!==false) {return M4.raise_argument_error($rjs_core.PrimitiveSymbol.make("permutations"),$rjs_core.UString.make("list?"),0,l2862);} else {var or_part2863 = M4.null_p(l2862);if (or_part2863!==false) {var if_res3495 = or_part2863;} else {var if_res3495 = M4.null_p(M4.cdr(l2862));}if (if_res3495!==false) {return M4.list(l2862);} else {var N2864 = M4.length(l2862)-2;if (M4.__gt_(N2864,254)!==false) {var if_res3496 = M4.error($rjs_core.PrimitiveSymbol.make("permutations"),$rjs_core.UString.make("input list too long: ~e"),l2862);} else {var if_res3496 = M4.rvoid();}if_res3496;var let_result3497 = M4.values();var c2865 = M4.make_bytes(M4.add1(N2864),0);var loop2866 = function(_i28673924, _acc28683925) {lambda_start3923:while (true){let i2867 = _i28673924;let acc2868 = _acc28683925;var ci2869 = M4.bytes_ref(c2865,i2867);if (M4.__lt__eq_(ci2869,i2867)!==false) {M4.bytes_set_bang_(c2865,i2867,M4.add1(ci2869));_i28673924 = 0;_acc28683925 = M4.cons(swap_plus_flip(M4.car(acc2868),ci2869,i2867),acc2868);continue lambda_start3923;} else if (M4.__lt_(i2867,N2864)!==false) {M4.bytes_set_bang_(c2865,i2867,0);_i28673924 = M4.add1(i2867);_acc28683925 = acc2868;continue lambda_start3923;} else {return acc2868;}}};return loop2866(0,M4.list(M1.alt_reverse(l2862)));}}};var in_permutations = function(l2870) {if (M4.not(M4.list_p(l2870))!==false) {return M4.raise_argument_error($rjs_core.PrimitiveSymbol.make("in-permutations"),$rjs_core.UString.make("list?"),0,l2870);} else {var or_part2871 = M4.null_p(l2870);if (or_part2871!==false) {var if_res3502 = or_part2871;} else {var if_res3502 = M4.null_p(M4.cdr(l2870));}if (if_res3502!==false) {return M7.__rjs_quoted__.in_value(l2870);} else {var N2872 = M4.length(l2870)-2;if (M4.__gt_(N2872,254)!==false) {var if_res3503 = M4.error($rjs_core.PrimitiveSymbol.make("permutations"),$rjs_core.UString.make("input list too long: ~e"),l2870);} else {var if_res3503 = M4.rvoid();}if_res3503;var let_result3504 = M4.values();var c2873 = M4.make_bytes(M4.add1(N2872),0);var i2874 = 0;var cur2875 = M1.alt_reverse(l2870);var next2876 = function() {lambda_start3927:while (true){var r2877 = cur2875;var ci2878 = M4.bytes_ref(c2873,i2874);if (M4.__lt__eq_(ci2878,i2874)!==false) {M4.bytes_set_bang_(c2873,i2874,M4.add1(ci2878));var begin_res3505 = swap_plus_flip(cur2875,ci2878,i2874);i2874 = 0;return begin_res3505;} else if (M4.__lt_(i2874,N2872)!==false) {M4.bytes_set_bang_(c2873,i2874,0);i2874 = M4.add1(i2874);continue lambda_start3927;} else {return false;}}};return M7.__rjs_quoted__.in_producer(function() {var begin_res3508 = cur2875;cur2875 = next2876();return begin_res3508;},false);}}};var mk_min = function(cmp2879, name2880, f2881, xs2882) {if (M4.procedure_p(f2881)!==false) {var if_res3511 = M4.procedure_arity_includes_p(f2881,1);} else {var if_res3511 = false;}if (if_res3511!==false) {var if_res3512 = M4.rvoid();} else {var if_res3512 = M4.raise_argument_error(name2880,$rjs_core.UString.make("(any/c . -> . real?)"),0,f2881,xs2882);}if_res3512;if (M4.list_p(xs2882)!==false) {var if_res3513 = M4.pair_p(xs2882);} else {var if_res3513 = false;}if (if_res3513!==false) {var if_res3514 = M4.rvoid();} else {var if_res3514 = M4.raise_argument_error(name2880,$rjs_core.UString.make("(and/c list? (not/c empty?))"),1,f2881,xs2882);}if_res3514;var init_min_var2883 = f2881(M4.car(xs2882));if (M4.real_p(init_min_var2883)!==false) {var if_res3515 = M4.rvoid();} else {var if_res3515 = M4.raise_result_error(name2880,$rjs_core.UString.make("real?"),init_min_var2883);}if_res3515;var loop2884 = function(_min28853931, _min_var28863932, _xs28873933) {lambda_start3930:while (true){let min2885 = _min28853931;let min_var2886 = _min_var28863932;let xs2887 = _xs28873933;if (M4.null_p(xs2887)!==false) {return min2885;} else {var new_min2888 = f2881(M4.car(xs2887));if (M4.real_p(new_min2888)!==false) {var if_res3516 = M4.rvoid();} else {var if_res3516 = M4.raise_result_error(name2880,$rjs_core.UString.make("real?"),new_min2888);}if_res3516;if (cmp2879(new_min2888,min_var2886)!==false) {_min28853931 = M4.car(xs2887);_min_var28863932 = new_min2888;_xs28873933 = M4.cdr(xs2887);continue lambda_start3930;} else {_min28853931 = min2885;_min_var28863932 = min_var2886;_xs28873933 = M4.cdr(xs2887);continue lambda_start3930;}}}};return loop2884(M4.car(xs2882),init_min_var2883,M4.cdr(xs2882));};var argmin = function(f2889, xs2890) {return mk_min(M4.__lt_,$rjs_core.PrimitiveSymbol.make("argmin"),f2889,xs2890);};var argmax = function(f2891, xs2892) {return mk_min(M4.__gt_,$rjs_core.PrimitiveSymbol.make("argmax"),f2891,xs2892);};var group_by2893 = function(key412894, l422895, __eq__p402896) {var key2897 = key412894;var l2898 = l422895;if (M4.eq_p(__eq__p402896,M10.unsafe_undefined)!==false) {var if_res3519 = M4.equal_p;} else {var if_res3519 = __eq__p402896;}var __eq__p2899 = if_res3519;if (M4.procedure_p(key2897)!==false) {var if_res3520 = M4.procedure_arity_includes_p(key2897,1);} else {var if_res3520 = false;}if (if_res3520!==false) {var if_res3521 = M4.rvoid();} else {var if_res3521 = M4.raise_argument_error($rjs_core.PrimitiveSymbol.make("group-by"),$rjs_core.UString.make("(-> any/c any/c)"),0,key2897,l2898);}if_res3521;var let_result3522 = M4.values();if (M4.procedure_p(__eq__p2899)!==false) {var if_res3523 = M4.procedure_arity_includes_p(__eq__p2899,2);} else {var if_res3523 = false;}if (if_res3523!==false) {var if_res3524 = M4.rvoid();} else {var if_res3524 = M4.raise_argument_error($rjs_core.PrimitiveSymbol.make("group-by"),$rjs_core.UString.make("(any/c any/c . -> . any/c)"),2,key2897,l2898,__eq__p2899);}if_res3524;var let_result3525 = M4.values();if (M4.list_p(l2898)!==false) {var if_res3526 = M4.rvoid();} else {var if_res3526 = M4.raise_argument_error($rjs_core.PrimitiveSymbol.make("group-by"),$rjs_core.UString.make("list?"),1,key2897,l2898);}if_res3526;var let_result3527 = M4.values();var alist_update2900 = function(al2901, k2902, up2903, fail2904) {var loop2905 = function(al2906) {if (M4.null_p(al2906)!==false) {return M4.list(M4.cons(k2902,up2903($rjs_core.Pair.EMPTY)));} else if (__eq__p2899(M4.car(M4.car(al2906)),k2902)!==false) {return M4.cons(M4.cons(k2902,up2903(M4.cdr(M4.car(al2906)))),M4.cdr(al2906));} else {return M4.cons(M4.car(al2906),loop2905(M4.cdr(al2906)));}};return loop2905(al2901);};if (M4.equal_p(__eq__p2899,M4.eq_p)!==false) {var if_res3532 = M4.values(M4.hasheq(),M5.hash_update);} else {if (M4.equal_p(__eq__p2899,M4.eqv_p)!==false) {var if_res3531 = M4.values(M4.hasheqv(),M5.hash_update);} else {if (M4.equal_p(__eq__p2899,M4.equal_p)!==false) {var if_res3530 = M4.values(M4.hash(),M5.hash_update);} else {var if_res3530 = M4.values($rjs_core.Pair.EMPTY,alist_update2900);}var if_res3531 = if_res3530;}var if_res3532 = if_res3531;}var let_result3533 = if_res3532;var base2907 = let_result3533.getAt(0);var update2908 = let_result3533.getAt(1);var lst2910 = l2898;var start2911 = 0;if (M4.variable_reference_from_unsafe_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res3534 = M4.rvoid();} else {var if_res3534 = M7.__rjs_quoted__.check_list(lst2910);}if_res3534;if (M4.variable_reference_from_unsafe_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res3535 = M4.rvoid();} else {var if_res3535 = M7.__rjs_quoted__.check_naturals(start2911);}if_res3535;var for_loop2912 = function(_res29133941, _lst29143942, _pos29153943) {lambda_start3939:while (true){let res2913 = _res29133941;let lst2914 = _lst29143942;let pos2915 = _pos29153943;if (M4.pair_p(lst2914)!==false) {var if_res3536 = true;} else {var if_res3536 = false;}if (if_res3536!==false) {var elt2916 = M10.unsafe_car(lst2914);var rest2917 = M10.unsafe_cdr(lst2914);var idx2918 = pos2915;if (true!==false) {var if_res3537 = true;} else {var if_res3537 = false;}if (if_res3537!==false) {var res2920 = res2913;var k2922 = key2897(elt2916);var v2923 = M4.cons(idx2918,elt2916);var res2921 = update2908(res2920,k2922,function(o2924) {return M4.cons(v2923,o2924);},$rjs_core.Pair.EMPTY);var res2919 = M4.values(res2921);if (true!==false) {if (true!==false) {var if_res3538 = M4.not(false);} else {var if_res3538 = false;}var if_res3539 = if_res3538;} else {var if_res3539 = false;}if (if_res3539!==false) {_res29133941 = res2919;_lst29143942 = rest2917;_pos29153943 = pos2915+1;continue lambda_start3939;} else {return res2919;}} else {return res2913;}} else {return res2913;}}};var classes2909 = for_loop2912(base2907,lst2910,start2911);if (M4.list_p(classes2909)!==false) {var lst2926 = classes2909;if (M4.variable_reference_from_unsafe_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res3543 = M4.rvoid();} else {var if_res3543 = M7.__rjs_quoted__.check_list(lst2926);}if_res3543;var for_loop2927 = function(_fold_var29283945, _lst29293946) {lambda_start3944:while (true){let fold_var2928 = _fold_var29283945;let lst2929 = _lst29293946;if (M4.pair_p(lst2929)!==false) {var p2930 = M10.unsafe_car(lst2929);var rest2931 = M10.unsafe_cdr(lst2929);if (true!==false) {var fold_var2933 = fold_var2928;var __dot__dot__dot_ects_by_racket_by_list_dot_rkt__338852935 = M8.__rjs_quoted__.sort7;var temp532936 = M4.cdr(p2930);var __lt_542937 = M4.__lt_;var car552938 = M4.car;if (M4.variable_reference_constant_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res3544 = M8.__rjs_quoted__.sort(false,car552938,temp532936,__lt_542937);} else {var if_res3544 = M4.checked_procedure_check_and_extract(M9.__rjs_quoted__.struct_keyword_procedure,__dot__dot__dot_ects_by_racket_by_list_dot_rkt__338852935,M9.__rjs_quoted__.keyword_procedure_extract,$rjs_core.Pair.makeList($rjs_core.Keyword.make("key")),4)($rjs_core.Pair.makeList($rjs_core.Keyword.make("key")),M4.list(car552938),temp532936,__lt_542937);}var fold_var2934 = M4.cons(if_res3544,fold_var2933);var fold_var2932 = M4.values(fold_var2934);if (true!==false) {var if_res3545 = M4.not(false);} else {var if_res3545 = false;}if (if_res3545!==false) {_fold_var29283945 = fold_var2932;_lst29293946 = rest2931;continue lambda_start3944;} else {return fold_var2932;}} else {return fold_var2928;}} else {return fold_var2928;}}};var if_res3556 = M1.alt_reverse(for_loop2927(M4.rnull,lst2926));} else {var ht2939 = classes2909;if (M4.variable_reference_from_unsafe_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res3549 = M4.rvoid();} else {var if_res3549 = M7.__rjs_quoted__.check_in_hash(ht2939);}if_res3549;var for_loop2940 = function(_fold_var29413948, _i29423949) {lambda_start3947:while (true){let fold_var2941 = _fold_var29413948;let i2942 = _i29423949;if (i2942!==false) {var let_result3550 = M4.hash_iterate_key_plus_value(ht2939,i2942);var _2943 = let_result3550.getAt(0);var c2944 = let_result3550.getAt(1);if (true!==false) {var fold_var2946 = fold_var2941;var __dot__dot__dot_ects_by_racket_by_list_dot_rkt__339692948 = M8.__rjs_quoted__.sort7;var c562949 = c2944;var __lt_572950 = M4.__lt_;var car582951 = M4.car;if (M4.variable_reference_constant_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res3551 = M8.__rjs_quoted__.sort(false,car582951,c562949,__lt_572950);} else {var if_res3551 = M4.checked_procedure_check_and_extract(M9.__rjs_quoted__.struct_keyword_procedure,__dot__dot__dot_ects_by_racket_by_list_dot_rkt__339692948,M9.__rjs_quoted__.keyword_procedure_extract,$rjs_core.Pair.makeList($rjs_core.Keyword.make("key")),4)($rjs_core.Pair.makeList($rjs_core.Keyword.make("key")),M4.list(car582951),c562949,__lt_572950);}var fold_var2947 = M4.cons(if_res3551,fold_var2946);var fold_var2945 = M4.values(fold_var2947);if (true!==false) {var if_res3552 = M4.not(false);} else {var if_res3552 = false;}if (if_res3552!==false) {_fold_var29413948 = fold_var2945;_i29423949 = M4.hash_iterate_next(ht2939,i2942);continue lambda_start3947;} else {return fold_var2945;}} else {return fold_var2941;}} else {return fold_var2941;}}};var if_res3556 = M1.alt_reverse(for_loop2940(M4.rnull,M4.hash_iterate_first(ht2939)));}var sorted_classes2925 = if_res3556;var __dot__dot__dot_ects_by_racket_by_list_dot_rkt__340862953 = M8.__rjs_quoted__.sort7;var sorted_classes592954 = sorted_classes2925;var __lt_602955 = M4.__lt_;var caar612956 = M4.caar;if (M4.variable_reference_constant_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res3557 = M8.__rjs_quoted__.sort(false,caar612956,sorted_classes592954,__lt_602955);} else {var if_res3557 = M4.checked_procedure_check_and_extract(M9.__rjs_quoted__.struct_keyword_procedure,__dot__dot__dot_ects_by_racket_by_list_dot_rkt__340862953,M9.__rjs_quoted__.keyword_procedure_extract,$rjs_core.Pair.makeList($rjs_core.Keyword.make("key")),4)($rjs_core.Pair.makeList($rjs_core.Keyword.make("key")),M4.list(caar612956),sorted_classes592954,__lt_602955);}var lst2952 = if_res3557;if (M4.variable_reference_from_unsafe_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res3558 = M4.rvoid();} else {var if_res3558 = M7.__rjs_quoted__.check_list(lst2952);}if_res3558;var for_loop2957 = function(_fold_var29583951, _lst29593952) {lambda_start3950:while (true){let fold_var2958 = _fold_var29583951;let lst2959 = _lst29593952;if (M4.pair_p(lst2959)!==false) {var c2960 = M10.unsafe_car(lst2959);var rest2961 = M10.unsafe_cdr(lst2959);if (true!==false) {var fold_var2963 = fold_var2958;var fold_var2964 = M4.cons(M2.map(M4.cdr,c2960),fold_var2963);var fold_var2962 = M4.values(fold_var2964);if (true!==false) {var if_res3559 = M4.not(false);} else {var if_res3559 = false;}if (if_res3559!==false) {_fold_var29583951 = fold_var2962;_lst29593952 = rest2961;continue lambda_start3950;} else {return fold_var2962;}} else {return fold_var2958;}} else {return fold_var2958;}}};return M1.alt_reverse(for_loop2957(M4.rnull,lst2952));};var cl3563 = function(key2965, l2966) {return group_by2893(key2965,l2966,M10.unsafe_undefined);};var cl3564 = function(key2967, l2968, __eq__p402969) {return group_by2893(key2967,l2968,__eq__p402969);};var group_by = $rjs_core.attachProcedureArity(function() {var fixed_lam3565 = {'2':cl3563,'3':cl3564}[arguments.length];if (fixed_lam3565!==undefined) {return fixed_lam3565.apply(null,arguments);} else {return M4.error($rjs_core.UString.make("case-lambda: invalid case"));}},[2,3]);var cartesian_product = $rjs_core.attachProcedureArity(function(...ls29703566) {var ls2970 = $rjs_core.Pair.listFromArray(ls29703566);var let_result3567 = M7.__rjs_quoted__.make_sequence($rjs_core.Pair.makeList($rjs_core.PrimitiveSymbol.make("l")),ls2970);var pos__gt_vals2971 = let_result3567.getAt(0);var pos_pre_inc2972 = let_result3567.getAt(1);var pos_next2973 = let_result3567.getAt(2);var init2974 = let_result3567.getAt(3);var pos_cont_p2975 = let_result3567.getAt(4);var val_cont_p2976 = let_result3567.getAt(5);var all_cont_p2977 = let_result3567.getAt(6);var start2978 = 0;if (M4.rvoid()!==false) {if (M4.variable_reference_from_unsafe_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res3568 = M4.rvoid();} else {var if_res3568 = M7.__rjs_quoted__.check_naturals(start2978);}var if_res3569 = if_res3568;} else {var if_res3569 = false;}if_res3569;var for_loop2979 = function(_pos29803959, _pos29813960) {lambda_start3957:while (true){let pos2980 = _pos29803959;let pos2981 = _pos29813960;if (pos_cont_p2975!==false) {var if_res3570 = pos_cont_p2975(pos2980);} else {var if_res3570 = true;}if (if_res3570!==false) {var if_res3571 = true;} else {var if_res3571 = false;}if (if_res3571!==false) {var l2986 = pos__gt_vals2971(pos2980);if (all_cont_p2977!==false) {var if_res3572 = function(pos2987) {return all_cont_p2977(pos2987,l2986);};} else {var if_res3572 = false;}var let_result3573 = M4.values(l2986,if_res3572);var l2982 = let_result3573.getAt(0);var all_cont_p_by_pos2983 = let_result3573.getAt(1);if (pos_pre_inc2972!==false) {var if_res3574 = pos_pre_inc2972(pos2980);} else {var if_res3574 = pos2980;}var pos2984 = if_res3574;var i2985 = pos2981;if (val_cont_p2976!==false) {var if_res3575 = val_cont_p2976(l2982);} else {var if_res3575 = true;}if (if_res3575!==false) {var if_res3576 = true;} else {var if_res3576 = false;}if (if_res3576!==false) {if (M4.list_p(l2982)!==false) {var if_res3577 = M4.rvoid();} else {var if_res3577 = M4.apply(M4.raise_argument_error,$rjs_core.PrimitiveSymbol.make("cartesian-product"),$rjs_core.UString.make("list?"),i2985,ls2970);}if_res3577;var let_result3578 = M4.values();var let_result3579 = M4.values();if (all_cont_p_by_pos2983!==false) {var if_res3580 = all_cont_p_by_pos2983(pos2984);} else {var if_res3580 = true;}if (if_res3580!==false) {var if_res3581 = true;} else {var if_res3581 = false;}if (if_res3581!==false) {var if_res3582 = M4.not(false);} else {var if_res3582 = false;}if (if_res3582!==false) {_pos29803959 = pos_next2973(pos2984);_pos29813960 = pos2981+1;continue lambda_start3957;} else {return M4.values();}} else {return M4.values();}} else {return M4.values();}}};for_loop2979(init2974,start2978);var let_result3586 = M4.values();M4.rvoid();var let_result3587 = M4.values();var cp_22988 = function(as2989, bs2990) {var lst2991 = as2989;if (M4.variable_reference_from_unsafe_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res3588 = M4.rvoid();} else {var if_res3588 = M7.__rjs_quoted__.check_list(lst2991);}if_res3588;var for_loop2992 = function(_fold_var29933966, _lst29943967) {lambda_start3962:while (true){let fold_var2993 = _fold_var29933966;let lst2994 = _lst29943967;if (M4.pair_p(lst2994)!==false) {var i2995 = M10.unsafe_car(lst2994);var rest2996 = M10.unsafe_cdr(lst2994);if (true!==false) {var fold_var2998 = fold_var2993;if (true!==false) {var lst2999 = bs2990;if (M4.variable_reference_from_unsafe_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res3589 = M4.rvoid();} else {var if_res3589 = M7.__rjs_quoted__.check_list(lst2999);}if_res3589;var for_loop3000 = function(_fold_var30013964, _lst30023965) {lambda_start3963:while (true){let fold_var3001 = _fold_var30013964;let lst3002 = _lst30023965;if (M4.pair_p(lst3002)!==false) {var j3003 = M10.unsafe_car(lst3002);var rest3004 = M10.unsafe_cdr(lst3002);if (true!==false) {var fold_var3006 = fold_var3001;if (true!==false) {var fold_var3007 = fold_var3006;var fold_var3008 = M4.cons(M4.cons(i2995,j3003),fold_var3007);var if_res3590 = M4.values(fold_var3008);} else {var if_res3590 = fold_var3006;}var fold_var3005 = if_res3590;if (true!==false) {var if_res3591 = M4.not(false);} else {var if_res3591 = false;}if (if_res3591!==false) {_fold_var30013964 = fold_var3005;_lst30023965 = rest3004;continue lambda_start3963;} else {return fold_var3005;}} else {return fold_var3001;}} else {return fold_var3001;}}};var if_res3595 = for_loop3000(fold_var2998,lst2999);} else {var if_res3595 = fold_var2998;}var fold_var2997 = if_res3595;if (true!==false) {var if_res3596 = M4.not(false);} else {var if_res3596 = false;}if (if_res3596!==false) {_fold_var29933966 = fold_var2997;_lst29943967 = rest2996;continue lambda_start3962;} else {return fold_var2997;}} else {return fold_var2993;}} else {return fold_var2993;}}};return M1.alt_reverse(for_loop2992(M4.rnull,lst2991));};return M8.foldr(cp_22988,M4.list(M4.list()),ls2970);});var remf = function(f3009, ls3010) {if (M4.list_p(ls3010)!==false) {var if_res3600 = M4.rvoid();} else {var if_res3600 = M4.raise_argument_error($rjs_core.PrimitiveSymbol.make("remf"),$rjs_core.UString.make("list?"),1,f3009,ls3010);}if_res3600;if (M4.procedure_p(f3009)!==false) {var if_res3601 = M4.procedure_arity_includes_p(f3009,1);} else {var if_res3601 = false;}if (if_res3601!==false) {var if_res3602 = M4.rvoid();} else {var if_res3602 = M4.raise_argument_error($rjs_core.PrimitiveSymbol.make("remf"),$rjs_core.UString.make("(-> any/c any/c)"),0,f3009,ls3010);}if_res3602;if (M4.null_p(ls3010)!==false) {return $rjs_core.Pair.EMPTY;} else if (f3009(M4.car(ls3010))!==false) {return M4.cdr(ls3010);} else {return M4.cons(M4.car(ls3010),remf(f3009,M4.cdr(ls3010)));}};var remf_times_ = function(_f30113970, _ls30123971) {lambda_start3969:while (true){let f3011 = _f30113970;let ls3012 = _ls30123971;if (M4.list_p(ls3012)!==false) {var if_res3605 = M4.rvoid();} else {var if_res3605 = M4.raise_argument_error($rjs_core.PrimitiveSymbol.make("remf*"),$rjs_core.UString.make("list?"),1,f3011,ls3012);}if_res3605;if (M4.procedure_p(f3011)!==false) {var if_res3606 = M4.procedure_arity_includes_p(f3011,1);} else {var if_res3606 = false;}if (if_res3606!==false) {var if_res3607 = M4.rvoid();} else {var if_res3607 = M4.raise_argument_error($rjs_core.PrimitiveSymbol.make("remf*"),$rjs_core.UString.make("(-> any/c any/c)"),0,f3011,ls3012);}if_res3607;if (M4.null_p(ls3012)!==false) {return $rjs_core.Pair.EMPTY;} else if (f3011(M4.car(ls3012))!==false) {_f30113970 = f3011;_ls30123971 = M4.cdr(ls3012);continue lambda_start3969;} else {return M4.cons(M4.car(ls3012),remf_times_(f3011,M4.cdr(ls3012)));}}};var index_of3013 = function(ls443014, v453015, __eq__p433016) {var ls3017 = ls443014;var v3018 = v453015;if (M4.eq_p(__eq__p433016,M10.unsafe_undefined)!==false) {var if_res3610 = M4.equal_p;} else {var if_res3610 = __eq__p433016;}var __eq__p3019 = if_res3610;if (M4.list_p(ls3017)!==false) {var if_res3611 = M4.rvoid();} else {var if_res3611 = M4.raise_argument_error($rjs_core.PrimitiveSymbol.make("index-of"),$rjs_core.UString.make("list?"),0,ls3017,v3018);}if_res3611;if (M4.procedure_p(__eq__p3019)!==false) {var if_res3612 = M4.procedure_arity_includes_p(__eq__p3019,2);} else {var if_res3612 = false;}if (if_res3612!==false) {var if_res3613 = M4.rvoid();} else {var if_res3613 = M4.raise_argument_error($rjs_core.PrimitiveSymbol.make("index-of"),$rjs_core.UString.make("(-> any/c any/c any/c)"),2,ls3017,v3018,__eq__p3019);}if_res3613;var loop3020 = function(_ls30213974, _i30223975) {lambda_start3973:while (true){let ls3021 = _ls30213974;let i3022 = _i30223975;if (M4.null_p(ls3021)!==false) {return false;} else if (__eq__p3019(M4.car(ls3021),v3018)!==false) {return i3022;} else {_ls30213974 = M4.cdr(ls3021);_i30223975 = M4.add1(i3022);continue lambda_start3973;}}};return loop3020(ls3017,0);};var cl3616 = function(ls3023, v3024) {return index_of3013(ls3023,v3024,M10.unsafe_undefined);};var cl3617 = function(ls3025, v3026, __eq__p433027) {return index_of3013(ls3025,v3026,__eq__p433027);};var index_of = $rjs_core.attachProcedureArity(function() {var fixed_lam3618 = {'2':cl3616,'3':cl3617}[arguments.length];if (fixed_lam3618!==undefined) {return fixed_lam3618.apply(null,arguments);} else {return M4.error($rjs_core.UString.make("case-lambda: invalid case"));}},[2,3]);var index_where = function(ls3028, f3029) {if (M4.list_p(ls3028)!==false) {var if_res3619 = M4.rvoid();} else {var if_res3619 = M4.raise_argument_error($rjs_core.PrimitiveSymbol.make("index-where"),$rjs_core.UString.make("list?"),0,ls3028,f3029);}if_res3619;if (M4.procedure_p(f3029)!==false) {var if_res3620 = M4.procedure_arity_includes_p(f3029,1);} else {var if_res3620 = false;}if (if_res3620!==false) {var if_res3621 = M4.rvoid();} else {var if_res3621 = M4.raise_argument_error($rjs_core.PrimitiveSymbol.make("index-where"),$rjs_core.UString.make("(-> any/c any/c)"),1,ls3028,f3029);}if_res3621;var loop3030 = function(_ls30313981, _i30323982) {lambda_start3980:while (true){let ls3031 = _ls30313981;let i3032 = _i30323982;if (M4.null_p(ls3031)!==false) {return false;} else if (f3029(M4.car(ls3031))!==false) {return i3032;} else {_ls30313981 = M4.cdr(ls3031);_i30323982 = M4.add1(i3032);continue lambda_start3980;}}};return loop3030(ls3028,0);};var indexes_of3033 = function(ls473034, v483035, __eq__p463036) {var ls3037 = ls473034;var v3038 = v483035;if (M4.eq_p(__eq__p463036,M10.unsafe_undefined)!==false) {var if_res3624 = M4.equal_p;} else {var if_res3624 = __eq__p463036;}var __eq__p3039 = if_res3624;if (M4.list_p(ls3037)!==false) {var if_res3625 = M4.rvoid();} else {var if_res3625 = M4.raise_argument_error($rjs_core.PrimitiveSymbol.make("indexes-of"),$rjs_core.UString.make("list?"),0,ls3037,v3038);}if_res3625;if (M4.procedure_p(__eq__p3039)!==false) {var if_res3626 = M4.procedure_arity_includes_p(__eq__p3039,2);} else {var if_res3626 = false;}if (if_res3626!==false) {var if_res3627 = M4.rvoid();} else {var if_res3627 = M4.raise_argument_error($rjs_core.PrimitiveSymbol.make("indexes-of"),$rjs_core.UString.make("(-> any/c any/c any/c)"),2,ls3037,v3038,__eq__p3039);}if_res3627;var loop3040 = function(_ls30413985, _i30423986) {lambda_start3984:while (true){let ls3041 = _ls30413985;let i3042 = _i30423986;if (M4.null_p(ls3041)!==false) {return $rjs_core.Pair.EMPTY;} else if (__eq__p3039(M4.car(ls3041),v3038)!==false) {return M4.cons(i3042,loop3040(M4.cdr(ls3041),M4.add1(i3042)));} else {_ls30413985 = M4.cdr(ls3041);_i30423986 = M4.add1(i3042);continue lambda_start3984;}}};return loop3040(ls3037,0);};var cl3630 = function(ls3043, v3044) {return indexes_of3033(ls3043,v3044,M10.unsafe_undefined);};var cl3631 = function(ls3045, v3046, __eq__p463047) {return indexes_of3033(ls3045,v3046,__eq__p463047);};var indexes_of = $rjs_core.attachProcedureArity(function() {var fixed_lam3632 = {'2':cl3630,'3':cl3631}[arguments.length];if (fixed_lam3632!==undefined) {return fixed_lam3632.apply(null,arguments);} else {return M4.error($rjs_core.UString.make("case-lambda: invalid case"));}},[2,3]);var indexes_where = function(ls3048, f3049) {if (M4.list_p(ls3048)!==false) {var if_res3633 = M4.rvoid();} else {var if_res3633 = M4.raise_argument_error($rjs_core.PrimitiveSymbol.make("indexes-where"),$rjs_core.UString.make("list?"),0,ls3048,f3049);}if_res3633;if (M4.procedure_p(f3049)!==false) {var if_res3634 = M4.procedure_arity_includes_p(f3049,1);} else {var if_res3634 = false;}if (if_res3634!==false) {var if_res3635 = M4.rvoid();} else {var if_res3635 = M4.raise_argument_error($rjs_core.PrimitiveSymbol.make("indexes-where"),$rjs_core.UString.make("(-> any/c any/c)"),1,ls3048,f3049);}if_res3635;var loop3050 = function(_ls30513992, _i30523993) {lambda_start3991:while (true){let ls3051 = _ls30513992;let i3052 = _i30523993;if (M4.null_p(ls3051)!==false) {return $rjs_core.Pair.EMPTY;} else if (f3049(M4.car(ls3051))!==false) {return M4.cons(i3052,loop3050(M4.cdr(ls3051),M4.add1(i3052)));} else {_ls30513992 = M4.cdr(ls3051);_i30523993 = M4.add1(i3052);continue lambda_start3991;}}};return loop3050(ls3048,0);};var __rjs_quoted__ = {};__rjs_quoted__.remove_duplicates28 = remove_duplicates28;__rjs_quoted__.add_between = add_between;__rjs_quoted__.check_duplicates = check_duplicates;__rjs_quoted__.range_proc = range_proc;__rjs_quoted__.remove_duplicates = remove_duplicates;__rjs_quoted__.inclusive_range_proc = inclusive_range_proc;__rjs_quoted__.add_between23 = add_between23;__rjs_quoted__.check_duplicates35 = check_duplicates35;export { __rjs_quoted__,remf_times_,remf,cartesian_product,group_by,argmax,argmin,in_permutations,permutations,in_combinations,combinations,shuffle,filter_not,append_map,partition,count,filter_map,check_duplicates,remove_duplicates,add_between,flatten,append_times_,drop_common_prefix,take_common_prefix,split_common_prefix,list_prefix_p,splitf_at_right,dropf_right,takef_right,split_at_right,take_right,drop_right,splitf_at,dropf,takef,split_at,take,drop,indexes_where,indexes_of,index_where,index_of,list_set,list_update,make_list,empty,rest,last,last_pair,tenth,ninth,eighth,seventh,sixth,fifth,fourth,third,second,first };