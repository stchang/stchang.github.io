import * as $rjs_core from '../runtime/core.js';import * as M0 from "../collects/racket/list.rkt.js";import * as M1 from "../collects/racket/match/runtime.rkt.js";import * as M2 from "../runtime/kernel.rkt.js";import * as M3 from "../collects/racket/private/pre-base.rkt.js";import * as M4 from "../collects/racket/private/kw.rkt.js";import * as M5 from "../links/racketscript-extras/racketscript/htdp/private/color.rkt.js";import * as M6 from "../collects/racket/private/list.rkt.js";import * as M7 from "../links/racketscript-extras/racketscript/htdp/image.rkt.js";import * as M8 from "../collects/racket/private/list-predicates.rkt.js";import * as M9 from "../links/racketscript-extras/racketscript/htdp/universe.rkt.js";import * as M10 from "../collects/racket/private/modbeg.rkt.js";import * as M11 from "../runtime/unsafe.rkt.js";var LEFT_EDGE = 0;var RIGHT_EDGE = 400;var TOP_EDGE = 0;var BOTTOM_EDGE = 400;var EMPTY_SCENE = M7.rectangle(RIGHT_EDGE,BOTTOM_EDGE,$rjs_core.UString.make("outline"),$rjs_core.UString.make("gray"));var MIN_RADIUS = 8;var MAX_RADIUS = 48;var BALL_RADIUS = 40;var IMG = M7.circle(BALL_RADIUS,$rjs_core.UString.make("solid"),$rjs_core.UString.make("blue"));var BALL_WIDTH = M7.image_width(IMG);var random_x = function() {return M3.random(LEFT_EDGE+MAX_RADIUS,RIGHT_EDGE-MAX_RADIUS);};var random_y = function() {return M3.random(LEFT_EDGE+MAX_RADIUS,RIGHT_EDGE-MAX_RADIUS);};var MAX_VELOCITY = 10;var random_velocity = function() {return M3.random(MAX_VELOCITY);};var let_result1 = M2.make_struct_type($rjs_core.PrimitiveSymbol.make("ball"),false,6,0,false,M2.rnull,M2.current_inspector(),false,$rjs_core.Pair.makeList(0,1,2,3,4,5),false,$rjs_core.PrimitiveSymbol.make("ball"));var struct_2 = let_result1.getAt(0);var make_3 = let_result1.getAt(1);var __p4 = let_result1.getAt(2);var __ref5 = let_result1.getAt(3);var __set_bang_6 = let_result1.getAt(4);var let_result2 = M2.values(struct_2,make_3,__p4,M2.make_struct_field_accessor(__ref5,0,$rjs_core.PrimitiveSymbol.make("x")),M2.make_struct_field_accessor(__ref5,1,$rjs_core.PrimitiveSymbol.make("y")),M2.make_struct_field_accessor(__ref5,2,$rjs_core.PrimitiveSymbol.make("xvel")),M2.make_struct_field_accessor(__ref5,3,$rjs_core.PrimitiveSymbol.make("yvel")),M2.make_struct_field_accessor(__ref5,4,$rjs_core.PrimitiveSymbol.make("radius")),M2.make_struct_field_accessor(__ref5,5,$rjs_core.PrimitiveSymbol.make("color")));var struct_ball = let_result2.getAt(0);var ball1 = let_result2.getAt(1);var ball_p = let_result2.getAt(2);var ball_x = let_result2.getAt(3);var ball_y = let_result2.getAt(4);var ball_xvel = let_result2.getAt(5);var ball_yvel = let_result2.getAt(6);var ball_radius = let_result2.getAt(7);var ball_color = let_result2.getAt(8);var random_ball = function(radius27, x48, y59) {if (M2.eq_p(x48,M11.unsafe_undefined)!==false) {var if_res3 = random_x();} else {var if_res3 = x48;}var x10 = if_res3;if (M2.eq_p(y59,M11.unsafe_undefined)!==false) {var if_res4 = random_y();} else {var if_res4 = y59;}var y11 = if_res4;if (M2.eq_p(radius27,M11.unsafe_undefined)!==false) {var if_res5 = random_radius();} else {var if_res5 = radius27;}var r12 = if_res5;return ball1(x10,y11,random_velocity(),random_velocity(),r12,random_color());};var random_ball1 = function(given_kws13, given_args14, x415, y516) {var radius317 = M2.pair_p(given_kws13);if (radius317!==false) {var if_res6 = M2.car(given_args14);} else {var if_res6 = M11.unsafe_undefined;}var radius218 = if_res6;return random_ball(radius218,x415,y516);};var cl12 = function(given_kws23, given_args24) {return random_ball1(given_kws23,given_args24,M11.unsafe_undefined,M11.unsafe_undefined);};var cl13 = function(given_kws25, given_args26, x27, y528) {return random_ball1(given_kws25,given_args26,x27,y528);};var cl14 = function(given_kws29, given_args30, x431) {return random_ball1(given_kws29,given_args30,x431,M11.unsafe_undefined);};var temp16 = $rjs_core.attachProcedureArity(function() {var fixed_lam15 = {'2':cl12,'4':cl13,'3':cl14}[arguments.length];if (fixed_lam15!==undefined) {return fixed_lam15.apply(null,arguments);} else {return M2.error($rjs_core.UString.make("case-lambda: invalid case"));}},[2,3,4]);var temp11 = $rjs_core.Pair.makeList($rjs_core.Keyword.make("radius"));var cl7 = function() {return random_ball1(M2.rnull,M2.rnull,M11.unsafe_undefined,M11.unsafe_undefined);};var cl8 = function(x32, y533) {return random_ball1(M2.rnull,M2.rnull,x32,y533);};var cl9 = function(x434) {return random_ball1(M2.rnull,M2.rnull,x434,M11.unsafe_undefined);};var random_ball6 = M4.__rjs_quoted__.make_optional_keyword_procedure(function(given_kws19, given_argc20) {if (M2.__gt__eq_(given_argc20,2)!==false) {var if_res17 = M2.__lt__eq_(given_argc20,4);} else {var if_res17 = false;}if (if_res17!==false) {var l1419521 = given_kws19;if (M2.null_p(l1419521)!==false) {var if_res19 = l1419521;} else {if (M2.eq_p(M2.car(l1419521),$rjs_core.Keyword.make("radius"))!==false) {var if_res18 = M2.cdr(l1419521);} else {var if_res18 = l1419521;}var if_res19 = if_res18;}var l1419522 = if_res19;return M2.null_p(l1419522);} else {return false;}},temp16,M2.rnull,temp11,$rjs_core.attachProcedureArity(function() {var fixed_lam10 = {'0':cl7,'2':cl8,'1':cl9}[arguments.length];if (fixed_lam10!==undefined) {return fixed_lam10.apply(null,arguments);} else {return M2.error($rjs_core.UString.make("case-lambda: invalid case"));}},[0,1,2]));var random_color = function() {return M5.color(M3.random(255),M3.random(255),M3.random(255));};var random_radius = function() {return M3.random(8,BALL_RADIUS);};var ball_in_scene_by_x_p = function(b35) {return M2.__lt__eq_(LEFT_EDGE+ball_radius(b35),ball_x(b35),RIGHT_EDGE-ball_radius(b35));};var TESTING_RADIUS = random_radius();var ball_in_scene_by_y_p = function(b36) {return M2.__lt__eq_(TOP_EDGE+ball_radius(b36),ball_y(b36),BOTTOM_EDGE-ball_radius(b36));};var ball_in_scene_p = function(b37) {if (ball_in_scene_by_x_p(b37)!==false) {return ball_in_scene_by_y_p(b37);} else {return false;}};var render_world = function(w38) {if (M8.empty_p(w38)!==false) {return EMPTY_SCENE;} else {return place_ball(M0.first(w38),render_world(M0.rest(w38)));}};var place_ball = function(b39, scene40) {return M7.place_image(render_ball(b39),ball_x(b39),ball_y(b39),scene40);};var render_ball = function(b41) {return M7.circle(ball_radius(b41),$rjs_core.UString.make("solid"),ball_color(b41));};var next_world = function(w42) {if (M8.empty_p(w42)!==false) {return M0.empty;} else {return M2.cons(next_ball(M0.first(w42)),next_world(M0.rest(w42)));}};var next_ball = function(b43) {var temp850 = b43;var temp8951 = temp850;var fail1052 = function() {return M1.match_error(temp8951,M1.syntax_srclocs(null),$rjs_core.PrimitiveSymbol.make("match-define"));};if (ball_p(temp8951)!==false) {var temp1253 = (function(x59) {if (M2.variable_reference_constant_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res24 = M2.variable_reference_constant_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"));} else {var if_res24 = false;}if (if_res24!==false) {return M11.unsafe_struct_ref(x59,0);} else {return ball_x(x59);}})(temp8951);var temp1354 = (function(x60) {if (M2.variable_reference_constant_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res26 = M2.variable_reference_constant_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"));} else {var if_res26 = false;}if (if_res26!==false) {return M11.unsafe_struct_ref(x60,1);} else {return ball_y(x60);}})(temp8951);var temp1455 = (function(x61) {if (M2.variable_reference_constant_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res28 = M2.variable_reference_constant_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"));} else {var if_res28 = false;}if (if_res28!==false) {return M11.unsafe_struct_ref(x61,2);} else {return ball_xvel(x61);}})(temp8951);var temp1556 = (function(x62) {if (M2.variable_reference_constant_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res30 = M2.variable_reference_constant_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"));} else {var if_res30 = false;}if (if_res30!==false) {return M11.unsafe_struct_ref(x62,3);} else {return ball_yvel(x62);}})(temp8951);var temp1657 = (function(x63) {if (M2.variable_reference_constant_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res32 = M2.variable_reference_constant_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"));} else {var if_res32 = false;}if (if_res32!==false) {return M11.unsafe_struct_ref(x63,4);} else {return ball_radius(x63);}})(temp8951);var temp1758 = (function(x64) {if (M2.variable_reference_constant_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res34 = M2.variable_reference_constant_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"));} else {var if_res34 = false;}if (if_res34!==false) {return M11.unsafe_struct_ref(x64,5);} else {return ball_color(x64);}})(temp8951);var c65 = temp1758;var r66 = temp1657;var yvel67 = temp1556;var xvel68 = temp1455;var y69 = temp1354;var x70 = temp1253;var if_res36 = M2.values(x70,y69,xvel68,yvel67,r66,c65);} else {var if_res36 = fail1052();}var let_result37 = if_res36;var x44 = let_result37.getAt(0);var y45 = let_result37.getAt(1);var xvel46 = let_result37.getAt(2);var yvel47 = let_result37.getAt(3);var r48 = let_result37.getAt(4);var c49 = let_result37.getAt(5);if (ball_in_scene_by_x_p(b43)!==false) {var if_res38 = xvel46;} else {var if_res38 = M2.__(xvel46);}var new_xvel71 = if_res38;if (ball_in_scene_by_y_p(b43)!==false) {var if_res39 = yvel47;} else {var if_res39 = M2.__(yvel47);}var new_yvel72 = if_res39;var new_x73 = x44+new_xvel71;var new_y74 = y45+new_yvel72;return ball1(new_x73,new_y74,new_xvel71,new_yvel72,r48,c49);};var click_p = function(mevt75) {return M2.string_eq__p(mevt75,$rjs_core.UString.make("button-down"));};var leave_p = function(mevt76) {return M2.string_eq__p(mevt76,$rjs_core.UString.make("leave"));};var BALL_CLEAR_THRESHOLD = 20;var mouse_handler = function(w77, x78, y79, mevt80) {if (click_p(mevt80)!==false) {var x2682 = x78;var y2783 = y79;if (M2.variable_reference_constant_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res40 = random_ball(M11.unsafe_undefined,x2682,y2783);} else {var if_res40 = random_ball6(x2682,y2783);}var b81 = if_res40;if (ball_in_scene_p(b81)!==false) {return M2.cons(b81,w77);} else {return w77;}} else if (leave_p(mevt80)!==false) {return M6.filter(function(b84) {return M2.__lt_(ball_radius(b84),BALL_CLEAR_THRESHOLD);},w77);} else {return w77;}};M2.call_with_values(function() {if (M2.variable_reference_constant_p($rjs_core.PrimitiveSymbol.make("#%variable-reference"))!==false) {var if_res44 = random_ball(M11.unsafe_undefined,M11.unsafe_undefined,M11.unsafe_undefined);} else {var if_res44 = random_ball6();}return M9.big_bang(M2.list(if_res44),M9.on_mouse(mouse_handler),M9.on_tick(next_world),M9.to_draw(render_world));},M10.__rjs_quoted__.print_values);var __rjs_quoted__ = {};__rjs_quoted__.ball_color = ball_color;__rjs_quoted__.struct_ball = struct_ball;__rjs_quoted__.ball_y = ball_y;__rjs_quoted__.ball_x = ball_x;__rjs_quoted__.ball_p = ball_p;__rjs_quoted__.ball_yvel = ball_yvel;__rjs_quoted__.random_ball = random_ball;__rjs_quoted__.random_ball6 = random_ball6;__rjs_quoted__.ball_radius = ball_radius;__rjs_quoted__.ball_xvel = ball_xvel;__rjs_quoted__.ball1 = ball1;export { __rjs_quoted__ };