import * as $rjs_core from '../../../../runtime/core.js';import * as M0 from "../../../../collects/racket/private/map.rkt.js";import * as M1 from "../../../../runtime/kernel.rkt.js";import * as M2 from "../../../racketscript-compiler/racketscript/interop.rkt.js";import * as M3 from "./private/color.rkt.js";import * as M4 from "../../../racketscript-compiler/racketscript/private/interop.rkt.js";import * as M5 from "../private/jscommon.rkt.js";import * as M6 from "../../../../collects/racket/private/list.rkt.js";var let_result1631 = M1.make_struct_type($rjs_core.PrimitiveSymbol.make("posn"),false,2,0,false,M1.rnull,false,false,$rjs_core.Pair.makeList(0,1),false,$rjs_core.PrimitiveSymbol.make("posn"));var struct_1079 = let_result1631.getAt(0);var make_1080 = let_result1631.getAt(1);var __p1081 = let_result1631.getAt(2);var __ref1082 = let_result1631.getAt(3);var __set_bang_1083 = let_result1631.getAt(4);var let_result1632 = M1.values(struct_1079,make_1080,__p1081,M1.make_struct_field_accessor(__ref1082,0,$rjs_core.PrimitiveSymbol.make("x")),M1.make_struct_field_accessor(__ref1082,1,$rjs_core.PrimitiveSymbol.make("y")));var struct_posn = let_result1632.getAt(0);var make_posn = let_result1632.getAt(1);var posn_p = let_result1632.getAt(2);var posn_x = let_result1632.getAt(3);var posn_y = let_result1632.getAt(4);var ___gt_web_color = function(p1084) {if (M1.string_p(p1084)!==false) {return M3.string__gt_web_color(p1084);} else if (M3.color_p(p1084)!==false) {return M3.color__gt_web_color(p1084);} else if (M1.symbol_p(p1084)!==false) {return M3.string__gt_web_color(M1.symbol__gt_string(p1084));} else {return M1.error($rjs_core.PrimitiveSymbol.make("color"),$rjs_core.UString.make("invalid color"));}};var print_image = function(d1085) {var canvas1086 = M5.document.createElement("canvas");var ctx1087 = canvas1086.getContext("2d");M5.document.body.appendChild(canvas1086);M5.document.body.appendChild(M5.document.createElement("br"));canvas1086.width = d1085.width;canvas1086.height = d1085.height;ctx1087.save();ctx1087.translate(d1085.width/2,d1085.height/2);d1085.render(ctx1087,0,0);return ctx1087.restore();};var canvas1088 = M5.document.createElement("canvas");var __times_invisible_canvas_context_times_ = canvas1088.getContext("2d");var empty_image = {'type':$rjs_core.UString.make("empty-image"),'width':0,'height':0,'render':function(ctx1089, x1090, y1091) {return M1.rvoid();}};var image_height = function(i1092) {return i1092.height;};var image_width = function(i1093) {return i1093.width;};var Text = function(text1094, size1095, color1096, face1097, family1098, style1099, weight1100, underline_p1101) {var this1102 = this;this1102.type = $rjs_core.UString.make("text");this1102.text = text1094;this1102.size = size1095;this1102.color = ___gt_web_color(color1096);this1102.face = face1097;this1102.family = family1098;this1102.style = style1099;this1102.weight = weight1100;this1102.underline = underline_p1101;return this1102._updateMetrics();};Text.prototype._updateMetrics = function() {var this1103 = this;var font1104 = M1.string_append(this1103.weight,$rjs_core.UString.make(" "),this1103.style,$rjs_core.UString.make(" "),M1.number__gt_string(this1103.size),$rjs_core.UString.make("px "),this1103.face,$rjs_core.UString.make(" "),this1103.family);__times_invisible_canvas_context_times_.font = M2.js_string(font1104);var let_result1636 = M1.values();var metrics1105 = __times_invisible_canvas_context_times_.measureText(M2.js_string(this1103.text));this1103.font = font1104;this1103.width = metrics1105.width;this1103.height = this1103.size;return null;};Text.prototype.render = function(ctx1106, x1107, y1108) {var this1109 = this;ctx1106.save();ctx1106.translate(x1107,y1108);ctx1106.font = M2.js_string(this1109.font);ctx1106.textAlign = "center";ctx1106.textBaseline = "middle";ctx1106.fillStyle = M2.js_string(this1109.color);ctx1106.fillText(M2.js_string(this1109.text),0,0);return ctx1106.restore();};var Line = function(x1110, y1111, pen_or_color1112) {var this1113 = this;this1113.type = $rjs_core.UString.make("line");this1113.width = M5.abs_plus_ceil(x1110);this1113.height = M5.abs_plus_ceil(y1111);this1113.mode = false;this1113.pen = pen_or_color1112;return null;};Line.prototype.render = function(ctx1114, x1115, y1116) {var this1117 = this;ctx1114.save();var let_result1637 = M1.values();ctx1114.translate(x1115,y1116);var let_result1638 = M1.values();ctx1114.beginPath();var let_result1639 = M1.values();var sx1118 = M1.__(M1.abs(this1117.x/2));var sy1119 = M1.__(M1.abs(this1117.y/2));if (M1.__gt__eq_(x1115,0)!==false) {var if_res1640 = M1.__gt__eq_(y1116,0);} else {var if_res1640 = false;}if (if_res1640!==false) {ctx1114.moveTo(sx1118,sy1119);var if_res1647 = ctx1114.lineTo(sx1118+x1115,sy1119+y1116);} else {if (M1.__gt__eq_(x1115,0)!==false) {var if_res1641 = M1.__lt_(y1116,0);} else {var if_res1641 = false;}if (if_res1641!==false) {ctx1114.moveTo(sx1118+x1115,sy1119);var if_res1646 = ctx1114.lineTo(sx1118,sy1119-y1116);} else {if (M1.__lt_(x1115,0)!==false) {var if_res1642 = M1.__gt__eq_(y1116,0);} else {var if_res1642 = false;}if (if_res1642!==false) {ctx1114.moveTo(sx1118,sy1119+y1116);var if_res1645 = ctx1114.lineTo(sx1118-x1115,sy1119);} else {if (M1.__lt_(x1115,0)!==false) {var if_res1643 = M1.__lt_(y1116,0);} else {var if_res1643 = false;}if (if_res1643!==false) {ctx1114.moveTo(sx1118-x1115,sy1119-y1116);var if_res1644 = ctx1114.lineTo(sx1118,sy1119);} else {var if_res1644 = M1.rvoid();}var if_res1645 = if_res1644;}var if_res1646 = if_res1645;}var if_res1647 = if_res1646;}if_res1647;var or_part1120 = M1.equal_p($rjs_core.UString.make("outline"),$rjs_core.PrimitiveSymbol.make("outline"));if (or_part1120!==false) {var if_res1648 = or_part1120;} else {var if_res1648 = M1.equal_p($rjs_core.UString.make("outline"),$rjs_core.UString.make("outline"));}if (if_res1648!==false) {ctx1114.strokeStyle = M2.js_string(___gt_web_color(this1117.pen));var if_res1651 = ctx1114.stroke();} else {var or_part1121 = M1.equal_p($rjs_core.UString.make("outline"),$rjs_core.PrimitiveSymbol.make("solid"));if (or_part1121!==false) {var if_res1649 = or_part1121;} else {var if_res1649 = M1.equal_p($rjs_core.UString.make("outline"),$rjs_core.UString.make("solid"));}if (if_res1649!==false) {ctx1114.fillStyle = M2.js_string(___gt_web_color(this1117.pen));var if_res1650 = ctx1114.fill();} else {var if_res1650 = M1.rvoid();}var if_res1651 = if_res1650;}if_res1651;ctx1114.closePath();return ctx1114.restore();};var Rectangle = function(width1122, height1123, mode1124, pen_or_color1125) {var this1126 = this;this1126.type = $rjs_core.UString.make("rectangle");this1126.width = width1122;this1126.height = height1123;this1126.mode = mode1124;this1126.pen = pen_or_color1125;return null;};Rectangle.prototype.render = function(ctx1127, x1128, y1129) {var this1130 = this;ctx1127.save();ctx1127.translate(x1128,y1129);ctx1127.beginPath();var width1131 = this1130.width;var height1132 = this1130.height;var start_x1133 = M1.__(width1131/2);var start_y1134 = M1.__(height1132/2);ctx1127.rect(start_x1133,start_y1134,width1131,height1132);var or_part1135 = M1.equal_p(this1130.mode,$rjs_core.PrimitiveSymbol.make("outline"));if (or_part1135!==false) {var if_res1652 = or_part1135;} else {var if_res1652 = M1.equal_p(this1130.mode,$rjs_core.UString.make("outline"));}if (if_res1652!==false) {ctx1127.strokeStyle = M2.js_string(___gt_web_color(this1130.pen));var if_res1655 = ctx1127.stroke();} else {var or_part1136 = M1.equal_p(this1130.mode,$rjs_core.PrimitiveSymbol.make("solid"));if (or_part1136!==false) {var if_res1653 = or_part1136;} else {var if_res1653 = M1.equal_p(this1130.mode,$rjs_core.UString.make("solid"));}if (if_res1653!==false) {ctx1127.fillStyle = M2.js_string(___gt_web_color(this1130.pen));var if_res1654 = ctx1127.fill();} else {var if_res1654 = M1.rvoid();}var if_res1655 = if_res1654;}if_res1655;ctx1127.closePath();return ctx1127.restore();};var Circle = function(radius1137, mode1138, pen_or_color1139) {var this1140 = this;var diameter1141 = radius1137*2;this1140.type = $rjs_core.UString.make("circle");this1140.radius = radius1137;this1140.width = diameter1141;this1140.height = diameter1141;this1140.mode = mode1138;this1140.pen = pen_or_color1139;return null;};Circle.prototype.render = function(ctx1142, x1143, y1144) {var this1145 = this;var radius1146 = this1145.radius;ctx1142.save();ctx1142.translate(x1143,y1144);ctx1142.beginPath();ctx1142.ellipse(0,0,radius1146,radius1146,0,0,M5.Math.PI*2);var or_part1147 = M1.equal_p(this1145.mode,$rjs_core.PrimitiveSymbol.make("outline"));if (or_part1147!==false) {var if_res1656 = or_part1147;} else {var if_res1656 = M1.equal_p(this1145.mode,$rjs_core.UString.make("outline"));}if (if_res1656!==false) {ctx1142.strokeStyle = M2.js_string(___gt_web_color(this1145.pen));var if_res1659 = ctx1142.stroke();} else {var or_part1148 = M1.equal_p(this1145.mode,$rjs_core.PrimitiveSymbol.make("solid"));if (or_part1148!==false) {var if_res1657 = or_part1148;} else {var if_res1657 = M1.equal_p(this1145.mode,$rjs_core.UString.make("solid"));}if (if_res1657!==false) {ctx1142.fillStyle = M2.js_string(___gt_web_color(this1145.pen));var if_res1658 = ctx1142.fill();} else {var if_res1658 = M1.rvoid();}var if_res1659 = if_res1658;}if_res1659;ctx1142.closePath();return ctx1142.restore();};var Polygon = function(vertices1149, mode1150, pen_or_color1151) {var this1152 = this;var xs1153 = M0.map(posn_x,vertices1149);var ys1154 = M0.map(posn_y,vertices1149);var width1155 = M1.apply(M1.max,xs1153)-M1.apply(M1.min,xs1153);var height1156 = M1.apply(M1.max,ys1154)-M1.apply(M1.min,xs1153);this1152.type = $rjs_core.UString.make("polygon");this1152.vertices = vertices1149;this1152.width = width1155;this1152.height = height1156;this1152.mode = mode1150;this1152.pen = pen_or_color1151;return null;};Polygon.prototype.render = function(ctx1157, x1158, y1159) {var this1160 = this;var first_point1161 = M1.car(this1160.vertices);var rest_points1162 = M1.cdr(this1160.vertices);var radius1163 = this1160.radius;ctx1157.save();ctx1157.translate(x1158,y1159);ctx1157.beginPath();ctx1157.moveTo(posn_x(first_point1161),posn_y(first_point1161));var loop1164 = function(_points11651729) {lambda_start1728:while (true){let points1165 = _points11651729;if (M1.null_p(points1165)!==false) {return M1.rvoid();} else {var pt1166 = M1.car(points1165);ctx1157.lineTo(posn_x(pt1166),posn_y(pt1166));_points11651729 = M1.cdr(points1165);continue lambda_start1728;}}};loop1164(rest_points1162);var or_part1167 = M1.equal_p(this1160.mode,$rjs_core.PrimitiveSymbol.make("outline"));if (or_part1167!==false) {var if_res1661 = or_part1167;} else {var if_res1661 = M1.equal_p(this1160.mode,$rjs_core.UString.make("outline"));}if (if_res1661!==false) {ctx1157.strokeStyle = M2.js_string(___gt_web_color(this1160.pen));var if_res1664 = ctx1157.stroke();} else {var or_part1168 = M1.equal_p(this1160.mode,$rjs_core.PrimitiveSymbol.make("solid"));if (or_part1168!==false) {var if_res1662 = or_part1168;} else {var if_res1662 = M1.equal_p(this1160.mode,$rjs_core.UString.make("solid"));}if (if_res1662!==false) {ctx1157.fillStyle = M2.js_string(___gt_web_color(this1160.pen));var if_res1663 = ctx1157.fill();} else {var if_res1663 = M1.rvoid();}var if_res1664 = if_res1663;}if_res1664;ctx1157.closePath();return ctx1157.restore();};var empty_scene1169 = function(width21170, height31171, color11172) {var width1173 = width21170;var height1174 = height31171;if (false!==false) {var if_res1665 = $rjs_core.UString.make("white");} else {var if_res1665 = color11172;}var color1175 = if_res1665;return overlay(rectangle(width1173,height1174,$rjs_core.UString.make("solid"),color1175),rectangle(width1173,height1174,$rjs_core.UString.make("outline"),$rjs_core.UString.make("black")));};var cl1666 = function(width1176, height1177) {return empty_scene1169(width1176,height1177,$rjs_core.UString.make("white"));};var cl1667 = function(width1178, height1179, color11180) {return empty_scene1169(width1178,height1179,color11180);};var empty_scene = $rjs_core.attachProcedureArity(function() {var fixed_lam1668 = {'2':cl1666,'3':cl1667}[arguments.length];if (fixed_lam1668!==undefined) {return fixed_lam1668.apply(null,arguments);} else {return M1.error($rjs_core.UString.make("case-lambda: invalid case"));}},[2,3]);var text = function(txt1181, size1182, color1183) {return new Text(txt1181,size1182,color1183,$rjs_core.UString.make(""),$rjs_core.UString.make("serif"),$rjs_core.UString.make("normal"),$rjs_core.UString.make("normal"),false);};var text_by_font = function(txt1184, size1185, color1186, face1187, family1188, style1189, weight1190, underline_p1191) {var or_part1192 = face1187;if (or_part1192!==false) {var if_res1672 = or_part1192;} else {var if_res1672 = $rjs_core.UString.make("");}if (M1.symbol_p(family1188)!==false) {var if_res1671 = M1.symbol__gt_string(family1188);} else {var if_res1671 = family1188;}if (M1.symbol_p(style1189)!==false) {var if_res1670 = M1.symbol__gt_string(style1189);} else {var if_res1670 = style1189;}if (M1.symbol_p(weight1190)!==false) {var if_res1669 = M1.symbol__gt_string(weight1190);} else {var if_res1669 = weight1190;}return new Text(txt1184,size1185,color1186,if_res1672,if_res1671,if_res1670,if_res1669,underline_p1191);};var line = function(x1193, y1194, pen_or_color1195) {return new Line(x1193,y1194,pen_or_color1195);};var rectangle = function(w1196, h1197, m1198, p1199) {return new Rectangle(w1196,h1197,m1198,p1199);};var square = function(s1200, m1201, p1202) {return new Rectangle(s1200,s1200,m1201,p1202);};var circle = function(r1203, m1204, p1205) {return new Circle(r1203,m1204,p1205);};var triangle = function(side1206, mode1207, color1208) {var height1209 = side1206*(M1.sqrt(3)/2);return new Polygon(M1.list(make_posn(M1.__(side1206/2),height1209/2),make_posn(0,M1.__(height1209/2)),make_posn(side1206/2,height1209/2)),mode1207,color1208);};var Overlay = function(x_place1210, y_place1211, ima1212, imb1213) {var this1214 = this;var ima_cx1215 = ima1212.width/2;var ima_cy1216 = ima1212.height/2;var imb_cx1217 = imb1213.width/2;var imb_cy1218 = imb1213.height/2;var tmp1220 = x_place1210;if (M1.equal_p(tmp1220,$rjs_core.UString.make("beside"))!==false) {var if_res1675 = ima1212.width+imb1213.width;} else {if (M1.number_p(x_place1210)!==false) {if (M1.positive_p(x_place1210)!==false) {var if_res1673 = M1.max(ima1212.width,imb1213.width+x_place1210);} else {var if_res1673 = M1.max(imb1213.width,ima1212.width-x_place1210);}var if_res1674 = if_res1673;} else {var if_res1674 = M1.max(ima1212.width,imb1213.width);}var if_res1675 = if_res1674;}var width1219 = if_res1675;var tmp1222 = y_place1211;if (M1.equal_p(tmp1222,$rjs_core.UString.make("above"))!==false) {var if_res1678 = ima1212.height+imb1213.height;} else {if (M1.number_p(y_place1211)!==false) {if (M1.positive_p(y_place1211)!==false) {var if_res1676 = M1.max(ima1212.height,imb1213.height+y_place1211);} else {var if_res1676 = M1.max(imb1213.height,ima1212.height-y_place1211);}var if_res1677 = if_res1676;} else {var if_res1677 = M1.max(ima1212.height,imb1213.height);}var if_res1678 = if_res1677;}var height1221 = if_res1678;var δ_edge_x1223 = width1219/2;var δ_edge_y1224 = height1221/2;var tmp1227 = x_place1210;if (M1.equal_p(tmp1227,$rjs_core.UString.make("left"))!==false) {var if_res1685 = M1.values(ima_cx1215-δ_edge_x1223,imb_cx1217-δ_edge_x1223);} else {if (M1.equal_p(tmp1227,$rjs_core.UString.make("right"))!==false) {var if_res1684 = M1.values(δ_edge_x1223-ima_cx1215,δ_edge_x1223-imb_cx1217);} else {if (M1.equal_p(tmp1227,$rjs_core.UString.make("beside"))!==false) {var if_res1683 = M1.values(ima_cx1215-δ_edge_x1223,δ_edge_x1223-imb_cx1217);} else {if (M1.equal_p(tmp1227,$rjs_core.UString.make("middle"))!==false) {var if_res1679 = true;} else {var if_res1679 = M1.equal_p(tmp1227,$rjs_core.UString.make("center"));}if (if_res1679!==false) {var if_res1682 = M1.values(0,0);} else {if (M1.number_p(x_place1210)!==false) {var local_width1228 = M1.max(ima1212.width,imb1213.width);var local_acx1229 = ima_cx1215-(local_width1228/2);var local_bcx1230 = imb_cx1217-(local_width1228/2);var acx_bcx1231 = δ_edge_x1223-(local_width1228/2);if (M1.positive_p(x_place1210)!==false) {var if_res1680 = M1.values(local_acx1229-acx_bcx1231,x_place1210+(local_bcx1230-acx_bcx1231));} else {var if_res1680 = M1.values(local_acx1229-x_place1210-acx_bcx1231,local_bcx1230-acx_bcx1231);}var if_res1681 = if_res1680;} else {var if_res1681 = M1.error($rjs_core.UString.make("invalid x-place align"));}var if_res1682 = if_res1681;}var if_res1683 = if_res1682;}var if_res1684 = if_res1683;}var if_res1685 = if_res1684;}var let_result1686 = if_res1685;var δ_a_x1225 = let_result1686.getAt(0);var δ_b_x1226 = let_result1686.getAt(1);var tmp1234 = y_place1211;if (M1.equal_p(tmp1234,$rjs_core.UString.make("top"))!==false) {var if_res1693 = M1.values(ima_cy1216-δ_edge_y1224,imb_cy1218-δ_edge_y1224);} else {if (M1.equal_p(tmp1234,$rjs_core.UString.make("bottom"))!==false) {var if_res1692 = M1.values(δ_edge_y1224-ima_cy1216,δ_edge_y1224-imb_cy1218);} else {if (M1.equal_p(tmp1234,$rjs_core.UString.make("above"))!==false) {var if_res1691 = M1.values(ima_cy1216-δ_edge_y1224,δ_edge_y1224-imb_cy1218);} else {if (M1.equal_p(tmp1234,$rjs_core.UString.make("middle"))!==false) {var if_res1687 = true;} else {var if_res1687 = M1.equal_p(tmp1234,$rjs_core.UString.make("center"));}if (if_res1687!==false) {var if_res1690 = M1.values(0,0);} else {if (M1.number_p(y_place1211)!==false) {var local_height1235 = M1.max(ima1212.height,imb1213.height);var local_acy1236 = ima_cy1216-(local_height1235/2);var local_bcy1237 = imb_cy1218-(local_height1235/2);var acy_bcy1238 = δ_edge_y1224-(local_height1235/2);if (M1.positive_p(y_place1211)!==false) {var if_res1688 = M1.values(local_acy1236-acy_bcy1238,y_place1211+(local_bcy1237-acy_bcy1238));} else {var if_res1688 = M1.values(local_acy1236-y_place1211-acy_bcy1238,local_bcy1237-acy_bcy1238);}var if_res1689 = if_res1688;} else {var if_res1689 = M1.error($rjs_core.UString.make("invalid y-place align"));}var if_res1690 = if_res1689;}var if_res1691 = if_res1690;}var if_res1692 = if_res1691;}var if_res1693 = if_res1692;}var let_result1694 = if_res1693;var δ_a_y1232 = let_result1694.getAt(0);var δ_b_y1233 = let_result1694.getAt(1);this1214.type = $rjs_core.UString.make("overlay");this1214.ima = ima1212;this1214.imb = imb1213;this1214.width = width1219;this1214.height = height1221;this1214.aDx = δ_a_x1225;this1214.aDy = δ_a_y1232;this1214.bDx = δ_b_x1226;this1214.bDy = δ_b_y1233;return null;};Overlay.prototype.render = function(ctx1239, x1240, y1241) {var this1242 = this;var ima1243 = this1242.ima;var imb1244 = this1242.imb;ctx1239.save();ctx1239.translate(x1240,y1241);imb1244.render(ctx1239,this1242.bDx,this1242.bDy);ima1243.render(ctx1239,this1242.aDx,this1242.aDy);return ctx1239.restore();};var Container = function(childs1245, posns1246, width1247, height1248) {var this1249 = this;this1249.type = $rjs_core.UString.make("container");this1249.childs = childs1245;this1249.posns = posns1246;this1249.width = width1247;this1249.height = height1248;return null;};Container.prototype.render = function(ctx1250, x1251, y1252) {var this1253 = this;var width1254 = this1253.width;var height1255 = this1253.height;ctx1250.save();ctx1250.translate(x1251-(width1254/2),y1252-(height1255/2));ctx1250.beginPath();ctx1250.rect(0,0,M1.sub1(width1254),M1.sub1(height1255));ctx1250.clip();var loop1256 = function(_childs12571746, _posns12581747) {lambda_start1745:while (true){let childs1257 = _childs12571746;let posns1258 = _posns12581747;if (M1.null_p(childs1257)!==false) {return M1.rvoid();} else {var child1259 = M1.car(childs1257);var posn1260 = M1.car(posns1258);child1259.render(ctx1250,posn_x(posn1260),posn_y(posn1260));_childs12571746 = M1.cdr(childs1257);_posns12581747 = M1.cdr(posns1258);continue lambda_start1745;}}};loop1256(this1253.childs,this1253.posns);return ctx1250.restore();};var Bitmap = function(data1261) {var this1262 = this;var image1263 = new Image;image1263.crossOrigin = "anonymous";image1263.src = M2.js_string(data1261);this1262.image = image1263;this1262.width = image1263.width;this1262.height = image1263.height;return null;};Bitmap.prototype.render = function(ctx1264, x1265, y1266) {var this1267 = this;var image1268 = this1267.image;ctx1264.save();ctx1264.translate(x1265,y1266);ctx1264.drawImage(image1268,M1.__(image1268.width/2),M1.__(image1268.height/2));return ctx1264.restore();};var Freeze = function(img1269) {var this1270 = this;var canvas1271 = M5.document.createElement("canvas");var ctx1272 = canvas1271.getContext("2d");var width1273 = img1269.width;var height1274 = img1269.height;canvas1271.width = width1273;canvas1271.height = height1274;ctx1272.save();ctx1272.translate(width1273/2,height1274/2);img1269.render(ctx1272,0,0);ctx1272.restore();this1270.width = width1273;this1270.height = height1274;this1270.canvas = canvas1271;return null;};Freeze.prototype.render = function(ctx1275, x1276, y1277) {var this1278 = this;var width1279 = this1278.width;var height1280 = this1278.height;ctx1275.save();ctx1275.translate(x1276,y1277);ctx1275.drawImage(this1278.canvas,M1.__(width1279/2),M1.__(height1280/2));return ctx1275.restore();};var Rotate = function(image1281, angle1282) {var this1283 = this;var width1284 = image1281.width;var height1285 = image1281.height;var θ1286 = (M5.Math.PI*angle1282)/180.0;var sin_θ1287 = M1.sin(θ1286);var cos_θ1288 = M1.cos(θ1286);var x11289 = cos_θ1288*width1284;var y11290 = sin_θ1287*width1284;var x21291 = M1.__(sin_θ1287)*height1285;var y21292 = cos_θ1288*height1285;var x31293 = x11289+x21291;var y31294 = y11290+y21292;var min_x1295 = M1.min(0,x11289,x21291,x31293);var max_x1296 = M1.max(0,x11289,x21291,x31293);var min_y1297 = M1.min(0,y11290,y21292,y31294);var max_y1298 = M1.max(0,y11290,y21292,y31294);var rotated_width1299 = M1.floor(max_x1296-min_x1295);var rotated_height1300 = M1.floor(max_y1298-min_y1297);this1283.image = image1281;this1283.width = rotated_width1299;this1283.height = rotated_height1300;this1283.degrees = angle1282;this1283.radians = θ1286;return null;};Rotate.prototype.render = function(ctx1301, x1302, y1303) {var this1304 = this;ctx1301.save();ctx1301.translate(x1302,y1303);ctx1301.rotate(this1304.radians);this1304.image.render(ctx1301,0,0);return ctx1301.restore();};var Scale = function(image1305, x_factor1306, y_factor1307) {var this1308 = this;this1308.image = image1305;this1308.x_factor = x_factor1306;this1308.y_factor = y_factor1307;this1308.width = M1.abs(M1.floor(image1305.width*x_factor1306));this1308.height = M1.abs(M1.floor(image1305.height*y_factor1307));return null;};Scale.prototype.render = function(ctx1309, x1310, y1311) {var this1312 = this;ctx1309.save();ctx1309.translate(x1310,y1311);ctx1309.scale(this1312.x_factor,this1312.y_factor);this1312.image.render(ctx1309,0,0);return ctx1309.restore();};var container = function(childs1313, posns1314, width1315, height1316) {return new Container(childs1313,posns1314,width1315,height1316);};var place_image = function(child1317, cx1318, cy1319, base1320) {var width1321 = base1320.width;var height1322 = base1320.height;return container(M1.list(base1320,child1317),M1.list(make_posn(width1321/2,height1322/2),make_posn(cx1318,cy1319)),width1321,height1322);};var place_images = function(images1323, posns1324, scene1325) {var width1326 = scene1325.width;var height1327 = scene1325.height;return container(M1.cons(scene1325,images1323),M1.cons(make_posn(width1326/2,height1327/2),posns1324),width1326,height1327);};var __align_image_pos = function(image1328, pos1329, x_place1330, y_place1331) {var x1332 = posn_x(pos1329);var y1333 = posn_y(pos1329);var tmp1335 = x_place1330;if (M1.equal_p(tmp1335,$rjs_core.UString.make("left"))!==false) {var if_res1699 = (image1328.width/2)+x1332;} else {if (M1.equal_p(tmp1335,$rjs_core.UString.make("right"))!==false) {var if_res1698 = x1332-(image1328.width/2);} else {if (M1.equal_p(tmp1335,$rjs_core.UString.make("center"))!==false) {var if_res1696 = true;} else {var if_res1696 = M1.equal_p(tmp1335,$rjs_core.UString.make("middle"));}if (if_res1696!==false) {var if_res1697 = x1332;} else {var if_res1697 = M1.rvoid();}var if_res1698 = if_res1697;}var if_res1699 = if_res1698;}var new_x1334 = if_res1699;var tmp1337 = y_place1331;if (M1.equal_p(tmp1337,$rjs_core.UString.make("top"))!==false) {var if_res1703 = (image1328.height/2)+y1333;} else {if (M1.equal_p(tmp1337,$rjs_core.UString.make("bottom"))!==false) {var if_res1702 = y1333-(image1328.height/2);} else {if (M1.equal_p(tmp1337,$rjs_core.UString.make("center"))!==false) {var if_res1700 = true;} else {var if_res1700 = M1.equal_p(tmp1337,$rjs_core.UString.make("middle"));}if (if_res1700!==false) {var if_res1701 = y1333;} else {var if_res1701 = M1.rvoid();}var if_res1702 = if_res1701;}var if_res1703 = if_res1702;}var new_y1336 = if_res1703;return make_posn(new_x1334,new_y1336);};var place_image_by_align = function(image1338, x1339, y1340, x_place1341, y_place1342, scene1343) {var new_pos1344 = __align_image_pos(image1338,make_posn(x1339,y1340),x_place1341,y_place1342);return place_image(image1338,posn_x(new_pos1344),posn_y(new_pos1344),scene1343);};var place_images_by_align = function(images1345, posns1346, x_place1347, y_place1348, scene1349) {var new_posns1350 = M0.map(function(i1351, p1352) {return __align_image_pos(i1351,p1352,x_place1347,y_place1348);},images1345,posns1346);return place_images(images1345,new_posns1350,scene1349);};var __single_overlay = function(x_place1353, y_place1354, ima1355, imb1356) {return new Overlay(x_place1353,y_place1354,ima1355,imb1356);};var __single_underlay = function(x_place1357, y_place1358, ima1359, imb1360) {return new Overlay(x_place1357,y_place1358,imb1360,ima1359);};var overlay_by_align = $rjs_core.attachProcedureArity(function(x_place1361, y_place1362, ima1363, imb1364, ...imn13651704) {var imn1365 = $rjs_core.Pair.listFromArray(imn13651704);return M6.foldl(function(img1366, acc1367) {return __single_overlay(x_place1361,y_place1362,acc1367,img1366);},empty_image,M1.cons(ima1363,M1.cons(imb1364,imn1365)));});var overlay = $rjs_core.attachProcedureArity(function(ima1368, imb1369, ...imn13701705) {var imn1370 = $rjs_core.Pair.listFromArray(imn13701705);return M6.foldl(function(img1371, acc1372) {return __single_overlay($rjs_core.UString.make("middle"),$rjs_core.UString.make("middle"),acc1372,img1371);},empty_image,M1.cons(ima1368,M1.cons(imb1369,imn1370)));});var overlay_by_xy = function(ima1373, x1374, y1375, imb1376) {return new Overlay(x1374,y1375,ima1373,imb1376);};var underlay = $rjs_core.attachProcedureArity(function(ima1377, imb1378, ...imn13791706) {var imn1379 = $rjs_core.Pair.listFromArray(imn13791706);return M6.foldl(function(img1380, acc1381) {return __single_underlay($rjs_core.UString.make("middle"),$rjs_core.UString.make("middle"),acc1381,img1380);},empty_image,M1.cons(ima1377,M1.cons(imb1378,imn1379)));});var underlay_by_align = $rjs_core.attachProcedureArity(function(x_place1382, y_place1383, ima1384, imb1385, ...imn13861707) {var imn1386 = $rjs_core.Pair.listFromArray(imn13861707);return M6.foldl(function(img1387, acc1388) {return __single_underlay(x_place1382,y_place1383,acc1388,img1387);},empty_image,M1.cons(ima1384,M1.cons(imb1385,imn1386)));});var underlay_by_xy = function(ima1389, x1390, y1391, imb1392) {return new Overlay(M1.__(x1390),M1.__(y1391),imb1392,ima1389);};var above_by_align = $rjs_core.attachProcedureArity(function(x_place1393, i11394, i21395, ...is13961708) {var is1396 = $rjs_core.Pair.listFromArray(is13961708);return M6.foldl(function(img1397, acc1398) {return __single_overlay(x_place1393,$rjs_core.UString.make("above"),acc1398,img1397);},empty_image,M1.cons(i11394,M1.cons(i21395,is1396)));});var above = $rjs_core.attachProcedureArity(function(i11399, i21400, ...is14011709) {var is1401 = $rjs_core.Pair.listFromArray(is14011709);return M6.foldl(function(img1402, acc1403) {return __single_overlay($rjs_core.UString.make("middle"),$rjs_core.UString.make("above"),acc1403,img1402);},empty_image,M1.cons(i11399,M1.cons(i21400,is1401)));});var beside_by_align = $rjs_core.attachProcedureArity(function(y_place1404, i11405, i21406, ...is14071710) {var is1407 = $rjs_core.Pair.listFromArray(is14071710);return M6.foldl(function(img1408, acc1409) {return __single_overlay($rjs_core.UString.make("beside"),y_place1404,acc1409,img1408);},empty_image,M1.cons(i11405,M1.cons(i21406,is1407)));});var beside = $rjs_core.attachProcedureArity(function(i11410, i21411, ...is14121711) {var is1412 = $rjs_core.Pair.listFromArray(is14121711);return M6.foldl(function(img1413, acc1414) {return __single_overlay($rjs_core.UString.make("beside"),$rjs_core.UString.make("middle"),acc1414,img1413);},empty_image,M1.cons(i11410,M1.cons(i21411,is1412)));});var rotate = function(angle1415, image1416) {return new Rotate(image1416,M1.__(angle1415));};var scale = function(factor1417, image1418) {return new Scale(image1418,factor1417,factor1417);};var flip_horizontal = function(image1419) {return new Scale(image1419,-1,1);};var flip_vertical = function(image1420) {return new Scale(image1420,1,-1);};var bitmap_by_data = function(data1421) {return new Bitmap(data1421);};var bitmap_by_url = function(url1422) {return new Bitmap(url1422);};var frame = function(img1423) {return color_frame($rjs_core.UString.make("black"),img1423);};var color_frame = function(color1424, img1425) {return overlay(rectangle(image_width(img1425),image_height(img1425),$rjs_core.PrimitiveSymbol.make("outline"),color1424),img1425);};var freeze = function(img1426) {return new Freeze(img1426);};var __rjs_quoted__ = {};__rjs_quoted__.empty_image = empty_image;__rjs_quoted__.posn_p = posn_p;__rjs_quoted__.make_posn = make_posn;__rjs_quoted__.posn_y = posn_y;__rjs_quoted__.posn_x = posn_x;__rjs_quoted__.___gt_web_color = ___gt_web_color;__rjs_quoted__.struct_posn = struct_posn;export { __rjs_quoted__,posn_x,posn_y,posn_p,make_posn,struct_posn,print_image,freeze,bitmap_by_url,bitmap_by_data,flip_horizontal,flip_vertical,scale,rotate,beside,beside_by_align,above,above_by_align,underlay_by_xy,underlay,overlay,overlay_by_xy,overlay_by_align,place_images_by_align,place_image_by_align,place_images,place_image,color_frame,frame,triangle,text_by_font,text,circle,square,rectangle,line,image_width,image_height,empty_scene,empty_image };